var PH_search = 0;var PH_specificPage = 1;var PH_TOC = 2;var PH_topicTOC = 3;var PH_diploma = 4;var helpServer = "help.msn.com/resources/targeted/en-us/msntvv1/content/"; function constructBaseURL(pageURL){var protocol;if (pageURL.toLowerCase().indexOf("messenger") == -1){protocol = "http:";}else{protocol = "https:";}return protocol + "//" + helpServer;}var clientVerAppendStr = getClientVerAppendStr();function getClientVerAppendStr(){var agent = navigator.userAgent;var startOfVersionIndex = agent.indexOf("MSNTV");if (startOfVersionIndex == -1){return "";}else{startOfVersionIndex = startOfVersionIndex + 6;var endOfVersionIndex = agent.indexOf(";", startOfVersionIndex);var clientVersion = parseFloat(agent.substring(startOfVersionIndex, endOfVersionIndex));if (clientVersion <= 4.0)return "";elseif (clientVersion == 4.1)return "_v11";elseif (clientVersion == 4.2)return "_v12";elsereturn "";}}function insertVersionInFilename(filename){var HTMsuffixPos = filename.indexOf(".htm");if (HTMsuffixPos == -1){alert("filename not HTM: "+filename);return "";}var stuffBeforeSuffix = filename.substring(0, HTMsuffixPos);var suffix = filename.substring(HTMsuffixPos);var newFileName = stuffBeforeSuffix + clientVerAppendStr + suffix;return newFileName;}function CallPaneHelp(hmode){if (hmode == PH_topicTOC){PaneHelpURL = constructBaseURL(arguments[1]) + insertVersionInFilename(arguments[1]);}elseif (hmode == PH_diploma){PaneHelpURL = constructBaseURL(arguments[1]) + insertVersionInFilename(arguments[1]);if (arguments[2])PaneHelpURL += "?jumpURL=" + escape(arguments[2]);elsePaneHelpURL += "?retURL=" + encodeURIComponent(window.location.href);}elseif (hmode == PH_TOC){PaneHelpURL = constructBaseURL('MSNTV_ALTTOC_main.htm') + insertVersionInFilename('MSNTV_ALTTOC_main.htm');}elseif (hmode == PH_search){alert("Help search is not supported");return;}elseif (hmode == PH_specificPage){PaneHelpURL = constructBaseURL(arguments[1]) + insertVersionInFilename(arguments[1]);PaneHelpURL += "?retURL=" + encodeURIComponent(window.location.href);}top.location = PaneHelpURL;}