function Banner(div) {this.Div = div;this.DrawHomeView = _baDrawHomeView;this.DrawBrowseView = _baDrawBrowseView;this.Clear = _baClear;}function _baDrawHomeView(){this.Clear();var logo = addSpan(this.Div);logo.className = "bnTvLogoLg";var brand = addSpan(this.Div);brand.className = "bnMsnLogo";var txt = addSpan(this.Div);txt.className = "bnMsnTxt";txt.innerHTML = "MSN Video";}function _baDrawBrowseView(){this.Clear();var logo = addSpan(this.Div);logo.className = "bnTvLogoSm";}function _baClear(){clearChildren(this.Div);}function BrowseHeader(div) {this.Div = div;this.Init = _bhInit;this.SetText1 = _bhSetText1;this.SetText2 = _bhSetText2;}function _bhInit(){var ob;this.Text1 = addSpan(this.Div);this.Text1.className = "browseHeaderTxt1";this.Text2 = addSpan(this.Div);this.Text2.className = "browseHeaderTxt2";}function _bhSetText1(h){this.Text1.innerHTML = h;}function _bhSetText2(h){this.Text2.innerHTML = h;}function CategoryChooser(div, maxSubcats){this.Div = div;this.Init = _ccInit;this.Show = _ccShow;this.Hide = _ccHide;this.AppendBadCat = _ccAppendBadCat;this.MaxSubcats = maxSubcats;}function _ccInit(topics, cats, bottomY){var btn;var btns = new Array();for (var i=0; i<topics.length; i++){btns[i] = new Array();if (cats[i] != null){var bottomInd = (cats[i].length >= this.MaxSubcats) ? this.MaxSubcats : cats[i].length;for (var j=-1; j<cats[i].length; j++)  {if (j == bottomInd)break;btn = addSpan(this.Div);btn.innerHTML = (j==-1) ? "All" : cats[i][j];btn.Show = _ccShowOb;btn.Hide = _ccHideOb;btns[i][j+1] = btn;var upTarget = (j==-1) ? "" : "mi_" + i + "_" + j;var downTarget = (j==bottomInd-1) ? "oFooter.BrowseBtn" : "mi_" + i + "_" + (j+2);var tmpClass = (j==-1) ? "ccBtnT" : ((j==bottomInd-1) ? "ccBtnB" : "ccBtnM");  InitNavObject(btn,"mi_" + i + "_" + (j+1),upTarget,downTarget,"","","toCat(" + i + "," + j + ")","","ccBtn " + tmpClass + "_of","ccBtn " + tmpClass + "_ov","ccBtn " + tmpClass + "_pr","","ccBtn " + tmpClass + "_of ccBtnHL","ccBtn " + tmpClass + "_ov ccBtnHL","ccBtn " + tmpClass + "_pr ccBtnHL");}}}this.BottomY = bottomY;this.ButtonHeight = btn.offsetHeight;this.Btns = btns;}function _ccShow(topicInd, catInd){for (var i=0; i<this.Btns.length; i++){if (this.Btns[i] == null)break;for (var j=0; j<this.Btns[i].length; j++){if (i==topicInd){if (j==catInd+1 && i==topicInd)this.Btns[i][j].HighlightOn();elsethis.Btns[i][j].HighlightOff();this.Btns[i][j].style.top = j*this.ButtonHeight;this.Btns[i][j].Show();}elsethis.Btns[i][j].Hide();}}var popupHeight= this.ButtonHeight * this.Btns[topicInd].length;this.Div.style.height = popupHeight;this.Div.style.top = this.BottomY - popupHeight;this.Div.style.visibility = "visible";this.Btns[topicInd][catInd+1].Hover();  }function _ccHide(){for (var i=0; i<this.Btns.length; i++){if (this.Btns[i] != null){for (var j=0; j<this.Btns[i].length; j++){this.Btns[i][j].Hide();}}}this.Div.style.visibility = "hidden";}function _ccShowOb(){this.style.visibility = "visible";}function _ccHideOb(){this.style.visibility = "hidden";}function _ccAppendBadCat(topic_cat){}function Footer(div) {this.Div = div;this.DrawHomeView = _ftDrawHomeView;this.DrawPlaylistView = _ftDrawPlaylistView;this.DrawBrowseView = _ftDrawBrowseView;this.Clear = _ftClear;this.Hover = _ftHover;this.GetClosestButton = _ftGetClosestButton;this.IsSelectable = _ftIsSelectable;}function _ftDrawHomeView(){this.Clear();var showAddToStart = !mce_mclExists();if (showAddToStart){this.AddMclBtn = addSpan(this.Div);this.AddMclBtn.innerHTML = mceButton("Add MSNTV Today to More Programs", 37, 480);InitNavObject(this.AddMclBtn,"addMclBtn","navAwayFromOb(oFooter,0,oFooter.AddMclBtn.children[0])",  "","","oFooter.TosBtn","clickAddToStart()","overButton(oFooter.AddMclBtn)","","","","","","","","","","offButton(oFooter.AddMclBtn)");offButton(this.AddMclBtn);}this.TosBtn = addSpan(this.Div);this.TosBtn.innerHTML = "Terms of Use";InitNavObject(this.TosBtn,"tosBtn","navAwayFromOb(oFooter,0,oFooter.TosBtn)","",(showAddToStart) ? "oFooter.AddMclBtn" : "","","showTos()","","ftTos","ftTos ftTos_over","ftTos ftTos_pressed","","","","","","","");this.LeftMostOb = (showAddToStart) ? this.AddMclBtn : this.TosBtn;}function _ftDrawPlaylistView(){this.Clear();this.HomeBtn = addSpan(this.Div);this.HomeBtn.innerHTML = mceButton("All Categories", 37, 205);InitNavObject(this.HomeBtn,"videoHomeBtn","navAwayFromOb(oFooter,0,oFooter.HomeBtn.children[0])",  "","","oFooter.EmptyBtn","clickHomeButton()","overButton(oFooter.HomeBtn)","","","","","","","","","","offButton(oFooter.HomeBtn)");offButton(this.HomeBtn);this.EmptyBtn = addSpan(this.Div);this.EmptyBtn.innerHTML = mceButton("Empty Playlist", 272, 205);  InitNavObject(this.EmptyBtn,"emptyBtn","navAwayFromOb(oFooter,0,oFooter.EmptyBtn.children[0])",  "","oFooter.HomeBtn","","clickDeleteAll()","overButton(oFooter.EmptyBtn)","","","","","","","","","","offButton(oFooter.EmptyBtn)");offButton(this.EmptyBtn);this.LeftMostOb = this.HomeBtn;}function _ftDrawBrowseView(){this.Clear();var topicName = g_topics[g_nowTopicInd];var brwsBtnWdth = 345;var homeBtnWdth = 205;var playBtnWdth = 215;if (oCategoryChooser.Btns[g_nowTopicInd].length == 0){this.HomeBtn = addSpan(this.Div);this.HomeBtn.innerHTML = mceButton("All Categories", 37, homeBtnWdth); InitNavObject(this.HomeBtn,"videoHomeBtn","navAwayFromOb(oFooter,0,oFooter.HomeBtn.children[0])",  "","oFooter.BrowseBtn","oFooter.PlayAllBtn","clickHomeButton()","overButton(oFooter.HomeBtn)","","","","","","","","","","offButton(oFooter.HomeBtn)");offButton(this.HomeBtn);this.LeftMostOb = this.HomeBtn;}else{this.BrowseBtn = addSpan(this.Div);this.BrowseBtn.innerHTML = "Browse This Category";InitNavObject(this.BrowseBtn,"browseBtn","navAwayFromOb(oFooter,0,oFooter.BrowseBtn)","","","oFooter.HomeBtn","clickBrowseButton()","overBrowseButton();","ftBrws ftBrws_off","ftBrws ftBrws_over","ftBrws ftBrws_press","","","","","","","");this.HomeBtn = addSpan(this.Div);this.HomeBtn.innerHTML = mceButton("All Categories", 57 + brwsBtnWdth, homeBtnWdth); InitNavObject(this.HomeBtn,"videoHomeBtn","navAwayFromOb(oFooter,0,oFooter.HomeBtn.children[0])",  "","oFooter.BrowseBtn","oFooter.PlayAllBtn","clickHomeButton()","overButton(oFooter.HomeBtn)","","","","","","","","","","offButton(oFooter.HomeBtn)");offButton(this.HomeBtn);this.PlayAllBtn = addSpan(this.Div);this.PlayAllBtn.innerHTML = mceButton("Play All Videos", 77 + brwsBtnWdth + homeBtnWdth, playBtnWdth); InitNavObject(this.PlayAllBtn,"playAllBtn","navAwayFromOb(oFooter,0,oFooter.PlayAllBtn.children[0])",  "","oFooter.HomeBtn","","clickPlayAll()","overButton(oFooter.PlayAllBtn)","","","","","","","","","","offButton(oFooter.PlayAllBtn)");offButton(this.PlayAllBtn);this.LeftMostOb = this.BrowseBtn;}}function _ftHover(){if (this.LeftMostOb != null)this.LeftMostOb.Hover();}function _ftClear(){clearChildren(this.Div);}function _ftGetClosestButton(ob){var fromX = ob.offsetLeft + (ob.offsetWidth/2);for (var i=0; i<this.Div.children.length; i++){var ob = null;var btn = null;if (this.Div.children[i].children.length == 3){ob = this.Div.children[i];btn = ob.children[1];}else {ob = this.Div.children[i];if (ob.ClickAction != null){btn = ob;}}if (btn != null){var compareX = btn.offsetLeft + btn.offsetWidth;if (fromX <= compareX)return ob;}}return ob;}function _ftIsSelectable(){return this.Div.children.length != 0;}var PLAYSTATE_STOPPED;var PLAYSTATE_PAUSED;var PLAYSTATE_PLAYING;var PLAYSTATE_BUFFERING;var PLAYSTATE_FINISHED;var PLAYSTATE_STOPPED_EXT;function MediaPlayer(div) {this.Div = div;this.Init = _mpInit;this.SetDimensions = _mpSetDimensions;this.GetPlayState = _mpGetPlayState;this.GetPlayRate = _mpGetPlayRate;this.GetLastPlayState = _mpGetLastPlayState;this.SetLastPlayState = _mpSetLastPlayState;this.GetMediaPosition = _mpGetMediaPosition;this.SetMediaPosition = _mpSetMediaPosition;this.PlayMedia = _mpPlayMedia;this.StopMedia = _mpStopMedia;this.PauseMedia = _mpPauseMedia;this.CurrentMediaType = _mpCurrentMediaType;this.Show = _mpShow;this.Hide = _mpHide;this.IsSelectable = _mpIsSelectable;this.IsPlayingAd = false;this.LastPlayState = "";}function _mpInit(top, left, width, height){this.BaseTop = top;this.BaseLeft = left;this.BaseWidth = width;this.BaseHeight = height;PLAYSTATE_STOPPED = 1;PLAYSTATE_PAUSED = 2;PLAYSTATE_PLAYING = 3;PLAYSTATE_BUFFERING = 6;PLAYSTATE_FINISHED = 8;  this.Div.style.position = "absolute";var ob;ob = addSpan(this.Div);_DEBUG_createMediaPlayerForIE(ob, width, height);InitNavObject(this.Div,this.Div.id,"navAwayFromOb(oMediaPlayer,0,oMediaPlayer.Div)","navAwayFromOb(oMediaPlayer,1,oMediaPlayer.Div)","navAwayFromOb(oMediaPlayer,2,oMediaPlayer.Div)","navAwayFromOb(oMediaPlayer,3,oMediaPlayer.Div)","",  "","mpDiv mpDiv_off","mpDiv mpDiv_over","mpDiv mpDiv_pressed","");this.SetDimensions();}function _mpShow(){this.Div.style.visibility = "visible";}function _mpHide(){this.Div.style.visibility = "hidden";}function _mpSetDimensions(){this.Div.style.position = "absolute";this.Div.style.left = this.BaseLeft - 5;this.Div.style.top = this.BaseTop - 5;this.Div.style.width = this.BaseWidth + 10;this.Div.style.height = this.BaseHeight + 10;}function _mpIsSelectable(){return this.Div.style.visibility != "hidden";}function _mpGetPlayState(){try{return document.all.mediaPlayer.playState;}catch (exception){}}function _mpGetPlayRate(){try{return document.all.mediaPlayer.playRate;}catch (exception){}}function _mpGetLastPlayState(){return this.LastPlayState;}function _mpSetLastPlayState(state){this.LastPlayState = state;}function _mpGetMediaPosition(){return document.all.mediaPlayer.CurrentPosition*1000;}function _mpSetMediaPosition(pos){document.all.mediaPlayer.CurrentPosition = posMS / 1000;}function _mpPlayMedia(url){document.all.mediaPlayer.URL = url;setTimeout(function(){document.all.mediaPlayer.controls.play();}, 1);}function _mpStopMedia(){try{document.all.mediaPlayer.controls.stop();}catch (e){}}function _mpPauseMedia(pause){document.all.mediaPlayer.controls.pause();}function _mpCurrentMediaType(){switch (document.all.mediaPlayer.PlayState){case 0 : return "";default : return "Video";}}function _DEBUG_createMediaPlayerForIE(ob, width, height){ob.innerHTML = '                <OBJECT ID="mediaPlayer"                 CLASSID="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6"TYPE="application/x-oleobject" WIDTH="' + width + '" HEIGHT="' + height + '"VIEWASTEXT><PARAM NAME="uiMode" VALUE="none"></OBJECT><script language="JScript" for="mediaPlayer" event="PlayStateChange()">onPlayStateChange();</script>';var mp = document.getElementById("mediaPlayer");if(!mp || mp.readyState < 4){window.setTimeout("_DEBUG_createMediaPlayerForIE()", 200);return;}}function MessagePopup(){this.Error = _msError;this.Warning = _msWarning;this.Info = _msInfo;this.Confirm = _msConfirm;this.AutoHide = _msAutoHide;}function _msError(msg, caption){this.Info(msg, caption);}function _msWarning(msg, caption){this.Info(msg, caption);}function _msInfo(msg, caption){alert(msg);}function _msConfirm(msg){var c = "Please confirm";return confirm(msg);}function _msAutoHide(msg){do{msg = msg.replace("&#34;", "");}while (msg.indexOf("&#34;") != -1)try{var btns = new Array(1);btns[0] = 1;window.external.MediaCenter().DialogEx(msg, "", btns, 5, false, getAppLocation() + "/Images/Shared/s.gif",_msReturn);}catch (error){alert(msg);}}function MetadataPopup(div) {this.Div = div;this.Init = _mdInit;this.Refresh = _mdRefresh;this.Focus = _mdFocus;this.Show = _mdShow;this.Hide = _mdHide;this.DrawHideButton = _mdDrawHideButton;this.DrawChangeCityButton = _mdDrawChangeCityButton;this.IsSelectable = _mdIsSelectable;}function _mdInit(){}function _mdDrawHideButton(className){var buttonId = "hideBtn";this.HideButton = addSpan(this.Div);this.HideButton.innerHTML = mceButton("Hide", 0, 90);InitNavObject(this.HideButton,buttonId,"navAwayFromOb(oMetadataPopup,0,oMetadataPopup.HideButton)","navAwayFromOb(oMetadataPopup,1,oMetadataPopup.HideButton)","navAwayFromOb(oMetadataPopup,2,oMetadataPopup.HideButton)","navAwayFromOb(oMetadataPopup,3,oMetadataPopup.HideButton)","clickHideMPBtn()","overButton(oMetadataPopup.HideButton)",className,className,className,"","","","","","","offButton(oMetadataPopup.HideButton)");offButton(this.HideButton);}function _mdDrawChangeCityButton(className){var buttonId = "chngCityBtn";this.ChangeButton = addSpan(this.Div);this.ChangeButton.innerHTML = mceButton("Change City", 0, 200);InitNavObject(this.ChangeButton,buttonId,"navAwayFromOb(oMetadataPopup,0,oMetadataPopup.ChangeButton)","navAwayFromOb(oMetadataPopup,1,oMetadataPopup.ChangeButton)","navAwayFromOb(oMetadataPopup,2,oMetadataPopup.ChangeButton)","navAwayFromOb(oMetadataPopup,3,oMetadataPopup.ChangeButton)","changeCity()","overButton(oMetadataPopup.ChangeButton)",className,className,className,"","","","","","","offButton(oMetadataPopup.ChangeButton)");offButton(this.ChangeButton);}function _mdFocus(){this.HideButton.Hover();}function _mdRefresh(html){clearChildren(this.Div);this.Div.innerHTML = html;}function _mdShow(){this.Div.style.visibility = "visible";}function _mdHide(){this.Div.style.visibility = "hidden";}function _mdIsSelectable(){return (this.Div.style.visibility != "hidden");}function NavBar(div){this.Div = div;this.Init = _nbInit;this.Clear = _nbClear;this.Draw = _nbDraw;this.Refresh = _nbRefresh;this.Hover = _nbHover;this.MoveLeft = _nbMoveLeft;this.MoveRight = _nbMoveRight;this.SetRatchet = _nbSetRatchet;this.GetItemIndex = _nbGetItemIndex;this.GetMenuItem = _nbGetMenuItem;this.IsSelectable = _nbIsSelectable;}function NavBarProperties(visibleItems, beginScrollAt, overAction, offAction, clickAction, itemClassBase, arrowClassBase, dividerClassName, dividerOffset){this.VisibleItems = visibleItems;this.BeginScrollAt = beginScrollAt;this.OverAction = overAction;this.OffAction = offAction;this.ClickAction = clickAction;this.ItemClassBase = itemClassBase;this.ArrowClassBase = arrowClassBase;this.DividerClassName = dividerClassName;this.DividerOffset = dividerOffset;}function _nbInit(mode, htmlArray, guidArray, props){this.Mode = mode;this.HTML = htmlArray;this.GUIDs = guidArray;this.Props = props;this.ItemCount = (htmlArray.length >= this.Props.VisibleItems) ? this.Props.VisibleItems : htmlArray.length;this.AllowScrolling = (htmlArray.length >= this.Props.BeginScrollAt);var imgArray = new Array();var count = 0;var regex;var img;if (mode != "icons")regex = /img src=\S*\s/;for (var i=0; i<htmlArray.length; i++){if (mode != "icons"){img = regex.exec(htmlArray[i]);img = img[0].substring(9, img[0].length-2);imgArray[count++]=img;}}PreLoadImgs(imgArray);if (this.AllowScrolling){this.LeftArrow = addSpan(this.Div);this.LeftArrow.className = this.Props.ArrowClassBase + " " + this.Props.ArrowClassBase + "_l";}else{this.Spacer = addSpan(this.Div);this.Spacer.className = this.Props.ArrowClassBase;}var ob;var leftTarget;var rightTarget;this.MenuItems = new Array();for (var i=0; i<this.ItemCount; i++){ob = addSpan(this.Div);ob.id = "menuItem_" + i;this.MenuItems[i] = ob;leftTarget = (i==0) ? "oNavBar.MoveLeft(" + i + ")" : "menuItem_" + (i-1);rightTarget = (i==this.ItemCount-1) ? "oNavBar.MoveRight(" + i + ")" : "menuItem_" + (i+1);InitNavObject(ob,ob.id,"navAwayFromOb(oNavBar,0," + ob.id + ")","navAwayFromOb(oNavBar,1," + ob.id + ")",leftTarget,rightTarget,this.Props.ClickAction + "(" + i + ")",this.Props.OverAction + "(" + i + ")",this.Props.ItemClassBase + " " + this.Props.ItemClassBase + "_off",this.Props.ItemClassBase + " " + this.Props.ItemClassBase + "_over",this.Props.ItemClassBase + " " + this.Props.ItemClassBase + "_pressed","","","","","","",this.Props.OffAction + "(" + i + ")");}if (this.AllowScrolling){this.RightArrow = addSpan(this.Div);this.RightArrow.className = this.Props.ArrowClassBase + " " + this.Props.ArrowClassBase + "_r";}this.Divider = addSpan(this.Div);this.Divider.className = this.Props.DividerClassName;if (mode == "icons"){this.Spacers = new Array();for (var i=0; i<this.ItemCount; i++){var s = addSpan(this.Div);s.className = "nbDvdrTpcs";s.innerHTML = "&nbsp;";s.style.left = -100;this.Spacers[i] = s;this.MenuItems[i].style.left = 228*i + 50;}this.LeftArrow.style.left = 14;this.RightArrow.style.left = 228*i + 67;}this.CurrentThumb = this.MenuItems[0];this.Draw(0);}function _nbClear(){clearChildren(this.Div);this.CurrentThumb = null;}function _nbGetMenuItem(i){try{return this.MenuItems[i];}catch(exception){return null;}}function _nbDraw(ind){this.CurrentRatchet = ind;var ob;var dividerX = -100;for (var i=0; i<this.ItemCount; i++){var j = ind+i;if (j>=this.HTML.length)j-=this.HTML.length;ob = this.MenuItems[i];ob.innerHTML = this.HTML[j];ob.GUID = this.GUIDs[j];var firstItem = (j==0 && ind!=0);if (this.Spacers != null)this.Spacers[i].style.left = (firstItem) ? -100 : ob.offsetLeft;if (this.Divider != null)if (firstItem)dividerX = ob.offsetLeft - this.Props.DividerOffset;}this.Divider.style.left = dividerX;this.Refresh();}function _nbRefresh(){try{var ob;for (var i=0; i<this.ItemCount; i++){ob = this.MenuItems[i];lastItem = ((this.CurrentRatchet+i)==this.HTML.length-1 && this.HTML.length >this.ItemCount);if (this.Mode == "icons"){ob.ClassOver = "nbIcon nbIcon_over";ob.ClassPressed = "nbIcon nbIcon_pressed";ob.className = (ob == GetCurrentHover()) ? ob.ClassOver : ob.ClassOff;}else{var currentlyPlaying;if (oPlaylist.GetCurrent() == null)currentlyPlaying = false;else if (oMediaPlayer.GetPlayState() != PLAYSTATE_PLAYING || oMediaPlayer.IsPlayingAd)currentlyPlaying = false;else if (oPlaylist.GetCurrent().GUID == ob.GUID)currentlyPlaying = true;elsecurrentlyPlaying = false;setThumbClasses(ob, currentlyPlaying, lastItem);}}}catch (exception)  {return;}}function _nbMoveLeft(i){if (!this.AllowScrolling)return;if (this.HTML.length < this.ItemCount)return;if (this.CurrentRatchet==0){this.Draw(this.HTML.length-1);}else{this.Draw(this.CurrentRatchet-1);}eval(this.Props.OverAction + "(0)");}function _nbMoveRight(i){if (!this.AllowScrolling)return;if (this.HTML.length < this.ItemCount)return;if (this.CurrentRatchet==this.HTML.length-1){this.Draw(0);}else{this.Draw(this.CurrentRatchet+1);}eval(this.Props.OverAction + "(" + (this.ItemCount-1) + ")");}function _nbSetRatchet(ind){if (ind == -1){this.Draw(0);}else{this.Draw(ind);}}function _nbGetItemIndex(i){return ((i + this.CurrentRatchet) % this.HTML.length) + 1;}function _nbGetBkgrdImageByStyle(styleName){var s = document.styleSheets[0].rules;for (var i=0;i<s.length;i++){if(s[i].selectorText == '.' + styleName){var style = s[i].style.cssText;var index = style.indexOf("url(");if (index != -1){var endIndex = style.indexOf(")",index);if (endIndex != -1)return style.substring(index+4, endIndex);elsereturn null;}elsereturn null;}}}function _nbHover(){if (this.CurrentThumb != null)this.CurrentThumb.Hover();}function _nbIsSelectable(){return (this.CurrentThumb != null);}function navAwayFromOb(ob, dir, fromInnerOb){var DIR_UP = 0;var DIR_DOWN = 1;var DIR_LEFT = 2;var DIR_RIGHT = 3;switch (ob){case oAdManager:switch (dir){case DIR_DOWN :if (oMediaPlayer.IsSelectable())return oMediaPlayer.Div;if (oSlideShow.PanelIsSelectable())return oSlideShow.SlidePanel;if (oSlideShow.ButtonIsSelectable())return oSlideShow.Button;if (oNavBar.IsSelectable())return _utGetClosestChild(oNavBar.Div, fromInnerOb.offsetLeft);if (oFooter.IsSelectable())return _utGetClosestChild(oFooter.Div, fromInnerOb.offsetLeft);break;}return null;case oBrowseHeader:switch (dir){case DIR_UP :if (oVideoMetadata.IsSelectable())return oVideoMetadata.GetNearOb(dir);if (oMediaPlayer.IsSelectable())return oMediaPlayer.Div;if (oSlideShow.ButtonIsSelectable())return oSlideShow.Button;break;case DIR_DOWN :if (oNavBar.IsSelectable())return _utGetClosestChild(oNavBar.Div, fromInnerOb.offsetLeft);if (oSlideShow.ButtonIsSelectable())return oSlideShow.Button;if (oMediaPlayer.IsSelectable())return oMediaPlayer.Div;break;case DIR_LEFT :break;case DIR_RIGHT :break;}break;case oFooter:switch (dir){case DIR_UP :if (oNavBar.IsSelectable())return _utGetClosestChild(oNavBar.Div, fromInnerOb.offsetLeft);break;}return null;case oMediaPlayer:switch (dir){case DIR_UP :if (oAdManager.IsSelectable())return oAdManager.SelectableOb();break;case DIR_DOWN :if (oNavBar.IsSelectable())return _utGetClosestChild(oNavBar.Div, fromInnerOb.offsetLeft);break;case DIR_LEFT :if (oMetadataPopup.IsSelectable()){if (oMetadataPopup.ChangeButton != null)return oMetadataPopup.ChangeButton;elsereturn oMetadataPopup.HideButton;}if (oVideoMetadata.IsSelectable())return oVideoMetadata.GetNearOb(dir);break;}return oMediaPlayer.Div;  case oMetadataPopup:switch (dir){case DIR_UP :if (oAdManager.IsSelectable())return oAdManager.SelectableOb();break;case DIR_DOWN :if (oNavBar.IsSelectable())return _utGetClosestChild(oNavBar.Div, fromInnerOb.offsetLeft);break;case DIR_LEFT :if (fromInnerOb == oMetadataPopup.ChangeButton)return oMetadataPopup.HideButton;break;case DIR_RIGHT :if (fromInnerOb == oMetadataPopup.HideButton){if (oMetadataPopup.ChangeButton != null){return oMetadataPopup.ChangeButton;}else{if (oMediaPlayer.IsSelectable())return oMediaPlayer.Div;if (oSlideShow.ButtonIsSelectable())return oSlideShow.Button;}}if (fromInnerOb == oMetadataPopup.ChangeButton){if (oMediaPlayer.IsSelectable())return oMediaPlayer.Div;if (oSlideShow.ButtonIsSelectable())return oSlideShow.Button;}break;}return null;case oNavBar:switch (dir){case DIR_UP :if (fromInnerOb.offsetLeft < 400){if (oMetadataPopup.IsSelectable())return oMetadataPopup.HideButton;if (oVideoMetadata.IsSelectable())return oVideoMetadata.GetNearOb(dir);}if (oMediaPlayer.IsSelectable())return oMediaPlayer.Div;if (oSlideShow.ButtonIsSelectable())return oSlideShow.Button;if (oAdManager.IsSelectable())return oAdManager.SelectableOb();break;case DIR_DOWN :if (oFooter.IsSelectable())return oFooter.GetClosestButton(fromInnerOb);break;}return null;case oSlideShow:switch (dir){case DIR_UP :if (fromInnerOb == oSlideShow.Button)return oSlideShow.SlidePanel;if (fromInnerOb == oSlideShow.SlidePanel)if (oAdManager.IsSelectable())return oAdManager.SelectableOb();break;case DIR_DOWN :if (fromInnerOb == oSlideShow.SlidePanel)return oSlideShow.Button;if (fromInnerOb == oSlideShow.Button)if (oNavBar.IsSelectable())return _utGetClosestChild(oNavBar.Div, fromInnerOb.offsetLeft);break;case DIR_LEFT :if (oMetadataPopup.IsSelectable()){if (oMetadataPopup.ChangeButton != null)return oMetadataPopup.ChangeButton;elsereturn oMetadataPopup.HideButton;}break;}return null;case oVideoMetadata:switch (dir){case DIR_UP :if (oAdManager.IsSelectable())return oAdManager.SelectableOb();break;case DIR_RIGHT :if (oMediaPlayer.IsSelectable())return oMediaPlayer.Div;break;case DIR_DOWN :if (oNavBar.IsSelectable())return _utGetClosestChild(oNavBar.Div, fromInnerOb.offsetLeft);break;}return null;case hideBtn:switch (dir){case DIR_UP :var ob = document.all["changeCityButton"];if (ob != null)return ob;break;}return null;case changeCityButton:switch (dir){case DIR_DOWN :var ob = document.all["hideBtn"];if (ob != null)return ob;break;}return null;}}function OnDeckArea(div, transitionDiv) {this.Div = div;this.SliderSpan = transitionDiv;this.Init = _odInit;this.Refresh = _odRefresh;this.Clear = _odClear;this.Hide = _odHide;this.Show = _odShow;}function _odInit(){var ob;this.Background = addSpan(this.Div);ob = addSpan(this.Div);ob.className = "onDeckHead";ob.id = "onDeckHead";this.HeadSpan = ob;ob = addSpan(this.Div);ob.className = "onDeckTitle";ob.id = "onDeckTitle";this.TitleSpan = ob;ob = addSpan(this.Div);ob.className = "onDeckThumb";ob.id = "onDeckThumb";this.ThumbSpan = ob;}function _odClear(){this.Background.style.visibility = "hidden";this.HeadSpan.innerHTML = "";this.TitleSpan.innerHTML = "";this.ThumbSpan.innerHTML = "";}function _odRefresh(){if ((oPlaylist.Position == -1) || (oPlaylist.Position+1 >= oPlaylist.Items.length) || oMediaPlayer.IsPlayingAd){this.Clear();}else{this.CurrentItem = oPlaylist.Items[oPlaylist.Position+1];this.Background.style.visibility = "inherit";this.HeadSpan.innerHTML = "Up next (" + (oPlaylist.Position+2) + " of " + oPlaylist.Items.length + "):";this.TitleSpan.innerHTML = this.CurrentItem.Title;this.ThumbSpan.innerHTML = imageTag(this.CurrentItem.Thumb, 92, 69, "");}}function _odShow(){this.Div.style.visibility = "visible";}function _odHide(){this.Div.style.visibility = "hidden";}function SettingsArea(iframe) {this.Frame = iframe;this.SetPage = _saSetPage;this.Show = _saShow;this.Hide = _saHide;}function _saSetPage(mode){switch (mode){case "Weather":document.all.settingsFrame.src = "/Pages/MSNVideo/Settings.aspx?pid=AddVideoWeatherInput";break;default:document.all.settingsFrame.src = "/Pages/MSNVideo/SettingsEmpty.aspx";break;}}function _saShow() {document.all.settingsFrame.style.visibility = "visible";}function _saHide() {document.all.settingsFrame.style.visibility = "hidden";unRestrictMouse();}function SlideShow(slidePanel, abstractDiv){this.SlidePanel = slidePanel;this.AbstractDiv = abstractDiv;this.Init = _ssInit;this.SetPersonalSlides = _ssSetPersonalSlides;this.Clear = _ssClear;this.Next = _ssNext;this.Hide = _ssHide;this.Show = _ssShow;this.ShowAbstract = _ssShowAbstract;this.PanelIsSelectable = _ssPanelIsSelectable;this.ButtonIsSelectable = _ssButtonIsSelectable;}function _ssInit(slideHtml, abstractHtml){this.Clear();this.TextArea = addSpan(this.AbstractDiv);this.TextArea.className = "ssAbstract";this.Button = addSpan(this.AbstractDiv);this.Button.innerHTML = mceButton("Play Top Videos", 0, 220);this.CurrentSlide = 0;this.Slides = new Array();this.AbstractHtml = new Array();var slide;for (var i=0; i<slideHtml.length; i++){slide = addSpan(this.SlidePanel);slide.style.display = "none";slide.innerHTML = slideHtml[i];slide.ShowcaseIndex = i;this.Slides[this.Slides.length] = slide;this.AbstractHtml[this.AbstractHtml.length] = abstractHtml[i];}InitNavObject(this.Button,"playTopButton","navAwayFromOb(oSlideShow,0,oSlideShow.Button)","navAwayFromOb(oSlideShow,1,oSlideShow.Button)","navAwayFromOb(oSlideShow,2,oSlideShow.Button)","navAwayFromOb(oSlideShow,3,oSlideShow.Button)","clickPlayTop()","overPlayTop()","ssBtn","ssBtn","ssBtn","","","","","","","offPlayTop()");offPlayTop();InitNavObject(this.SlidePanel,"slideShowPanel","navAwayFromOb(oSlideShow,0,oSlideShow.SlidePanel)","navAwayFromOb(oSlideShow,1,oSlideShow.SlidePanel)","navAwayFromOb(oSlideShow,2,oSlideShow.SlidePanel)","navAwayFromOb(oSlideShow,3,oSlideShow.SlidePanel)","clickSlide()","","ssPanel ssPanel_off","ssPanel ssPanel_over", "ssPanel ssPanel_pressed","");}function _ssSetPersonalSlides(personalSlides, personalAbstracts){var tmpSlides = new Array();var tmpAbstracts = new Array();for (var i=0; i<this.Slides.length; i++){if (this.Slides[i].PersonalIndex == null){tmpSlides[tmpSlides.length] = this.Slides[i];tmpAbstracts[tmpAbstracts.length] = this.AbstractHtml[i];}}this.Slides = tmpSlides;this.AbstractHtml = tmpAbstracts;var slide;for (var i=0; i<personalSlides.length; i++){slide = addSpan(this.SlidePanel);slide.style.display = "none";slide.innerHTML = personalSlides[i];slide.PersonalIndex = i;this.Slides[this.Slides.length] = slide;this.AbstractHtml[this.AbstractHtml.length] = personalAbstracts[i];}this.CurrentSlide = 0;}function _ssClear(){clearChildren(this.SlidePanel);clearChildren(this.AbstractDiv);}function _ssNext(){this.SlidePanel.filters[0].apply();this.Slides[this.CurrentSlide].style.display="none";this.CurrentSlide = (this.CurrentSlide+1) % this.Slides.length;this.Slides[this.CurrentSlide].style.display="inline";this.SlidePanel.filters[0].play();this.ShowAbstract();}function _ssHide(){this.SlidePanel.style.visibility = "hidden";this.AbstractDiv.style.visibility = "hidden";}function _ssShow(){this.SlidePanel.style.visibility = "visible";this.AbstractDiv.style.visibility = "visible";this.Slides[this.CurrentSlide].style.display="inline";this.ShowAbstract();}function _ssShowAbstract(){this.TextArea.innerHTML = this.AbstractHtml[this.CurrentSlide];}function _ssPanelIsSelectable(){return (this.SlidePanel.style.visibility != "hidden");}function _ssButtonIsSelectable(){return (this.AbstractDiv.style.visibility != "hidden");}function GetCurrentHover(){return top.o_CurrentHover;}function SetCurrentHover(ob){top.o_CurrentHover = ob;}function DeviceHover(){if (GetCurrentHover()!=null){try{GetCurrentHover().Blur();}catch (e){}}if (this.OverAction != null)setTimeout(this.OverAction,1);if (this.id == "CVPproxy")window.external.MediaCenter().CustomViewPort.Focus();elsethis.className = (this.Highlighted == true && this.ClassOverHilite != null) ? this.ClassOverHilite : this.ClassOver;SetCurrentHover(this);if(this.ScrollIndex != null && this.ScrollIndex != "" && this.ScrollIndex != -1)SetScroll(this.ScrollParent, this.ScrollIndex);return true;}function DeviceBlur(){this.className = (this.Highlighted == true && this.ClassOffHilite != null) ? this.ClassOffHilite : this.ClassOff;if (this.OffAction != null)setTimeout(this.OffAction,1);}function DevicePress(){this.className = (this.Highlighted == true && this.ClassPressedHilite != null) ? this.ClassPressedHilite : this.ClassPressed;}function DeviceClick(){this.Press();setTimeout(this.ClickAction,100);}function DeviceHighlightOn(){this.Highlighted = true;this.className = (this.ClassOffHilite != null) ? this.ClassOffHilite : this.ClassOff;}function DeviceHighlightOff(){this.Highlighted = false;this.className = this.ClassOff;}function DeviceOnFocus(){}function DeviceOnBlur(){}function DeviceMouseOver(){if (!mouseAllowed(this))return;if (this.OnMouseOver != null)this.OnMouseOver();elsethis.Hover();}function DeviceMouseOut(){if (!mouseAllowed(this))return;if (this.OnMouseOut != null)this.OnMouseOut();elsethis.Blur();}function DeviceMouseDown(){if (!mouseAllowed(this))return;if (this.OnMouseDown != null)this.OnMouseDown();elsethis.Press();}function DeviceMouseClick(){if (!mouseAllowed(this))return;this.Click();}var g_restrictMouseToArea;function restrictMouse(ob){g_restrictMouseToArea = ob;}function unRestrictMouse(){g_restrictMouseToArea = null;}function mouseAllowed(ob){return (g_restrictMouseToArea==null);}function mceButton(s, left, width){return "<span style=\"left:" + left + "\"></span>"+ "<span style=\"left:" + (left+8) + ";width:" + (width-16) + "\">" + s + "</span>"+ "<span style=\"left:" + (left+width-8) + "\"></span>";}var gMceEnabled;function IsMCEEnabled(){return true;}function _mceInit(){try{window.external.MediaCenter.onReturnFromMediaCenter = _mceOnReturn;gMceEnabled = true;}catch (e){gMceEnabled = false;}}function _mceGetUserZip(){if (gMceEnabled){var mcePostal;try{mcePostal = window.external.MediaCenter().PostalCode;}catch (e){}return mcePostal;}else{return "";}}function _mceStartMenu(){if (gMceEnabled){try{window.external.MediaCenter().NavigateToPage("b8eac38a-7fb8-4559-84b5-42999c6864bd",null);}catch (e){}}}function _mceOnReturn(){if (window.external.MediaCenter().Experience.Type != 2){g_bIgnorePostStop = true;oMediaPlayer.StopMedia();oMediaPlayer.IsPlayingAd = false;DeviceDefaultStart();}}function onScaleEvent(vScale){bodyDiv.style.zoom = vScale;}function mce_mclExists(){try{var loc = location.href.toLowerCase();var i = loc.indexOf("/pages");var appUrl = loc.substring(0,i) + "/pages/msnvideo/main.aspx";return window.external.MediaCenter().DoesMCLExist(0 , appUrl);}catch (error){if (getCookie("MCLEXISTS") == "true")return true;elsereturn false;}}function addToStartMenu(){var showErrorDlg = false;var status;var loc = location.href.toLowerCase();var i = loc.indexOf("/pages");var urlPrefix = loc.substring(0,i);var appName = "MSNTV Today";var appUrl = urlPrefix + "/pages/msnvideo/main.aspx";var imgUrl = urlPrefix + "/msnvideo/MCE/images/en-us/Butterfly.png";var thmbUrl = urlPrefix + "/msnvideo/MCE/images/en-us/ButterflySm.png";try{if (window.external.MediaCenter().DoesMCLExist(0 , appUrl)){oMessagePopup.Warning("A shortcut to MSN Video has already been added to More Programs.", "");return;}status = window.external.MediaCenter().CreateMCL(appName, appUrl, imgUrl, thmbUrl, 0, 0, 0, appName, "Microsoft"); if (status != 0 && status != -2)showErrorDlg = true;}catch (error){showErrorDlg = true;}if (showErrorDlg)oMessagePopup.Warning("There was a problem adding MSN Video to More Programs.", "Sorry");elsesetCookie("MCLEXISTS", "true", 2592000000);  return (status == 0);}function onRemoteEvent(keyChar){if (g_bBlockInput)return true;switch (keyChar){case 0x09:  window.focus();return true;case 0x26:  return moveU();case 0x28:return moveD();case 0x25:return moveL();case 0x27:return moveR();case 0x0D:return keyClick();case 0x08:if (top.g_nowTopView == TOPVIEW_SETTINGS)return false;else{return videoGoBack();}case 0xA6:return videoGoBack();case 0x21:scroll(-1);return false;    case 0x22:scroll(1);return false;case 0x6B:return true;    case 0x6D:return true;case 0x1B:doClear();return true;case 0x13:return oVideoControls.Pause();case 0xB0:return oVideoControls.Skip();case 0xB1:return oVideoControls.Replay();case 0xB2:return oVideoControls.Stop();case 0xFA:return oVideoControls.Play();default:return false;}}function DeviceClickAway(url, targetName){if (gMceEnabled){_mceSetDirectXMode(false);switch(_mceGetMajorVersion()){case 6:try{location.replace(url);}catch(e){_mceErrorHandler("DeviceClickAway",e.description);}break;case 7:try{var MCE = window.external.MediaCenter();return MCE.CreateDesktopShortcut(targetName, url);}catch(e){_mceErrorHandler("DeviceClickAway",e.description);}break;}}else{location.href = url;}}function _mceSetDirectXMode(boolValue){try{var MCE = window.external.MediaCenter();MCE.DirectXExclusive = boolValue;}catch(e){_mceErrorHandler("_mceSetDirectXMode",e.description);}}function _mceGetMajorVersion(){try{var MCE = window.external.MediaCenter();return MCE.MajorVersion;}catch(e){_mceErrorHandler("sGetMajorVersion",e.description);}}function _mceErrorHandler(strLocation,strError){}function _mceDialog(strText,strCaption,lngType,lngTimeout,boolModal){try{var MCE = window.external.MediaCenter();MCE.Dialog(strText,strCaption,lngType,lngTimeout,boolModal);}catch(e){alert(strCaption + "\n\n" + strText + "\n\n" + e.description);}}function VideoControls() {this.Init = _vcInit;this.Stop = _vcStop;this.Play = _vcPlay;this.Pause = _vcPause;this.Skip = _vcSkip;this.Replay = _vcReplay;}function _vcInit(){}function _vcStop(){return false;}function _vcPlay(){if (GetCurrentHover().id.indexOf("menuItem_") != -1 && oNavBar.Mode != "icons"){GetCurrentHover().click();return true;}return false;}function _vcPause(){return false;}function _vcSkip(){if (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING || oMediaPlayer.GetPlayState() == PLAYSTATE_PAUSED){if (oMediaPlayer.IsPlayingAd)return true;}return false;}function _vcReplay(){return false;}function VideoMetadata(div, innerDiv) {this.Div = div;this.InnerDiv = innerDiv;this.Init = _vmInit;this.Refresh =  _vmRefresh;this.Clear = _vmClear;this.Hide = _vmHide;this.Show = _vmShow;this.SetFocus = _vmSetFocus;this.FocusOnLink = _vmFocusOnLink;this.FocusOnArea = _vmFocusOnArea;this.ClearFocus = _vmClearFocus;this.InnerMove = _vmInnerMove;this.LinkIsVisible = _vmLinkIsVisible;this.Click = _vmClick;this.Scroll = _vmScroll;this.IsSelectable = _vmIsSelectable;this.GetNearOb = _vmGetNearOb;this.ArrowMouseEvent = _vmArrowMouseEvent;this.SetArrowClass = _vmSetArrowClass;this.ScrollIncr = 30;this.VisibleHeight = this.Div.offsetHeight;}function _vmInit(){}function _vmRefresh(){this.Clear();if(oPlaylist.GetCurrent() != null){if (oMediaPlayer.IsPlayingAd){if (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING){var txt = addSpan(this.InnerDiv);txt.innerHTML = "Up next after this advertisement:";txt.className = "vmTxt1";txt = addSpan(this.InnerDiv);txt.innerHTML = oPlaylist.GetCurrent().Title;txt.className = "vmTxt2";}else{var txt = addSpan(this.InnerDiv);txt.innerHTML = "Loading advertisement...";txt.className = "vmTxt1";}this.Selectable = false;}else{if (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING || g_bForceStop){var title = addSpan(this.InnerDiv);title.innerHTML = oPlaylist.GetCurrent().Title;title.className = "vmTxt3";var abstract = addSpan(this.InnerDiv);abstract.innerHTML = oPlaylist.GetCurrent().Caption;abstract.className = "vmTxt4";this.Links = new Array();this.Hrefs = new Array();this.CurrentLink = -1;var urls = oPlaylist.GetCurrent().LinkUrls;var text = oPlaylist.GetCurrent().LinkText;for (var i=0; i<text.length; i++){if (text[i] != "" && urls[i]!=""){var link = addSpan(this.InnerDiv);link.innerHTML = text[i];link.className = "vmLink vmLink_off";link.id= "vmrl_" + i;this.Links[i] = link;this.Hrefs[i] = urls[i];}}var arr = addSpan(this.Div);arr.onmouseover = _vmOverUp;arr.onmouseout = _vmOffUp;arr.onmousedown = _vmPressUp;arr.onclick = _vmClickUp;this.ScrollUpBtn = arr;var arr = addSpan(this.Div);arr.onmouseover = _vmOverDn;arr.onmouseout = _vmOffDn;arr.onmousedown = _vmPressDn;arr.onclick = _vmClickDn;this.ScrollDownBtn = arr;InitNavObject(this.Div,this.Div.id,"oVideoMetadata.InnerMove(0)","oVideoMetadata.InnerMove(1)","oVideoMetadata.InnerMove(2)","oVideoMetadata.InnerMove(3)","oVideoMetadata.Click()","oVideoMetadata.SetFocus()","vmDiv vmDiv_off","vmDiv vmDiv_off","vmDiv vmDiv_off","");this.Div.OnMouseOver = _vmOnMouseOver;this.Div.OnMouseOut = _vmOnMouseOut;this.MinScroll = this.VisibleHeight - this.InnerDiv.offsetHeight;this.Selectable = ( (this.Links.length > 0) || (this.MinScroll < 0));}else{var txt = addSpan(this.InnerDiv);txt.innerHTML = "Please wait while we get your video ready.";txt.className = "vmTxt1";this.Selectable = false;}}}this.Scroll(0);}function _vmSetFocus(){if ((this.CurrentLink == -1) || (!this.LinkIsVisible(this.CurrentLink))){this.FocusOnArea();}else{this.FocusOnLink(this.CurrentLink);}}function _vmFocusOnLink(ind){this.Div.className = "vmDiv vmDiv_off";if (this.CurrentLink != -1)this.Links[this.CurrentLink].className = "vmLink vmLink_off";this.Links[ind].className = "vmLink vmLink_over";this.CurrentLink = ind;}function _vmFocusOnArea(){if (this.CurrentLink != -1)this.Links[this.CurrentLink].className = "vmLink vmLink_off";this.Div.className = "vmDiv vmDiv_over";}function _vmClearFocus(){if (this.CurrentLink != -1)this.Links[this.CurrentLink].className = "vmLink vmLink_off";}function _vmClick(){if ((this.CurrentLink != -1) && this.LinkIsVisible(this.CurrentLink))clickRelatedLink(this.Hrefs[this.CurrentLink], this.CurrentLink);elsethis.FocusOnArea();}function _vmInnerMove(dir){switch (dir){case 0:if (this.CurrentLink > 0){if (this.LinkIsVisible(this.CurrentLink-1)){this.FocusOnLink(this.CurrentLink-1);return;}}if (this.CurrentScroll < 0){this.Scroll(this.CurrentScroll + this.ScrollIncr);this.SetFocus();return;}break;case 1:if (this.CurrentLink+1 < this.Links.length){if (this.LinkIsVisible(this.CurrentLink+1)){this.FocusOnLink(this.CurrentLink+1);return;}}if (this.CurrentScroll > this.MinScroll){this.Scroll(this.CurrentScroll - this.ScrollIncr);this.SetFocus();return;}break;case 2:break;case 3:break;}var ob = navAwayFromOb(oVideoMetadata,dir,oVideoMetadata.Div);if (ob != null){this.ClearFocus();ob.Hover();}}function _vmLinkIsVisible(ind){if ( (this.Links[ind].offsetTop + this.Links[ind].offsetHeight) < (this.VisibleHeight - this.CurrentScroll) && (this.Links[ind].offsetTop > -(this.CurrentScroll)))return true;elsereturn false;}function _vmScroll(y){this.CurrentScroll = y;this.InnerDiv.style.top = y;if (this.Selectable){this.ScrollUpBtn.Enabled = (y < 0);this.ScrollDownBtn.Enabled = (y > this.MinScroll);this.SetArrowClass(0, "off");this.SetArrowClass(1, "off");}}function _vmIsSelectable(){return ((this.Div.style.visibility != "hidden") && this.Selectable);}function _vmGetNearOb(dir){switch (dir){case 0:if (this.Links.length >0){for (var i=this.Links.length-1; i>=0; i--){if (this.LinkIsVisible(i)){this.FocusOnLink(i);break;}}}break;case 1:case 2: case 3: if (this.Links.length >0){for (var i=0; i<this.Links.length; i++){if (this.LinkIsVisible(i)){this.FocusOnLink(i);break;}}}break;}return this.Div;  }function _vmOnMouseOver(){var targetId = window.event.toElement.id;if (targetId.indexOf("vmrl_") != -1)oVideoMetadata.FocusOnLink(targetId.substring(5,targetId.length));}function _vmOnMouseOut(){var targetId = window.event.fromElement.id;if (targetId.indexOf("vmrl_") != -1)oVideoMetadata.ClearFocus();}function _vmOverUp(){oVideoMetadata.ArrowMouseEvent(0, "over");}function _vmOffUp(){oVideoMetadata.ArrowMouseEvent(0, "off");}function _vmPressUp(){oVideoMetadata.ArrowMouseEvent(0, "press");}function _vmClickUp(){oVideoMetadata.ArrowMouseEvent(0, "click");}function _vmOverDn(){oVideoMetadata.ArrowMouseEvent(1, "over");}function _vmOffDn(){oVideoMetadata.ArrowMouseEvent(1, "off");}function _vmPressDn(){oVideoMetadata.ArrowMouseEvent(1, "press");}function _vmClickDn(){oVideoMetadata.ArrowMouseEvent(1, "click");}function _vmSetArrowClass(id, event){var ob = (id ==1) ? this.ScrollDownBtn : this.ScrollUpBtn;var cls = "vmScrl ";cls += (id == 1) ? "vmScrlDn " : "vmScrlUp "; if (!ob.Enabled)cls += (id == 1) ? "scrlArwDnDsbld" : "scrlArwUpDsbld"; else if (event == "off")cls += (id == 1) ? "scrlArwDnOff" : "scrlArwUpOff"; else if ((event == "over") || (event == "click"))cls += (id == 1) ? "scrlArwDnOver" : "scrlArwUpOver"; else if (event == "press")cls += (id == 1) ? "scrlArwDnPress" : "scrlArwUpPress"; ob.className = cls;}function _vmArrowMouseEvent(id, event){var ob = (id ==1) ? this.ScrollDownBtn : this.ScrollUpBtn;this.SetArrowClass(id, event);if (this.CurrentLink != -1)this.Links[this.CurrentLink].className = "vmLink vmLink_off";this.CurrentLink = -1;if ((event == "click") && (ob.Enabled)){y = this.CurrentScroll;y += (id == 1) ? -this.ScrollIncr : this.ScrollIncr;this.Scroll(y);}}function _vmClear(){clearChildren(this.InnerDiv);}function _vmShow(){this.Div.style.visibility = "visible";}function _vmHide(){this.Div.style.visibility = "hidden";}function AdManager(div) {this.Div = div;this.Init = _amInit;this.SetPageGroup = _amSetPageGroup;this.LoadNext = _amLoadNext;this.SetDefaults = _amSetDefaults;this.ShowLeaveBehind = _amShowLeaveBehind;this.MapPageGroup = _amMapPageGroup;this.CurrentUrl = "";this.GetClickThroughUrl = _amGetClickThroughUrl;this.IsSelectable = _amIsSelectable;this.SelectableOb = _amSelectableOb;this.SetPos = _amSetPos;this.Show = _amShow;this.Hide = _amHide;this.Debug = _amDebug;var i = location.search.toLowerCase().indexOf("forcepagegroup=");this.ForcePageGroup = (i != -1) ? location.search.substring(i+15,i+21) : null;this.defaultImgSrc = "/Images/MSNVideo/default_120x30_ad.gif";this.defaultImgHref = "http://msnbc.msn.com";this.PROMOTIONAL_PG = this.MapPageGroup("MSVPR1");this.SENSITIVE_PG = this.MapPageGroup("MSVSCB");this.NOAD_PG = this.MapPageGroup("MSVNPB");this.MARKETING_PG = this.MapPageGroup("MSVBSB");this.Enabled = false;}function _amInit(imageWidth, imageHeight, playAdFirst){this.AdImg = addImg(this.Div);this.AdImg.width = imageWidth;this.AdImg.height = imageHeight;this.AdImg.src = "/Images/Shared/s.gif";this.AdImg.onerror = _amOnImgFailure;this.PageGroupToUse = this.MARKETING_PG;this.EndUserSees = "image";this.AdFlag = (playAdFirst == "false") ? false : true;}function _amSetPageGroup(contentPG){var sourcePG = this.MapPageGroup(contentPG);switch (sourcePG){case this.PROMOTIONAL_PG:this.PageGroupToUse = this.AdFlag ? sourcePG : this.MARKETING_PG;this.EndUserSees = this.AdFlag ? "video" : "image";this.AdFlag = true;  break;case this.SENSITIVE_PG:this.PageGroupToUse = this.SENSITIVE_PG;this.EndUserSees = "image";this.AdFlag = true;break;case this.NOAD_PG:this.PageGroupToUse = this.MARKETING_PG;this.EndUserSees = "image";this.AdFlag = true;break;default:  this.PageGroupToUse = this.AdFlag ? sourcePG : this.MARKETING_PG;this.EndUserSees = this.AdFlag ? "video" : "image";this.AdFlag = this.AdFlag ? false : true;}if (!this.Enabled)this.EndUserSees = "image";}function _amLoadNext(){this.ReceivedResponse = false;this.AdImg.src = "/Images/Shared/s.gif";if (this.ForcePageGroup != null)this.PageGroupToUse = this.ForcePageGroup;this.CurrentUrl = urlToAdData(this.PageGroupToUse);oDataFetcher.GetData(this.CurrentUrl, onLoadAd, onLoadAdFail);this.LoadTimer = window.setTimeout(_amCheckLoadStatus, 5000);}function _amCheckLoadStatus(){window.clearTimeout(oAdManager.InitTimer);if (!oAdManager.ReceivedResponse){oDataFetcher.Cancel(oAdManager.CurrentUrl);oAdManager.SetDefaults();onLoadAdComplete();}}function onLoadAd(){oAdManager.ReceivedResponse = true;try{eval(oDataFetcher.Data);if (t_adImgSrc == null){onLoadAdFail();}else{oAdManager.AdImageSrc = t_adImgSrc;oAdManager.AdImageHref = t_adImgHref;oAdManager.TrackingImgSrc = t_trackingImgSrc;oAdManager.TrackingImgId = t_trackingImgId;oAdManager.ClipSrc = t_clipSrc;}}catch (exception){onLoadAdFail();}onLoadAdComplete();}function onLoadAdFail(){oAdManager.SetDefaults();}function _amSetDefaults(){this.AdImageSrc = this.defaultImgSrc;this.AdImageHref = this.defaultImgHref;this.TrackingImgSrc = "";this.TrackingImgId = "";this.ClipSrc = "";}function _amShowLeaveBehind(){if ((this.AdImageSrc == null || this.AdImageSrc == "") || (this.AdImageHref == null || this.AdImageHref == "")){this.AdImageSrc = this.defaultImgSrc;this.AdImageHref = this.defaultImgHref;}this.AdImg.src = this.AdImageSrc;var img = new Image();img.src = this.TrackingImgSrc;}function _amOnImgFailure(){oAdManager.AdImg.src = oAdManager.defaultImgSrc;oAdManager.AdImageHref = oAdManager.defaultImgHref;}function _amGetClickThroughUrl(){return this.AdImageHref;}function _amSetPos(top, left){this.Div.style.top = top;this.Div.style.left = left;}function _amShow(){this.Div.style.visibility = "visible";}function _amHide(){this.Div.style.visibility = "hidden";}function _amIsSelectable(){return (this.AdImageSrc != null && this.AdImageSrc != "");}function _amSelectableOb(){return this.Div;}function _amMapPageGroup(msntvPg){switch (msntvPg){case "MSVROM" : return "WTVRO6";case "MSVNPB" : return "WTVTVM";case "MSVBSB" : return "MSVTV3";case "MSVSCB" : return "MSVTV4";case "MSVPR1" : return "WTVTV1";case "MSVPR2" : return "MSVTV2";case "MSVSPO" : return "MSVTV5";case "MSVDNB" : return "MSVTV6";case "MSVDYM" : return "MSVTV7";case "MSVFNM" : return "MSVTVF";case "MSVFLM" : return "MSVTV8";case "MSVHGM" : return "MSVTV9";case "MSVTWM" : return "NBCTVW";case "MSVTOM" : return "NBCTVO";case "MSVTCM" : return "NBCTVC";case "MSVTPM" : return "NBCTVE";default: return "WTVRO6";}}function _amDebug(){}function BacklistManager() {this.Items = new Array();this.Append = _bmAppend;this.RemoveLast = _bmRemoveLast;}function _bmAppend(topicInd, catInd, videoSize, navView){if ((navView==null) || (videoSize==null))return;if (this.Items.length > 0){var i = this.Items[this.Items.length-1];if (i[0]==topicInd && i[1]==catInd && i[2]==videoSize && i[3]==navView){return;}if (i[0]==topicInd && i[1]==catInd && i[2]==videoSize && i[3]==navView){return;}}this.Items[this.Items.length] = new Array(topicInd, catInd, videoSize, navView);}function _bmRemoveLast(){var a = new Array();for (var i=0; i< this.Items.length-1; i++){a[i] = this.Items[i];}this.Items = a;}function BrandingArea(div, cssClass) {this.Div = div;this.Clear = _brClear;this.Init = _brInit;this.Refresh = _brRefresh;this.Hide = _brHide;this.Show = _brShow;this.Div.className = cssClass;}function _brClear(){clearChildren(this.Div);}function _brInit(){}function _brRefresh(){this.Clear();if (oPlaylist.GetCurrent() == null || oMediaPlayer.IsPlayingAd || oMediaPlayer.GetPlayState()!=PLAYSTATE_PLAYING)return;var ob = addImg(this.Div);ob.className = "brandingAreaImage";ob.src = "http://img.video.msn.com/s/us/sc/i/MSNTV/src/" + oPlaylist.GetCurrent().Source + ".gif";}function _brHide(){this.Div.style.visibility = "hidden";}function _brShow(){this.Div.style.visibility = "visible";}function DataFetcher(){this.Init = _dfInit;this.GetData = _dfGetData;this.OnLoad = _dfOnLoad;this.Cancel = _dfCancel;this.AppendToQueue = _dfAppendToQueue;this.PushToQueue = _dfPushToQueue;this.ClearQueue = _dfClearQueue;this.DomDoc = new ActiveXObject("Msxml2.DOMDocument");this.DomDoc.onreadystatechange = _dfCheckReadyState;this.DomDoc.async = true;}function _dfInit(){this.UrlQueue = new Array();this.OnSucceedQueue = new Array();this.OnFailQueue = new Array();}function _dfGetData(url, onSucceed, onFail){if (this.Url != null){this.PushToQueue(this.Url, this.OnSucceed, this.OnFail);}this.Url = url;this.OnSucceed = onSucceed;this.OnFail = onFail;this.DomDoc.load(url);}function _dfOnLoad(){this.Data = this.DomDoc.text;var f = (this.DomDoc.parseError.errorCode != 0) ? this.OnFail : this.OnSucceed;this.Url = null;this.OnSucceed = null;this.OnFail = null;f.call();if (this.UrlQueue.length != 0){this.GetData(this.UrlQueue[0], this.OnSucceedQueue[0], this.OnFailQueue[0]);var a1 = new Array();var a2 = new Array();var a3 = new Array();for (var i=0; i<this.UrlQueue.length-1; i++){a1[i] = this.UrlQueue[i+1];a2[i] = this.OnSucceedQueue[i+1];a3[i] = this.OnFailQueue[i+1];}this.UrlQueue = a1;this.OnSucceedQueue = a2;this.OnFailQueue = a3;}}function _dfAppendToQueue(url, onSucceed, onFail){var i = this.UrlQueue.length;this.UrlQueue[i] = url;this.OnSucceedQueue[i] = onSucceed;this.OnFailQueue[i] = onFail;}function _dfPushToQueue(url, onSucceed, onFail){var a1 = new Array(this.Url);var a2 = new Array(this.OnSucceed);var a3 = new Array(this.OnFail);for (var i=0; i<this.UrlQueue.length; i++){a1[i+1] = this.UrlQueue[i];a2[i+1] = this.OnSucceedQueue[i];a3[i+1] = this.OnFailQueue[i];}this.UrlQueue = a1;this.OnSucceedQueue = a2;this.OnFailQueue = a3;}function _dfClearQueue(){this.UrlQueue = new Array();this.OnSucceedQueue = new Array();this.OnFailQueue = new Array();this.Url = null;this.OnSucceed = null;this.OnFail = null;this.DomDoc.abort();}function _dfCheckReadyState(){if (oDataFetcher.DomDoc.readyState==4){if (oDataFetcher.DomDoc.url == oDataFetcher.Url){oDataFetcher.OnLoad();}}}function _dfCancel(url){}function JsPreloader() {this.Init = _jsInit;this.Load = _jsLoad;this.LoadNext = _jsLoadNext;this.Urls = new Array();this.NowLoading = -1;}function _jsInit(topicIds, catIds, client){this.TopicIds = topicIds;this.CatIds = catIds;this.Client = client;}function _jsLoad(nowTopicInd, nowCatInd){this.Urls = new Array();this.NowLoading = -1;this.NowTopic = nowTopicInd;this.NowCat = nowCatInd;var idArray = new Array();if (nowTopicInd == -1){idArray = this.TopicIds;}else if (nowCatInd == -1){idArray = this.CatIds[nowTopicInd];}if (idArray != null){for (var i=0; i<idArray.length; i++){this.Urls[i] = urlToJsLoader(idArray[i], this.Client);}}this.LoadNext();}function _jsLoadNext(){var i = this.NowLoading + 1;if (i < this.Urls.length){this.NowLoading = i;oDataFetcher.GetData(this.Urls[i], _jsOnLoad, _jsOnLoadFail);  }}function _jsOnLoad(){if (oDataFetcher.Data == ""){if (oJsPreloader.NowTopic != -1){var badCat = getTopic_Cat(oJsPreloader.NowTopic, oJsPreloader.NowLoading);oCategoryChooser.AppendBadCat(badCat);}}oJsPreloader.LoadNext();}function _jsOnLoadFail(){oJsPreloader.LoadNext();}var PLAYLIST_MAX = 1000;var g_nowNavView;var NAV_VIEW_HOME = 0;var NAV_VIEW_BROWSE = 1;var NAV_VIEW_PLAYLIST = 2;var g_nowTopicInd = -1;var g_nowCatInd = -1;var g_bBlockInput = false;var g_types;var g_GUIDs;var g_PGs;var g_PSs;var g_IDs;var g_sources;var g_headlines;var g_captions;var g_imageTypes;var g_imageUrls;var g_videoPaths;var g_articleUrls;var g_relatedLinkUrls;var g_relatedLinkText;function setMetaDataGlobals(types, GUIDs, PGs, PSs, IDs, sources, headlines, captions, imageTypes, imageUrls, videoPaths, articleUrls, relatedLinkUrls, relatedLinkText){g_types = (types != null) ? types : new Array();g_GUIDs = (GUIDs != null) ? GUIDs : new Array();g_PGs = (PGs != null) ? PGs : new Array();g_PSs = (PSs != null) ? PSs : new Array();g_IDs = (IDs != null) ? IDs : new Array();g_sources = (sources != null) ? sources : new Array();g_headlines = (headlines != null) ? headlines : new Array();g_captions = (captions != null) ? captions : new Array();g_imageTypes = (imageTypes != null) ? imageTypes : new Array();g_imageUrls = (imageUrls != null) ? imageUrls : new Array();g_videoPaths = (videoPaths != null) ? videoPaths : new Array();g_articleUrls = (articleUrls != null) ? articleUrls : new Array();g_relatedLinkUrls = (relatedLinkUrls != null) ? relatedLinkUrls : new Array();g_relatedLinkText = (relatedLinkText != null) ? relatedLinkText : new Array();}function catHasClipsNotInPlaylist(){var t_GUIDs = new Array();var j = 0;for (var i=g_GUIDs.length-1; i>=0; i--){if (g_videoPaths[i] != ""){t_GUIDs[j] = g_GUIDs[i];j++;}}var clipsToAdd = false;for (var i=0; i<t_GUIDs.length; i++){if (oPlaylist.IndexOf(t_GUIDs[i]) == -1)clipsToAdd = true;}return clipsToAdd;}function addCategoryToPlaylist(){var t_GUIDs = new Array();var t_videoPaths = new Array();var t_headlines = new Array();var t_captions = new Array();var t_imageUrls = new Array();var t_sources = new Array();var t_relatedLinkUrls = new Array();var t_relatedLinkText = new Array();var t_PGs = new Array();var t_PSs = new Array();var t_IDs = new Array();var j = 0;for (var i=g_GUIDs.length-1; i>=0; i--){if (g_videoPaths[i] != ""){t_GUIDs[j] = g_GUIDs[i];t_videoPaths[j] = g_videoPaths[i];t_headlines[j] = g_headlines[i];t_captions[j] = g_captions[i];t_imageUrls[j] = g_imageUrls[i];t_sources[j] = g_sources[i];t_relatedLinkUrls[j] = g_relatedLinkUrls[i];t_relatedLinkText[j] = g_relatedLinkText[i];t_PGs[j] = g_PGs[i];t_PSs[j] = g_PSs[i];t_IDs[j] = g_IDs[i];j++;}}oPlaylist.AddAll(t_GUIDs, t_videoPaths, t_headlines, t_captions, t_imageUrls, t_sources, t_relatedLinkUrls, t_relatedLinkText, t_PGs, t_PSs, t_IDs);}var p_types = new Array();var p_titles = new Array();var p_slideHtml = new Array();var p_abstractHtml = new Array();var p_metdataHtml = new Array();var p_userWeatherCity;var p_userWeatherConditionImg;var p_stockDirection;function setPersonalDataGlobals(types, titles, slideHtml, abstractHtml, metdataHtml, userWeatherCity, userWeatherConditionImg, stockDirection){p_types = types;p_titles = titles;p_slideHtml = slideHtml;p_abstractHtml = abstractHtml;p_metdataHtml = metdataHtml;p_userWeatherCity = userWeatherCity;p_userWeatherConditionImg = userWeatherConditionImg;p_stockDirection = stockDirection;}function addPersonalDataToGlobals(){var topicName = (g_nowCatInd == -1) ? g_topics[g_nowTopicInd] : g_cats[g_nowTopicInd][g_nowCatInd];var newType = "";if ((topicName == "Weather") && (p_userWeatherCity!=null)){newType = "Weather";}if (newType != ""){for (var i=g_types.length; i>0; i--){g_types[i] = g_types[i-1];g_GUIDs[i] = g_GUIDs[i-1];g_PGs[i] = g_PGs[i-1];g_PSs[i] = g_PSs[i-1];g_IDs[i] = g_IDs[i-1];g_sources[i] = g_sources[i-1];g_headlines[i] = g_headlines[i-1];g_captions[i] = g_captions[i-1];g_imageTypes[i] = g_imageTypes[i-1];g_imageUrls[i] = g_imageUrls[i-1];g_videoPaths[i] = g_videoPaths[i-1];g_articleUrls[i] = g_articleUrls[i-1];g_relatedLinkUrls[i] = g_relatedLinkUrls[i-1];g_relatedLinkText[i] = g_relatedLinkText[i-1];}g_types[0] = newType;g_GUIDs[0] = "";g_videoPaths[0] = "";}}function addSlideshowToPlaylist(firstInd){var a = (firstInd==null) ? 0 : firstInd;var t_GUIDs = new Array();var t_videoPaths = new Array();var t_headlines = new Array();var t_captions = new Array();var t_imageUrls = new Array();var t_sources = new Array();var t_relatedLinkUrls = new Array();var t_relatedLinkText = new Array();var t_PGs = new Array();var t_PSs = new Array();var t_IDs = new Array();var j = 0;for (var i=g_scGuids.length-1; i>=0; i--){if (i!=a){t_GUIDs[j] = g_scGuids[i];t_videoPaths[j] = g_scVideoUrls[i];t_headlines[j] = g_scHeadlines[i];t_captions[j] = g_scCaptions[i];t_imageUrls[j] = g_scImageUrls[i];t_sources[j] = g_scSources[i];t_relatedLinkUrls[j] = g_scRelatedLinkUrls[i];t_relatedLinkText[j] = g_scRelatedLinkText[i];t_PGs[j] = g_scPGs[i];t_PSs[j] = g_scPSs[i];t_IDs[j] = g_scIDs[i];j++;}}oPlaylist.AddAll(t_GUIDs, t_videoPaths, t_headlines, t_captions, t_imageUrls, t_sources, t_relatedLinkUrls, t_relatedLinkText, t_PGs, t_PSs, t_IDs);oPlaylist.PutNext(g_scGuids[a], g_scVideoUrls[a], g_scHeadlines[a], g_scCaptions[a], g_scImageUrls[a], g_scSources[a], g_scRelatedLinkUrls[a], g_scRelatedLinkText[a], g_scPGs[a], g_scPSs[a], g_scIDs[a]);}function handleThumbClick(ind, isLoading){var i = (ind + oNavBar.CurrentRatchet) % oNavBar.HTML.length;if (g_types[i] == "Weather"){showWeather();return;}if (g_types[i] == "Stocks"){showStocks();return;} var inPlaylistAtPos = oPlaylist.IndexOf(g_GUIDs[i]); var isPlaying = (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING); var currentItemIsAd = oMediaPlayer.IsPlayingAd;if (inPlaylistAtPos != -1){if (currentItemIsAd){oMessagePopup.AutoHide("The selected video will play after the advertisement");playItemAfterAd(inPlaylistAtPos);return;}if (inPlaylistAtPos == oPlaylist.Position){if (isLoading){oMessagePopup.AutoHide("The selected video is currently loading");return;}else if (isPlaying){oMessagePopup.AutoHide("The selected video is currently playing");return;}}oMessagePopup.AutoHide("Preparing to play the selected video");playItemAfterAd(inPlaylistAtPos);return;}if (!oPlaylist.PutLast(g_GUIDs[i], g_videoPaths[i], g_headlines[i], g_captions[i], g_imageUrls[i], g_sources[i], g_relatedLinkUrls[i], g_relatedLinkText[i], g_PGs[i], g_PSs[i], g_IDs[i]))return;onPlayListChange();if (isLoading || isPlaying){oMessagePopup.AutoHide("Adding the selected video to the playlist");return;}oMessagePopup.AutoHide("Preparing to play the selected video");playItemAfterAd(oPlaylist.Items.length-1);}function getTopic_Cat(topicInd, catInd){return (catInd==-1) ? topicInd : topicInd + "_" + catInd;}var o_NavigableObjects = new Array();var o_CurrentHover;var i_navObs = 0;function InitNavObject(ob, obId, upTarget, downTarget, leftTarget, rightTarget, clickAction, overAction, classOff, classOver, classPressed, classDisabled, classOff_hilite, classOver_hilite, classPressed_hilite, scrollParent, scrollIndex, offAction){o_NavigableObjects[i_navObs++] = ob;ob.id = obId;ob.UpTarget = upTarget;ob.DownTarget = downTarget;ob.LeftTarget = leftTarget;ob.RightTarget = rightTarget;ob.ClickAction = clickAction;ob.OverAction = overAction;ob.ClassOff = classOff;ob.ClassOver = classOver;ob.ClassPressed = classPressed;ob.ClassDisabled = classDisabled;ob.ClassOffHilite = classOff_hilite;ob.ClassOverHilite = classOver_hilite;ob.ClassPressedHilite = classPressed_hilite;ob.ScrollParent = scrollParent;ob.ScrollIndex = scrollIndex;ob.OffAction = offAction;ob.Highlighted = false;ob.className = ob.ClassOff;ob.Hover = DeviceHover;ob.Blur = DeviceBlur;ob.Press = DevicePress;ob.Click = DeviceClick;ob.HighlightOn = DeviceHighlightOn;ob.HighlightOff = DeviceHighlightOff;ob.onmouseover = DeviceMouseOver;ob.onmouseout = DeviceMouseOut;ob.onmousedown = DeviceMouseDown;ob.onclick = DeviceMouseClick;ob.onfocus= DeviceOnFocus;ob.onblur= DeviceOnBlur;}function moveU(){try{var ob = eval(GetCurrentHover().UpTarget);return ob.Hover();}catch (e){return false;}}function moveD(){try{var ob = eval(GetCurrentHover().DownTarget);return ob.Hover();}catch (e){return false;}}function moveL(){try{var ob = eval(GetCurrentHover().LeftTarget);return ob.Hover();}catch (e){return false;}}function moveR(){try{var ob = eval(GetCurrentHover().RightTarget);return ob.Hover();}catch (e){return false;}}function keyClick(){try{return GetCurrentHover().click();}catch (e){return false;}}var o_ScrollableObjects = new Array();var i_scrollObsCount = 0;function InitScrollableObject(ob, id, scrollIncrement, visibleItems, totalItems, upArrowId, downArrowId, obNmPrfx, paddingTop){o_ScrollableObjects[i_scrollObsCount++] = ob;ob.Id = id;ob.ScrollIncrement = scrollIncrement;ob.VisibleItems = visibleItems;ob.TotalItems = totalItems;ob.UpArrowId = upArrowId;ob.DownArrowId = downArrowId;ob.ObNamePrefix = obNmPrfx;ob.PaddingTop = paddingTop;ob.HtmlObject = document.all[id];ob.CurrentScroll = 0; }function GetScrollableOb(id){for (var i=0; i<o_ScrollableObjects.length; i++){if (o_ScrollableObjects[i].Id == id)return o_ScrollableObjects[i];}return null;}var ArrowObjects = new Array();var arrowCount = 0;function ScrollingArrow(id, clickAction, classOff, classOver, classPressed, classDisabled, scrollObId){this.Id = id;this.ClickAction = clickAction;this.ClassOff = classOff;this.ClassOver = classOver;this.ClassPressed = classPressed;this.ClassDisabled = classDisabled;this.Enabled = false; this.ScrollObId = scrollObId;ArrowObjects[arrowCount] = this;arrowCount++;}function GetArrow(id){for (var i=0; i<ArrowObjects.length; i++){if (ArrowObjects[i].Id == id)return ArrowObjects[i];}return null;}function InitScroll(obId){var scrlOb = GetScrollableOb(obId);DoScroll(scrlOb, scrlOb.CurrentScroll);}function SetScroll(obId, ind){var scrlOb = GetScrollableOb(obId);if (ind > scrlOb.VisibleItems-scrlOb.CurrentScroll)DoScroll(scrlOb, scrlOb.VisibleItems-ind);else if (scrlOb.CurrentScroll <= -ind)DoScroll(scrlOb, -(ind-1));}function DoScroll(ob, scr){ob.CurrentScroll=scr;var listItem;for (var i=1; i<=ob.TotalItems; i++){listItem = document.all[ob.ObNamePrefix + i];if ((i <= -ob.CurrentScroll) || (i > ob.VisibleItems-ob.CurrentScroll))listItem.style.display = "none";elselistItem.style.display = "block";}if (arrowCount > 0){if (ob.CurrentScroll < 0)enableArrw(ob.UpArrowId);elsedisableArrw(ob.UpArrowId);if (ob.TotalItems > ob.VisibleItems-ob.CurrentScroll)enableArrw(ob.DownArrowId);elsedisableArrw(ob.DownArrowId);}}function enableArrw(id){var arrow = GetArrow(id);if (!arrow.Enabled){var htmlOb = document.all[arrow.Id];htmlOb.className = arrow.ClassOff;arrow.Enabled = true;}}function disableArrw(id){var arrow = GetArrow(id);if (arrow.Enabled){var htmlOb = document.all[arrow.Id];htmlOb.className = arrow.ClassDisabled;arrow.Enabled = false;}}function setArrwCls(id,cls){var arrow = GetArrow(id);var htmlOb = document.all[arrow.Id];htmlOb.className = cls;}function arrwOver(id){var arrow = GetArrow(id);if (arrow.Enabled){var htmlOb = document.all[arrow.Id];htmlOb.className = arrow.ClassOver;}}function arrwOut(id){var arrow = GetArrow(id);if (arrow.Enabled){var htmlOb = document.all[arrow.Id];htmlOb.className = arrow.ClassOff;}}function arrwDown(id){var arrow = GetArrow(id);if (arrow.Enabled){var htmlOb = document.all[arrow.Id];htmlOb.className = arrow.ClassPressed;}}function arrwClick(id, dir){var arrow = GetArrow(id);var ob = GetScrollableOb(arrow.ScrollObId);scrollByPage(ob, dir);if (arrow.Enabled){var htmlOb = document.all[arrow.Id];htmlOb.className = arrow.ClassOver;}}function scrollByPage(scrlOb, dir){var newHover = scrlOb.ObNamePrefix;if (dir == 1)newHover += scrlOb.VisibleItems-scrlOb.CurrentScroll;elsenewHover += 1-scrlOb.CurrentScroll;if (newHover != GetCurrentHover().id){var ob = eval(newHover);ob.Hover();}else{var ind;if (dir == 1)ind = scrlOb.VisibleItems-scrlOb.CurrentScroll + scrlOb.VisibleItems;elseind = -scrlOb.CurrentScroll - scrlOb.VisibleItems;if (ind > scrlOb.TotalItems)ind = scrlOb.TotalItems;else if (ind < 1)ind = 1;var ob = eval(scrlOb.ObNamePrefix + ind);ob.Hover();SetScroll(scrlOb.Id, ind);}}function scroll(dir){var ob = o_ScrollableObjects[0];if (ob !== null){scrollByPage(ob, dir);}}var g_bForceStop = false;function playItemAfterAd(ind){if (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING){if (oMediaPlayer.IsPlayingAd){oPlaylist.MoveTo(ind); return;}else{g_bIgnorePostStop = true;oMediaPlayer.StopMedia();}}oPlaylist.MoveTo(ind); playCurrent();}function onPlayStateChange(){var newState = oMediaPlayer.GetPlayState();if (newState == oMediaPlayer.GetLastPlayState())return;oMediaPlayer.SetLastPlayState(newState);switch (newState){case PLAYSTATE_STOPPED:case PLAYSTATE_STOPPED_EXT:postStopAction();        break;                case PLAYSTATE_BUFFERING:        postBufferingAction();        break;case PLAYSTATE_PAUSED:postPauseAction();break;case PLAYSTATE_PLAYING:postPlayAction();break;case PLAYSTATE_FINISHED:break;}}function postStopAction(adFailedToPlay){window.clearTimeout(g_clipLoadTimer);if (adFailedToPlay == null)adFailedToPlay = false;if (oMediaPlayer.GetMediaPosition() != 0 && !adFailedToPlay){g_bForceStop = true;refreshPlaystateFeedback();return;}refreshPlaystateFeedback();var lastVideoWasContent = !oMediaPlayer.IsPlayingAd;oMediaPlayer.IsPlayingAd = false;if (g_bIgnorePostStop){g_bIgnorePostStop = false;return;}if (lastVideoWasContent){if (oPlaylist.Position+1 < oPlaylist.Items.length){oPlaylist.MoveNext();}else{onPlaylistEnd();return;}}if (oPlaylist.Position != -1)playCurrent();}function postPlayAction(){window.clearTimeout(g_clipLoadTimer);g_clipLoadedInTime = true;g_bIgnorePostStop = false; g_bForceStop = false;onPlaybackStart();}function postPauseAction(){}var g_clipLoadTimer;var g_clipLoadedInTime = false;function checkClipLoad(isAd){window.clearTimeout(g_clipLoadTimer);if(!g_clipLoadedInTime){g_bIgnorePostStop = false;if (isAd){postStopAction(true);}else{if (oPlaylist.GetCurrent() != null)postStopAction(false);}return;}}function playCurrent(){if (oMediaPlayer.IsPlayingAd && oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING){return;}if (oPlaylist.GetCurrent() == null)return;onPrepareToPlay();if (oPlaylist.GetCurrent().GUID != oAdManager.CurrentGUID){oAdManager.CurrentGUID = oPlaylist.GetCurrent().GUID;oAdManager.SetPageGroup(oPlaylist.GetCurrent().PageGroup);oMediaPlayer.IsPlayingAd = oAdManager.EndUserSees=="video";}refreshPlaystateFeedback();iPlayNextTimerId = window.setTimeout(playCurrentB, 100);}function playCurrentB(){window.clearTimeout(iPlayNextTimerId);if (oMediaPlayer.IsPlayingAd){oAdManager.LoadNext();}else{if (oPlaylist.GetCurrent() != null){window.clearTimeout(g_clipLoadTimer);g_clipLoadedInTime = false;g_clipLoadTimer = window.setTimeout(function() {checkClipLoad(false); }, 15000);oTrackingManager.TrackContentPlay(oPlaylist.GetCurrent());oMediaPlayer.PlayMedia(oPlaylist.GetCurrent().URL);}}}function onLoadAdComplete(){oAdManager.ShowLeaveBehind();if (oMediaPlayer.IsPlayingAd){if (oAdManager.ClipSrc == "" || oAdManager.ClipSrc.indexOf(".gif") != -1){g_bIgnorePostStop = false;postStopAction(true);}else{g_clipLoadedInTime = false;window.clearTimeout(g_clipLoadTimer);g_clipLoadTimer = window.setTimeout(function() { checkClipLoad(true); }, 15000);oTrackingManager.TrackAdPlay(oPlaylist.GetCurrent(), oAdManager.TrackingImgId);oMediaPlayer.PlayMedia(oAdManager.ClipSrc);}}}function Playlist() {this.Items = new Array();this.Init = _plInit;this.PutNext = _plPutNext;this.PutLast = _plPutLast;this.Insert = _plInsert;this.Remove = _plRemove;this.AddAll = _plAddAll;this.RemoveAll = _plRemoveAll;this.IndexOf = _plIndexOf;this.GetCurrent = _plGetCurrent;this.MoveNext = plMoveNext;this.MoveTo = plMoveTo;this.OK = 0;this.DUPE = 1;this.MAX = 2;}function _plInit(maxLength){this.Position = -1;this.MaxLength = maxLength;onPlayListChange();}function plMoveNext(){if (this.Position < this.Items.length-1){this.Position++;onPlayListChange();}}function plMoveTo(ind){if (ind <= this.Items.length){this.Position = ind;onPlayListChange();}}function _plPutNext(guid, url, title, caption, thumb, source, linkUrls, linkText, pageGroup, ps, id){var item = new PlaylistItem(guid, url, title, caption, thumb, source, linkUrls, linkText, pageGroup, ps, id);return (this.Insert(item, this.Position+1) == this.OK);}function _plPutLast(guid, url, title, caption, thumb, source, linkUrls, linkText, pageGroup, ps, id){var item = new PlaylistItem(guid, url, title, caption, thumb, source, linkUrls, linkText, pageGroup, ps, id);return (this.Insert(item, this.Items.length) == this.OK);}function _plAddAll(guids, urls, titles, captions, thumbs, sources, linkUrls, linkText, pageGroups, pss, ids){var item;for (var i=0; i< guids.length; i++){item = new PlaylistItem(guids[i], urls[i], titles[i], captions[i], thumbs[i], sources[i], linkUrls[i], linkText[i], pageGroups[i], pss[i], ids[i]);if (this.Insert(item, this.Position+1) == this.MAX) return;}}function _plInsert(item, ind){var inPlaylistAtPos = this.IndexOf(item.GUID);if (this.Items.length < this.MaxLength){for (var i=this.Items.length; i>ind; i--){this.Items[i] = this.Items[i-1];} this.Items[ind] = item;if (inPlaylistAtPos != -1){if (inPlaylistAtPos <= ind){this.Remove(inPlaylistAtPos);if (this.Position > 0)this.Position = this.Position-1;}else{this.Remove(inPlaylistAtPos+1);}}return this.OK;}oMessagePopup.Warning("The video was not added to your playlist because your list is full. The maximum number of videos your playlist can contain is " + this.MaxLength + ".", "");return this.MAX;}function _plRemove(ind){var tmpArr = new Array();var tmpInd = 0;for (var i=0; i<this.Items.length; i++){if (i!=ind){tmpArr[tmpInd++] = this.Items[i];}} this.Items = tmpArr;onPlayListChange();}function _plRemoveAll(){this.Items = new Array();this.Position = -1;onPlayListChange();}function _plIndexOf(guid){for(var i=0;i<this.Items.length;i++){var testGuid = this.Items[i].GUID;if (testGuid !== null && testGuid==guid)return i;}return -1;}function _plGetCurrent(){try{return this.Items[this.Position];}catch (e){return null;}}function PlaylistItem(guid, url, title, caption, thumb, source, linkUrls, linkText, pageGroup, ps, id){this.GUID = guid;this.URL = url;this.Title = title;this.Caption = caption;this.Thumb = thumb;this.Source = source;this.LinkUrls = linkUrls;this.LinkText = linkText;this.PageGroup = pageGroup;this.PS = ps;this.ID = id;}function TrackingManager(div) {this.Div = div;this.Init = _tmInit;this.TrackContentPlay = _tmTrackContentPlay;this.TrackAdPlay = _tmTrackAdPlay;this.TrackRelatedLink = _tmTrackRelatedLink;this.TrackPageView = _tmTrackPageView;}function _tmInit(client){switch (client){case "MCE":this.ClientId = "67531";break;case "Anduril":this.ClientId = "68206";break;default:this.ClientId = "";}this.ContentC = addImg(this.Div);this.ContentC.src = "/Images/Shared/s.gif";this.ContentG = addImg(this.Div);this.ContentG.src = "/Images/Shared/s.gif";this.AdG = addImg(this.Div);this.AdG.src = "/Images/Shared/s.gif";this.PageViewC = addImg(this.Div);this.PageViewC.src = "/Images/Shared/s.gif";}function _tmTrackContentPlay(item){var cUrl= "http://c.msn.com/c.gif?"+ "DI=2622"+ "&PI=" + this.ClientId+ "&PS=82594";var gUrl= "http://g.msn.com/0VD0/34/62?"+ "DI=2622"+ "&PI=" + this.ClientId+ "&PS=" + item.PS+ "&CM=source_" + item.Source+ "&CE=content"+ "&HL=" + item.ID;this.ContentC.src = cUrl;this.ContentG.src = gUrl;}function _tmTrackAdPlay(plItem, adId){var CEval = (adId == "") ? "commercial" : "no_ad";  var url = "http://g.msn.com/0VD0/34/62?"+ "DI=2622"+ "&PI=" + this.ClientId+ "&PS=" + plItem.PS+ "&CM=ad_" + plItem.PageGroup+ "&CE=" + CEval+ "&HL=" + plItem.GUID;this.AdG.src = url;}function _tmTrackRelatedLink(destUrl, linkPos, plItem){return destUrl;}function _tmTrackPageView(){var url = "http://c.msn.com/c.gif?"+ "DI=1455"+ "&PI=" + this.ClientId+ "&PS=73424"+ "&TP=http%3A//msntv.msn.com/pages/msnvideo/main.aspx";this.PageViewC.src = url;}function drawInitialView(){switch (getInitialView()){case "loadPlaylist":var url = urlToPlaylistData(g_startUpParams);oDataFetcher.GetData(url, onGetPlaylist, onGetPlaylistFail);break;case "guidLookup":var url = urlToGuidLookup(g_startUpParams);oDataFetcher.GetData(url, onGetItemByGuid, onGetItemByGuidFail);break;case "openToCat":DeviceSpecialStart();break;default:DeviceDefaultStart();break;}}function getInitialView(){if (g_startUpParams==null)return "default";if (getStartupParam("p")!="")return "loadPlaylist";if ((getStartupParam("g")!="") || (getStartupParam("i")!="") || (getStartupParam("r")!="") || (getStartupParam("prepend")!="") || (getStartupParam("replace")!=""))return "guidLookup";if ((getStartupParam("m")!="") || (getStartupParam("mi")!="") || (getStartupParam("menu")!="") || (getStartupParam("menuItem")!=""))return "openToCat";return "default";}var STARTUP_PARAMS = "msnVideoStartupParams";function getStartupParamsCookie(){return getCookie(STARTUP_PARAMS);}function clearStartupParamsCookie(){setCookie(STARTUP_PARAMS,"",0);}function onGetPlaylist(){try{if (oDataFetcher.Data == ""){onGetPlaylistFail();}else{eval(oDataFetcher.Data);var item;for (var i=t_GUIDs.length-1; i>=0 ; i--){item = new PlaylistItem(t_GUIDs[i], t_videoPaths[i], t_headlines[i], t_captions[i], t_imageUrls[i], t_sources[i], t_relatedLinkUrls[i], t_relatedLinkText[i], t_PGs[i], t_PSs[i], t_IDs[i]);if (oPlaylist.Insert(item, 0) != oPlaylist.OK)return;}var startItemGuid = getStartupParam("i");if (startItemGuid == "") startItemGuid = getStartupParam("g");if (startItemGuid != ""){var url = urlToGuidLookup(g_startUpParams);oDataFetcher.GetData(url, onGetItemByGuid, onGetItemByGuidFail);}else{DeviceSpecialStart();}}}catch (e){onGetPlaylistFail();}}function onGetPlaylistFail(){if ((getStartupParam("g")!="") || (getStartupParam("i")!="") || (getStartupParam("r")!="") || (getStartupParam("prepend")!="") || (getStartupParam("replace")!="")){var url = urlToGuidLookup(g_startUpParams);oDataFetcher.GetData(url, onGetItemByGuid, onGetItemByGuidFail);}else{DeviceDefaultStart();}}function onGetItemByGuid(){try{if (oDataFetcher.Data == ""){onGetItemByGuidFail();return;}eval(oDataFetcher.Data);var item;for (var i=t_GUIDs.length-1; i>=0 ; i--){item = new PlaylistItem(t_GUIDs[i], t_videoPaths[i], t_headlines[i], t_captions[i], t_imageUrls[i], t_sources[i], t_relatedLinkUrls[i], t_relatedLinkText[i], t_PGs[i], t_PSs[i], t_IDs[i]);if (oPlaylist.Insert(item, 0) != oPlaylist.OK)return;}DeviceSpecialStart();}catch (oError){onGetItemByGuidFail();}}function onGetItemByGuidFail(){DeviceDefaultStart();}function getInitialNavView(){var t_topicName = (getStartupParam("m")!="") ? getStartupParam("m") : getStartupParam("menu");var t_categoryName = (getStartupParam("mi")!="") ? getStartupParam("mi") : getStartupParam("menuItem");if (t_topicName!= null){var loadCategory = false;var initTopic = -1;var initCat = -1;for (var a=0; a<g_topics.length; a++){if (g_topics[a]==t_topicName){loadCategory = true;initTopic = a;}if (loadCategory && t_categoryName!=null && t_categoryName!=""){for (var b=0; b<g_cats[a].length; b++){if (g_cats[a][b]==t_categoryName) {initCat = b;break;}}}if (loadCategory)break;}if (loadCategory){g_nowTopicInd = initTopic;g_nowCatInd = initCat;return NAV_VIEW_BROWSE;}}if (getInitialView() == "loadPlaylist"){return NAV_VIEW_PLAYLIST;}return NAV_VIEW_HOME;}function getStartupParam(name){var re = /\+/g;var value = "";if (g_startUpParams != null && g_startUpParams != ""){var p = g_startUpParams.split("&");for (var i=0; i<p.length; i++){var nv = p[i].split("=");if (nv[0] == name){value = unescape(nv[1]);return value.replace(re, " ");}}}return value;}function addSpan(ob){var newSpan = document.createElement("SPAN");return ob.appendChild(newSpan);}function addImg(ob){var newSpan = document.createElement("IMG");return ob.appendChild(newSpan);}function addSwf(ob){var childOb = document.createElement("EMBED");return ob.appendChild(childOb);}function addIFrame(ob){var i = document.createElement("IFRAME");return ob.appendChild(i);}function clearChildren(ob){var child;for (var i=ob.children.length; i>0; i--){child = ob.children(i-1);ob.removeChild(child);}}function addDiv(ob){var newDiv = document.createElement("DIV");return ob.appendChild(newDiv);}function imageTag(src, w, h, className){var tag = "<img src='" + src + "'";if (w!="")tag += " width='" + w + "'";if (h!="")tag += " height='" + h + "'"; if (className!="")tag += " class='" + className + "'";tag += "/>";return tag; }function okToLeaveApp(){if (oPlaylist.Items.length <= 1)return true;elsereturn oMessagePopup.Confirm("Are you sure you want to leave MSN Video? When you leave, your playlist will be emptied.");}function getAppLocation(){var a = location.href;var b = a.substring(0,a.indexOf('://')+3);var c = a.substring(b.length, a.length);var d = c.substring(0,c.indexOf('/'));return b + d;}function urlToJsLoader(topicId, client){return g_appLoc + "/VideoContent.ashx?contentType=videoMetadata&client=" + client + "&topicId=" + topicId;}function urlToPersonalData(clientZip){return g_appLoc + "/PersonalizedContent.ashx?xForm=MSNVideo/DataFetcher_PersonalData.xslt&clientZip=" + clientZip;}function urlToAdData(pageGroup){return g_appLoc + "/VideoContent.ashx?contentType=ad&pg=" + pageGroup;}function urlToPlaylistData(params){return g_appLoc + "/VideoContent.ashx?contentType=playlist&" + params;}function urlToGuidLookup(params){return g_appLoc + "/VideoContent.ashx?contentType=guidLookup&" + params;}function urlToUserActivity(){return g_appLoc + "/UserActivity.ashx?";}function _utGetClosestChild(parent, x){var ob;for (var i=0; i<parent.children.length; i++){if (parent.children[i].ClickAction != null){ob = parent.children[i];var middlePoint = ob.offsetLeft + (ob.offsetWidth/2);if (x<=middlePoint)return ob;}}return ob;}function htmlDecode(s){return s.replace("&amp;", "&");}function setCookie(name, value, expMs){var now = new Date();var expires = new Date(now.valueOf() + expMs);  document.cookie = escape(name) + "=" + escape(value) + ";expires=" + expires + ";path=/";}function getCookie(name){var dc = document.cookie;var prefix = name + "=";var begin = dc.indexOf("; " + prefix);if (begin == -1){begin = dc.indexOf(prefix);if (begin != 0) return null;}else{begin += 2;}var end = document.cookie.indexOf(";", begin);if (end == -1){end = dc.length;}return unescape(dc.substring(begin + prefix.length, end));}function VideoStatus(div){this.Div = div;this.Init = _vsInit;this.Refresh = _vsRefresh;this.Reset = _vsReset;this.Hide = _vsHide;this.Show = _vsShow;}function _vsInit(player, barWidth){this.Visible = false;this.Player = player;this.BarWidth = barWidth;var ob = addSpan(this.Div);ob.className = "vsBox1a";ob = addSpan(this.Div);ob.className = "vsBox1b";ob = addSpan(this.Div);ob.className = "vsBox1c";this.Text1 = addSpan(this.Div);this.Text1.className = "vsTxt1";this.Slider = addSpan(this.Div);this.Slider.className = "vsSlider";this.Text2 = addSpan(this.Div);this.Text2.className = "vsTxt2";}function _vsReset(){if (this.Visible){this.Text1.innerHTML = "00:00";this.Duration = Math.floor(this.Player.GetDuration());var mm = Math.floor(this.Duration/60);var ss = this.Duration - mm*60;this.Text2.innerHTML= ((mm < 10) ? "0" + mm : mm)+ ":"+ ((ss < 10) ? "0" + ss : ss);this.Slider.style.width = 0;this.Refresh();}}function _vsRefresh(){window.clearTimeout(this.TimerId);if (this.Visible){try{var mls = this.Player.GetMediaPosition();var sec = Math.floor(mls/1000);var mm = Math.floor(sec/60);var ss = sec - mm*60;if (mm == -1){this.Text1.innerHTML = "00:00";}else{this.Text1.innerHTML= ((mm < 10) ? "0" + mm : mm)+ ":"+ ((ss < 10) ? "0" + ss : ss);}this.Slider.style.width = this.BarWidth * (sec/this.Duration);}catch (exception){this.Text1.innerHTML = "00:00";this.Slider.style.width = 0;}this.TimerId = window.setTimeout(function() {oVideoStatus.Refresh();}, 1000);}}function _vsHide(){clearTimeout(this.TimerId);this.Div.style.visibility = "hidden";this.Visible = false;}function _vsShow(){this.Visible = true;this.Reset();this.Div.style.visibility = "visible";}var start;var iNm;var g_imgPreloader = null;function nextImg(nowImg){var imgCount = iNm.length;if (nowImg < imgCount-1){var expr = "getImg(" + (nowImg+1) + ")";g_imgPreloader = setTimeout(expr,1);}else{d = new Date();window.status = "All "+imgCount+" images downloaded in "+((d-start)/1000)+"s";g_imgPreloader = null;}}function getImg(ind){var tempImg = new Image();tempImg.onload = function(){nextImg(ind)};tempImg.src = iNm[ind];}function PreLoadImgs(imgArray){if (g_imgPreloader){clearTimeout(g_imgPreloader);g_imgPreloader = null;window.status = "Terminating previous preloading request ...";}d = new Date();start = d.getTime();iNm = imgArray;getImg(0);}var g_appLoc = getAppLocation();var g_nowTopView;var g_bIs16by9 = false;var TOPVIEW_SLIDESHOW = 0;var TOPVIEW_VIDEO = 1;var TOPVIEW_SETTINGS = 2;var g_lastHovered;function setLastHovered(id){g_lastHovered = id;}function getLastHovered(){return getSettingsElement(g_lastHovered);}function getSettingsElement(id){var ob = document.all[id];if (!ob)ob = document.all.settingsFrame.contentWindow.document.getElementById(id);return ob;}var oAdManager;var oBacklistManager;var oBanner;var oBrandingArea;var oBrowseHeader;var oCategoryChooser;var oDataFetcher;var oFooter;var oJsPreloader;var oMediaPlayer;var oMessagePopup;var oMetadataPopup;var oNavBar;var oOnDeckArea;var oPlaylist;var oSettingsArea;var oSlideShow;var oTrackingManager;var oVideoControls;var oVideoMetadata;var iSlideShowInterval = 8000;var iSlideShowTimerId = null;var iPersonalDataTimerId = null;var iPlayNextTimerId = null;var iPlayAllTimerId = null;var g_startUpParams = getStartupParamsCookie();clearStartupParamsCookie();var g_bIgnorePostStop;function initApp(){if (oAdManager != null){if (oMediaPlayer.GetPlayState() != PLAYSTATE_STOPPED){drawTop(TOPVIEW_VIDEO);}return false;}if (document.body.clientWidth / document.body.clientHeight > 1.5){g_bIs16by9 = true;var arrClasses = new Array("bodyDiv", "settingsFrame", "staticContentDiv", "wthrTileTxt1","wthrTileTxt2", "navBarDiv", "ftDiv");setClassWidths(arrClasses, 256, false);setClassWidths(new Array("ssAbstract", "ssTxt1", "ssTxt2", "vmDiv", "vmInnerDiv", "vmTxt1", "vmTxt2", "vmTxt3", "vmTxt4", "vmLink"), 256, false);setClassAttribute(getClass("nbArrThmb"), "margin-left", 2);setClassAttribute(getClass("nbArrThmb"), "margin-right", 2);}oAdManager = new AdManager(adManagerDiv);oBacklistManager = new BacklistManager();oBanner = new Banner(bannerDiv);oBrandingArea = new BrandingArea(brandingDiv, "brandingDiv");oBrowseHeader = new BrowseHeader(browseHeaderDiv);oCategoryChooser = new CategoryChooser(categoryChooserDiv, 20);oDataFetcher = new DataFetcher();oFooter = new Footer(footerDiv);oJsPreloader = new JsPreloader();oMediaPlayer = new MediaPlayer(playerDiv);oMessagePopup = new MessagePopup(messagePopupDiv);oMetadataPopup = new MetadataPopup(staticContentDiv);oNavBar = new NavBar(navBarDiv);oOnDeckArea = new OnDeckArea(onDeckDiv, transitionDiv);oPlaylist = new Playlist();oSlideShow = new SlideShow(slideShowPanel, slideShowAbstract);oSettingsArea = new SettingsArea(settingsFrame);oTrackingManager = new TrackingManager(trackingDiv);oVideoControls = new VideoControls();oVideoMetadata = new VideoMetadata(videoMetadataDiv, videoMetadataInnerDiv);g_bIgnorePostStop = true;oMediaPlayer.StopMedia();oAdManager.Init(240, 60, true);oBrandingArea.Init();oBrowseHeader.Init();oCategoryChooser.Init(g_topics, g_cats, 691);oDataFetcher.Init();oJsPreloader.Init(g_topicIds, g_catIds, "MCE");oMediaPlayer.Init(119, 509+(g_bIs16by9 ? 256:0), 480, 360);  oMetadataPopup.Init();oOnDeckArea.Init();oPlaylist.Init(PLAYLIST_MAX);oTrackingManager.Init("MCE");oVideoControls.Init();oVideoMetadata.Init();_mceInit();InitNavObject(adManagerDiv,"adImg","navAwayFromOb(oAdManager,0,oAdManager.Div)","navAwayFromOb(oAdManager,1,oAdManager.Div)","navAwayFromOb(oAdManager,2,oAdManager.Div)","navAwayFromOb(oAdManager,3,oAdManager.Div)","clickAd()","","adManagerDiv am_off","adManagerDiv am_over","adManagerDiv am_pressed","");drawInitialView();iPersonalDataTimerId = window.setTimeout(loadPersonalData, 1000);oTrackingManager.TrackPageView();generatePreloadImageList();if (g_arrImgList.length > 0)PreLoadImgs(g_arrImgList);}function leavePage(){}function DeviceDefaultStart(){drawTop(TOPVIEW_SLIDESHOW);drawBottom(NAV_VIEW_HOME);oAdManager.LoadNext();updateBacklist();}function DeviceSpecialStart(){if (oPlaylist.Items.length > 0){oPlaylist.MoveTo(0);playCurrent();drawTop(TOPVIEW_VIDEO);}else{drawTop(TOPVIEW_SLIDESHOW);}drawBottom(getInitialNavView());updateBacklist();}function drawTop(view){g_nowTopView = view;switch (view){case TOPVIEW_SLIDESHOW:oSlideShow.Init(ssHtmlSlides(), ssHtmlAbstracts());oSlideShow.SetPersonalSlides(p_slideHtml, p_abstractHtml);iSlideShowTimerId = window.setTimeout(nextSlide, iSlideShowInterval);oBrandingArea.Hide();oMediaPlayer.Hide();oMetadataPopup.Hide();oOnDeckArea.Hide();oSettingsArea.Hide();oSlideShow.Show();oVideoMetadata.Hide();break;case TOPVIEW_VIDEO:window.clearTimeout(iSlideShowTimerId);oBrandingArea.Show();oMediaPlayer.Show();oMetadataPopup.Hide();oOnDeckArea.Show();oSettingsArea.Hide();oSlideShow.Hide();oVideoMetadata.Show();break;case TOPVIEW_SETTINGS:window.clearTimeout(iSlideShowTimerId);oBrandingArea.Hide();oMediaPlayer.Hide();oMetadataPopup.Hide();oOnDeckArea.Hide();oSettingsArea.Show();oSlideShow.Hide();oVideoMetadata.Hide();break;}}function drawBottom(view){g_nowNavView = view;oDataFetcher.ClearQueue();switch (view){case NAV_VIEW_HOME:g_nowTopicInd = -1;g_nowCatInd = -1;setMetaDataGlobals(null, null, null, null, null, null, null, null, null, null, null, null, null, null);oBrowseHeader.SetText1("");oBrowseHeader.SetText2("");oBanner.DrawHomeView();oFooter.DrawHomeView();oNavBar.Clear();var start = 4+(g_bIs16by9 ? 1:0);var navBarProps = new NavBarProperties(start, start+1, "overIcon", "offIcon", "clickIcon", "nbIcon", "nbArrIcon nbArr", "nbDvdrTpcsEnd", 10);oNavBar.Init("icons", HtmlArrayForIcons(), new Array(), navBarProps);oNavBar.Hover();oJsPreloader.Load(g_nowTopicInd, g_nowCatInd);break;case NAV_VIEW_BROWSE:var topicId = (g_nowCatInd == -1) ? g_topicIds[g_nowTopicInd] : g_catIds[g_nowTopicInd][g_nowCatInd];var topicName = (g_nowCatInd == -1) ? g_topics[g_nowTopicInd] : g_cats[g_nowTopicInd][g_nowCatInd];oCategoryChooser.Hide();oBrowseHeader.SetText1("Please wait while we get " + topicName + " ready.");oBrowseHeader.SetText2("");oNavBar.Clear();oFooter.Hover();var url = urlToJsLoader(topicId, "MCE");oDataFetcher.GetData(url, onBrowseLoadComplete, onBrowseLoadFail);break;case NAV_VIEW_PLAYLIST:var t_types = new Array();var t_GUIDs = new Array();var t_headlines = new Array();var t_captions = new Array();var t_imageUrls = new Array();var t_videoPaths = new Array();for (var i=0; i<oPlaylist.Items.length; i++){var item = oPlaylist.Items[i];t_types[i] = "video";t_GUIDs[i] = item.GUID;t_headlines[i] = item.Title;t_captions[i] = item.Caption;t_imageUrls[i] = item.Thumb;t_videoPaths[i] = item.URL;}setMetaDataGlobals(t_types, t_GUIDs, null, null, null, null, t_headlines, t_captions, null, t_imageUrls, t_videoPaths, null, null, null);oBanner.DrawBrowseView();oBrowseHeader.MediaCount = g_types.length;oBrowseHeader.SetText1("Video Playlist");oBrowseHeader.SetText2("");oBanner.DrawBrowseView();oFooter.DrawPlaylistView();oNavBar.Clear();var start = 3+(g_bIs16by9 ? 1:0);var navBarProps = new NavBarProperties(start, start+1, "overThumb", "", "clickThumb", "nbThumb", "nbArrThmb nbArr", "nbDvdrThmbEnd", 30);oNavBar.Init("playlist", HtmlArrayForThumbnails(start), g_GUIDs, navBarProps);if (oPlaylist.Items.length > oNavBar.ItemCount){oNavBar.SetRatchet(oPlaylist.Position);}else{oNavBar.SetRatchet(0);}oNavBar.Hover();break;}}function onBrowseLoadComplete(){try{eval(oDataFetcher.Data);setMetaDataGlobals(t_types, t_GUIDs, t_PGs, t_PSs, t_IDs, t_sources, t_headlines, t_captions, t_imageTypes, t_imageUrls, t_videoPaths, t_articleUrls, t_relatedLinkUrls, t_relatedLinkText);addPersonalDataToGlobals();completeBrowseView();}catch (exception){setMetaDataGlobals(null, null, null, null, null, null, null, null, null, null, null, null, null, null);addPersonalDataToGlobals();if (g_types.length == 0){var topicName = (g_nowCatInd == -1) ? g_topics[g_nowTopicInd] : g_cats[g_nowTopicInd][g_nowCatInd];if (topicName != null)oMessagePopup.Warning("There are no videos available in the \"" + topicName + "\" category.", "");drawBottom(NAV_VIEW_HOME);}else{completeBrowseView();}}updateBacklist();}function onBrowseLoadFail(){}function completeBrowseView(){var headerText= "<b>"+ g_topics[g_nowTopicInd]+ " &#151; "+ ((g_nowCatInd == -1) ? "All" : g_cats[g_nowTopicInd][g_nowCatInd])+ "</b>";oBanner.DrawBrowseView();oFooter.DrawBrowseView(); oBrowseHeader.MediaCount = g_types.length;oBrowseHeader.SetText1(headerText);oBrowseHeader.SetText2("");oJsPreloader.Load(g_nowTopicInd, g_nowCatInd);var start = 3+(g_bIs16by9 ? 1:0);var navBarProps = new NavBarProperties(start, start+1, "overThumb", "", "clickThumb", "nbThumb", "nbArrThmb nbArr", "nbDvdrThmbEnd", 30);oNavBar.Init("category", HtmlArrayForThumbnails(start), g_GUIDs, navBarProps);oNavBar.Hover();if (oSettingsArea.RestartVideo){oMediaPlayer.PauseMedia(false);oSettingsArea.RestartVideo = false;}}function refreshPlaystateFeedback(){oMetadataPopup.Hide();oBrandingArea.Refresh();oNavBar.Refresh();oOnDeckArea.Refresh();oVideoMetadata.Refresh();}function updateBacklist(){oBacklistManager.Append(g_nowTopicInd, g_nowCatInd, g_nowTopView, g_nowNavView);}function videoGoBack(){if (oCategoryChooser.Div.style.visibility == "visible"){oCategoryChooser.Hide();oFooter.Hover();return true;}if (oBacklistManager.Items.length<2){if (okToLeaveApp()){oPlaylist.RemoveAll();g_bIgnorePostStop = true;oMediaPlayer.StopMedia();return false;}return;}var prevState = oBacklistManager.Items[oBacklistManager.Items.length -2];var prevTopic = prevState[0];var prevCat = prevState[1];var prevVidSize = prevState[2];var prevNavView = prevState[3];oBacklistManager.RemoveLast();if ((prevNavView == NAV_VIEW_PLAYLIST) && (oPlaylist.Items.length == 0)){return videoGoBack();}if ((prevVidSize == TOPVIEW_SLIDESHOW) && (oPlaylist.Items.length != 0))prevVidSize = TOPVIEW_VIDEO;if (oPlaylist.Items.length == 0)prevVidSize = TOPVIEW_SLIDESHOW;if ((g_nowTopicInd == prevTopic) && (g_nowCatInd == prevCat) && (g_nowTopView == prevVidSize) && (g_nowNavView == prevNavView)){return videoGoBack();}var topicName = (prevCat == -1) ? g_topics[prevTopic] : g_cats[prevTopic][prevCat];if (topicName == null && prevNavView == NAV_VIEW_BROWSE)return false;g_nowTopicInd = prevTopic;g_nowCatInd = prevCat;drawTop(prevVidSize);drawBottom(prevNavView);return true;}function HtmlArrayForIcons(){var html = new Array();var cat;var imgClass;for (var i=0; i<=g_topics.length; i++){cat = (i==g_topics.length) ? "Playlist" : g_topics[i];html[i] = "<table class=\"nbTopic\" id=\"" + cat + "\">"+ "<tr>"+ "<td align=center>"+ cat+ "</td>"+ "</tr>"+ "</table>";}return html;}function HtmlArrayForThumbnails(divideAfter){var html = new Array();var txt;var img;var h;var tableWidth;var textCellClass;for (var i=0; i<g_types.length; i++){switch (g_types[i]){case "Weather":txt = (p_userWeatherCity==null) ? "your city" : p_userWeatherCity;img = (p_userWeatherConditionImg==null) ? "" : imageTag(p_userWeatherConditionImg, '', '83', 'thumbWthrImg');  break;default:txt = g_headlines[i];img = imageTag(g_imageUrls[i], 110, 83, "thumbImg");}if (i==g_types.length-1 && i>=divideAfter){textCellClass = "nbThumbTxt nbThumbTxtNrrw";}else{textCellClass = "nbThumbTxt nbThumbTxtWide";}h= "<div class=\"nbThumbDiv\" >"+ "<span class=\"nbThumbImg\" >"+ img+ "</span>"+ "<span class=\"" + textCellClass + "\">"+ txt+ "</span>"+ "</div>";html[i] = h;}return html;}function loadPersonalData(){window.clearTimeout(iPersonalDataTimerId);var url = urlToPersonalData(_mceGetUserZip());oDataFetcher.GetData(url, firstLoadPersonlData, onLoadPersonalDataFail, true);}function firstLoadPersonlData(){onLoadPersonalData(false);}function reloadPersonlData(){onLoadPersonalData(true);}function onLoadPersonalData(settingsRefresh){try{eval(oDataFetcher.Data);setPersonalDataGlobals(t_types, t_titles, t_slideHtml, t_abstractHtml, t_metdataHtml, t_userWeatherCity, t_userWeatherConditionImg, t_stockDirection);oSlideShow.SetPersonalSlides(p_slideHtml, p_abstractHtml);addPersonalDataToGlobals();if (settingsRefresh)window.setTimeout(onSettingsRefresh,100);}catch (exception){onLoadPersonalDataFail();}}function onLoadPersonalDataFail(){}function nextSlide(){window.clearTimeout(iSlideShowTimerId);oSlideShow.Next();iSlideShowTimerId = window.setTimeout(nextSlide, iSlideShowInterval);}function ssHtmlSlides(){var slides = new Array();for (var i=0; i<g_ssImages.length; i++){slides[i]= '<img src="' + g_ssImages[i] + '" class="ssImg" />';}return slides;}function ssHtmlAbstracts(){var abstracts = new Array();for (var i=0; i<g_ssHeadlines.length; i++){abstracts[i]= "<span class=\"ssTxt1\">"+ g_ssHeadlines[i]+ "</span><span class=\"ssTxt2\">"+ g_ssCaptions[i]+ "</span>";}return abstracts;}function overButton(ob){ob.children[0].className = "mceBtn mceBtn1 mceBtn1_over";ob.children[1].className = "mceBtn mceBtn2 mceBtn2_over";ob.children[2].className = "mceBtn mceBtn3 mceBtn3_over";}function offButton(ob){ob.children[0].className = "mceBtn mceBtn1 mceBtn1_off";ob.children[1].className = "mceBtn mceBtn2 mceBtn2_off";ob.children[2].className = "mceBtn mceBtn3 mceBtn3_off";}function overIcon(i){var nowMenuItem = oNavBar.GetMenuItem(i);if (nowMenuItem == null)return;var nowIcon = nowMenuItem.children(0);nowIcon.className = "nbTopic nbTopicO";}function offIcon(i){if (g_nowNavView != NAV_VIEW_HOME)return;var nowMenuItem = oNavBar.GetMenuItem(i);if (nowMenuItem == null)return;var nowIcon = nowMenuItem.children(0);nowIcon.className = "nbTopic";}function clickIcon(i){var iconId = oNavBar.GetMenuItem(i).children(0).id;if (iconId == "Playlist"){toPlaylist();}else{ var topicInd = (i + oNavBar.CurrentRatchet) % oNavBar.HTML.length;toCat(topicInd,-1);}}function overThumb(i){oBrowseHeader.SetText2("(" + oNavBar.GetItemIndex(i) + " of " + oBrowseHeader.MediaCount + ")");}function setThumbClasses(ob, currentlyPlaying, narrowThumb){var baseClass = "nbThumb"+ (narrowThumb ? " nbThumbNrrw" : " nbThumbWide")+ (currentlyPlaying ? " nbThumbCP" : " nbThumbNoCP");ob.ClassOff = baseClass + (narrowThumb ? " nbThumbN_off" : " nbThumbW_off");ob.ClassOver = baseClass + (narrowThumb ? " nbThumbN_over" : " nbThumbW_over");ob.ClassPressed = baseClass + (narrowThumb ? " nbThumbN_pressed" : " nbThumbW_pressed");ob.className = (ob == GetCurrentHover()) ? ob.ClassOver : ob.ClassOff;}var g_mclWasAdded;function clickAddToStart(){g_mclWasAdded = addToStartMenu();if (g_mclWasAdded)oFooter.DrawHomeView();oFooter.Hover();}function showTos(){DeviceClickAway("http://privacy.msn.com/tou", "MSNTV Today Terms of Use");}function showWeather(){oMetadataPopup.Refresh(p_metdataHtml[0]);oMetadataPopup.DrawHideButton("wthrBtn1");oMetadataPopup.DrawChangeCityButton("wthrBtn2");oMetadataPopup.Show();oMetadataPopup.Focus();}function showStocks(){oMetadataPopup.Refresh(p_metdataHtml[1]);oMetadataPopup.DrawHideButton("stckHideBtn");oMetadataPopup.Show();oMetadataPopup.Focus();}function clickHomeButton(){drawBottom(NAV_VIEW_HOME);updateBacklist();}function clickSlide(){var a = oSlideShow.Slides[oSlideShow.CurrentSlide].ShowcaseIndex;if (a != null){addSlideshowToPlaylist(a);playItemAfterAd(oPlaylist.Position+1);oNavBar.Hover();}else{var ind = oSlideShow.Slides[oSlideShow.CurrentSlide].PersonalIndex;var personalType = p_types[ind];for (var a=0; a<g_topics.length; a++){var c = (g_cats[a] == null) ? 0 : g_cats[a].length;for (var b=-1; b<c; b++){var topicName = (b == -1) ? g_topics[a] : g_cats[a][b];if ( ((personalType == "Weather") && (topicName == "Weather")) || ((personalType == "Stocks") && (topicName == "Market Updates")) ){toCat(a,b);return;}}}}}function clickPlayTop(){var a = oSlideShow.Slides[oSlideShow.CurrentSlide].ShowcaseIndex;if (a == null)a = 0;addSlideshowToPlaylist(a);playItemAfterAd(oPlaylist.Position+1);oNavBar.Hover();}function overPlayTop(){overButton(oSlideShow.Button);}function offPlayTop(){offButton(oSlideShow.Button);}function clickPlayAll(){var topicName = (g_nowCatInd == -1) ? g_topics[g_nowTopicInd] : g_cats[g_nowTopicInd][g_nowCatInd];if (catHasClipsNotInPlaylist()){oMessagePopup.AutoHide("Adding all " + htmlDecode(topicName) + " videos to the playlist and preparing to play");iPlayAllTimerId = window.setTimeout(playAllContinue,100);}else{ for (var i=0; i<g_types.length; i++){if (g_types[i] == "video"){clickThumb(i);break;}}}}function playAllContinue(){window.clearTimeout(iPlayAllTimerId);addCategoryToPlaylist();playItemAfterAd(oPlaylist.Position+1);oFooter.PlayAllBtn.Hover();}function clickDeleteAll(){if (oMessagePopup.Confirm("Are you sure you want to empty your playlist?")){oPlaylist.RemoveAll();onClearPlaylist();}}function onPlayListChange(){refreshPlaystateFeedback();}function onPlaylistEnd(){drawTop(TOPVIEW_SLIDESHOW);updateBacklist();oNavBar.Hover();}function onClearPlaylist(){oPlaylist.MoveTo(-1);if (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING){g_bIgnorePostStop = true;oMediaPlayer.StopMedia();}drawTop(TOPVIEW_SLIDESHOW);drawBottom(NAV_VIEW_HOME);updateBacklist();}function clickBrowseButton(){oCategoryChooser.Show(g_nowTopicInd, g_nowCatInd);}function overBrowseButton(){oCategoryChooser.Hide();}function clickBrowseBtn(){}function clickHideMPBtn(){oMetadataPopup.Hide();oNavBar.Hover();}function clickAd(){DeviceClickAway(oAdManager.GetClickThroughUrl(), oAdManager.GetClickThroughUrl());}function clickRelatedLink(url, ind){var trackingUrl = oTrackingManager.TrackRelatedLink(url, ind, oPlaylist.GetCurrent());DeviceClickAway(trackingUrl, oPlaylist.GetCurrent().Title);}function changeCity(){oSettingsArea.SetPage("Weather");oSettingsArea.PreLoadTopView = g_nowTopView;oSettingsArea.PreLoadBottomView = g_nowNavView;oSettingsArea.RestartVideo = (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING);if (oSettingsArea.RestartVideo)oMediaPlayer.PauseMedia(true);restrictMouse(oSettingsArea.Frame);drawTop(TOPVIEW_SETTINGS);}function onSettingsComplete(){var url = urlToPersonalData(_mceGetUserZip());oDataFetcher.GetData(url, reloadPersonlData, onLoadPersonalDataFail);}var iReShowWeather;function onSettingsRefresh(){drawTop(oSettingsArea.PreLoadTopView);drawBottom(oSettingsArea.PreLoadBottomView);iReShowWeather = window.setTimeout(reShowWeather, 100);}function reShowWeather(){window.clearTimeout(iReShowWeather);var weatherTileInd = -1;for (var i=0; i<g_types.length; i++){if (g_types[i] == "Weather")weatherTileInd = i;}if (weatherTileInd != -1){oNavBar.SetRatchet(weatherTileInd);clickThumb(0);}}function clickThumb(ind){ var isLoading = (g_clipLoadTimer!=null & !g_clipLoadedInTime);handleThumbClick(ind, isLoading);}function doClear(){if (g_nowNavView != NAV_VIEW_PLAYLIST)return false;  var i = GetCurrentHover().id.indexOf("menuItem_");if (i == -1)return false;  var thumbInd;try{thumbInd = parseInt(GetCurrentHover().id.substring(i+9,GetCurrentHover().id.length));thumbInd = thumbInd + oNavBar.CurrentRatchet;thumbInd = thumbInd % oNavBar.HTML.length;}catch (e){return;}if (g_videoPaths[thumbInd] == "")return false;var inPlaylistAtPos = oPlaylist.IndexOf(g_GUIDs[thumbInd]);if (inPlaylistAtPos == -1)return false;  if (!oMessagePopup.Confirm("Are you sure you want to remove the video from your playlist?"))return false;if (inPlaylistAtPos == oPlaylist.Position){oMediaPlayer.StopMedia();}if (inPlaylistAtPos <= oPlaylist.Position)oPlaylist.Position = oPlaylist.Position-1;oPlaylist.Remove(inPlaylistAtPos);if (oPlaylist.Items.length == 0){onClearPlaylist();return;}var oldRatchet = oNavBar.CurrentRatchet;drawBottom(NAV_VIEW_PLAYLIST);oNavBar.SetRatchet(oldRatchet);oNavBar.Hover();}function onPlaybackStart(){refreshPlaystateFeedback();}function onPrepareToPlay(){drawTop(TOPVIEW_VIDEO);updateBacklist();}function postBufferingAction(){}function toCat(a,b){g_nowTopicInd = a;g_nowCatInd = b;drawBottom(NAV_VIEW_BROWSE);updateBacklist();}function toPlaylist(){if (oPlaylist.Items.length == 0){var s = "Your playlist is empty. To add videos to your playlist, first choose a category, then find the video you want to add and press OK on your keyboard or remote control.";var c = "Sorry";oMessagePopup.Warning(s, c);return;}g_nowTopicInd = -1;g_nowCatInd = -1;drawBottom(NAV_VIEW_PLAYLIST);updateBacklist();}function getClass(styleName){var s = document.styleSheets[0].rules;for (var i=0;i<s.length;i++){if(s[i].selectorText == '.' + styleName)return s[i];}return null;}function setClassWidths(arrClasses, width, isReplace){for (var i = 0; i < arrClasses.length; i++){var c = getClass(arrClasses[i]);if (c){var newValue;if (isReplace)newValue = width;else{var oldWidth = c.style.width.substring(0, c.style.width.length-2);newValue = (parseInt(oldWidth)+width);}setClassAttribute(c, "width", newValue);}}}function setClassAttribute(classRule, attr, newValue){switch(attr){case "width":classRule.style.width = newValue+"px";break;case "margin-left":classRule.style.marginLeft = newValue+"px";break;case "margin-right":classRule.style.marginRight = newValue+"px";break;}}