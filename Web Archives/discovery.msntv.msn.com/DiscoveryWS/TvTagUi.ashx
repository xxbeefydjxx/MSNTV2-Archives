"if(!Microsoft)Microsoft=new Object();if(!Microsoft.Msn)Microsoft.Msn=new Object();if(!Microsoft.Msn.MediaTags)Microsoft.Msn.MediaTags=new Object();Microsoft.Msn.MediaTags.TvTagUI={EnableRemoteRecord:false,EnableDetails:true,EnableMSNSearch:true,EnableLiveSearch:true,ObjectRef:\"Microsoft.Msn.MediaTags.TvTagUI\",ObjectName:\"TvTagUI\",DiscoveryWSPath:\"http://discovery.msntv.msn.com/DiscoveryWS\",MediaEventWSPath:\"https://mediaevent.msntv.msn.com/RemoteRecordWS\",WebResourcePath:\"http://discovery.msntv.msn.com/DiscoveryWS/TvTags\",ImagePath:\"http://discovery.msntv.msn.com/DiscoveryWS/TvTags\"+\"/img/\",RemoteRecordPath:\"\",ExactSearchHandler:\"ExactSearch2.ashx\",GetHeadendsHandler:\"GetHeadends.ashx\",SetHeadendHandler:\"SetHeadend.ashx\",GetRemoteDeviceHandler:\"GetRemoteDevice.ashx\",Init:function(onChangeHeadend,includeLinksOnConfirmation){this.OnChangeHeadend=onChangeHeadend;this.DataFetcher=Microsoft.Msn.Tv.DataFetcher;this.ApplyInheritance(this.ActionPanel);this.ApplyInheritance(this.Browser);this.ApplyInheritance(this.ChooseHeadend);this.ApplyInheritance(this.Common);this.ApplyInheritance(this.Details);this.ApplyInheritance(this.ExactSearchUtils);this.ApplyInheritance(this.Record);this.ApplyInheritance(this.Remind);this.ApplyInheritance(this.SignIn);this.ApplyInheritance(this.Styles);this.ApplyInheritance(this.Custom);this.Browser.Init(this);this.Styles.InitOnce(this);this.ActionPanel.InitOnce(this);this.ChooseHeadend.InitOnce(this,includeLinksOnConfirmation);this.Common.InitOnce(this);this.Details.InitOnce(this);this.ExactSearchUtils.InitOnce(this);this.RemoteRecordMgr.InitOnce(this);this.Record.InitOnce(this,this.RemoteRecordMgr);this.Remind.InitOnce(this);this.SignIn.InitOnce(this);this.Custom.InitOnce(this);this.LastPopover=null;this.Common.InitStats();eval(\"var onWaitingMsg = function() {\"+this.ObjectRef+\".SignIn.OnWaitingMsg() }\");eval(\"var onErrorMsg = function() {\"+this.ObjectRef+\".SignIn.OnErrorMsg() }\");eval(\"var onSignInMsg = function() {\"+this.ObjectRef+\".SignIn.OnSignInMsg() }\");eval(\"var onSignInFailedMsg = function() {\"+this.ObjectRef+\".SignIn.OnSignInFailedMsg() }\");eval(\"var onSignOutFailedMsg = function() {\"+this.ObjectRef+\".SignIn.OnSignOutFailedMsg() }\");eval(\"var onSignedIn = function(alreadyAuthenticated) {\"+this.ObjectRef+\".SignIn.OnSignedIn(alreadyAuthenticated) }\");this.PassportMgr.Init(this,onWaitingMsg,onErrorMsg,onSignInMsg,onSignInFailedMsg,onSignOutFailedMsg,onSignedIn);var d1=new Date(2003,1,1);var d2=new Date(2003,7,1);var stdTz=d1.getTimezoneOffset();var dstTz=d2.getTimezoneOffset();this.TZ=-stdTz;this.DST=stdTz!=dstTz;this.DoAfterRecord=null;this.ExactSearchOb=null;this.NowShow=null;this.OmitImage=true;this.SetNowShow(-1,-1);this.Common.HideAll();},ApplyInheritance:function(ob){ob.Parent=this;ob.DataFetcher=Microsoft.Msn.Tv.DataFetcher;ob.Browser=this.Browser;ob.PassportMgr=this.PassportMgr;ob.TestUtils=this.TestUtils;ob.Utils=this.Utils;ob.ActionPanel=this.ActionPanel;ob.ChooseHeadend=this.ChooseHeadend;ob.Common=this.Common;ob.Details=this.Details;ob.ExactSearchUtils=this.ExactSearchUtils;ob.Record=this.Record;ob.Remind=this.Remind;ob.SignIn=this.SignIn;ob.Styles=this.Styles;ob.Custom=this.Custom;},InitProgramTitle:function(){window.clearTimeout(this.ShowTimer);this.NowLink=this.PendingLink;this.ActionPanel.InitOnHover();this.ChooseHeadend.InitOnHover();this.Common.InitOnHover();this.Details.InitOnHover();this.ExactSearchUtils.InitOnHover();this.Record.InitOnHover();this.Remind.InitOnHover();this.SignIn.InitOnHover();this.Styles.InitOnHover();this.Common.HideAll();this.ActionPanel.Show(this.NowLink);this.ExactSearchUtils.DoExactSearch(null,this.ObjectRef+\".ActionPanel.ShowError()\");},OnExactSearchBegin:function(exactSearchOb){this.ExactSearchOb=null;this.SetNowShow(-1,-1);},OnExactSearchComplete:function(exactSearchOb){this.ExactSearchOb=exactSearchOb;var indices;if(this.NowLink.UseSpecificAiring){indices=this.ExactSearchUtils.IndicesToSpecificAiring(exactSearchOb,this.NowLink.StartTime,this.NowLink.ChannelId);}else{indices=this.ExactSearchUtils.IndicesToNextAiring(exactSearchOb);}this.SetNowShow(indices.schedule,indices.airing);if(exactSearchOb.headend.name!=\"\"){var he=exactSearchOb.headend;this.Headend=he;this.ChooseHeadend.HeadendName=he.name;this.ChooseHeadend.HeadendTimezone=he.timezone;this.ChooseHeadend.HeadendId=he.id;this.ChooseHeadend.HeadendNumChan=\"\";}this.ActionPanel.Update(this.NowShow,this.Headend);if(this.ActionPanel.Div.style.display==\"block\"){this.ActionPanel.SetTop(this.NowLink,true);}},SetNowShow:function(sInd,aInd){this.NowShow=(sInd!=-1)?this.ExactSearchUtils.GetShow(this.ExactSearchOb,sInd,aInd):null;this.ScheduleIdx=sInd;this.AiringIdx=aInd;},ShowDetails:function(){if(this.NowShow==null)return;this.Common.LogStats(\"ProgramDetails\",\"Summary\");this.Details.Show('Summary');},DoRecord:function(doAfterRecord){if(this.NowShow==null)return;this.DoAfterRecord=doAfterRecord;eval(\"var onSignIn = function(userWasAlreadyAuth) {\"+this.ObjectRef+\".ContinueRecord(userWasAlreadyAuth); }\");eval(\"var onSignInMsg = function() {\"+this.ObjectRef+\".Record.OnSignInMsg() }\");eval(this.ObjectRef+\".PassportMgr.OnSignInMsg = function() {\"+this.ObjectRef+\".Record.OnSignInMsg() }\");this.SignIn.BeginSignIn(onSignIn);this.Common.LogStats('RemoteRecord','RRInit');},ContinueRecord:function(userWasAlreadyAuth){if(userWasAlreadyAuth){this.Record.DoRecord(this.NowShow);}else{this.RecordAfterSignIn();}},RecordAfterSignIn:function(){if(this.NowShow==null){this.Record.NoUpcomingError();}else{this.Record.DoRecord(this.NowShow);}},DoSearch:function(target){var title=\"\";title=this.NowLink.SearchableTitle;var url;switch(target){case\"live\":this.Common.LogStats('MoreOnLive');url=\"http://www.live.com/#q=tv%20\";url+=encodeURIComponent(title);break;case\"msn\":this.Common.LogStats('MoreOnMSN');url=\"http://tv.msn.com\";break;default:return;}window.open(url,\"\");},DoExactSearchThenAllAirings:function(){this.Common.HideAll();this.Details.Selection=\"AllAirings\";this.Details.SetSidebarSelection();this.Details.Unhide();this.DisplayRetrievingAllAiringsMsg();eval(\"f = function() {\"+this.ObjectRef+\".Details.Show('AllAirings'); }\");this.ExactSearchUtils.DoExactSearch(f);},DoExactSearchThenProgDet:function(){this.Common.HideAll();this.Details.Selection=\"Summary\";this.Details.SetSidebarSelection();this.Details.Unhide();this.Common.DisplayMessage(this.Details.Mainarea,\"waiting\",\"Getting program details. Please wait...\");eval(\"onLoad = function() {\"+this.ObjectRef+\".Details.Show('Summary'); }\");this.ExactSearchUtils.DoExactSearch(onLoad);},DisplayRetrievingAllAiringsMsg:function(){this.Common.DisplayMessage(this.Details.Mainarea,\"waiting\",\"Retrieving information for all airings. Please wait...\");},AttachTagInUIMgr:function(ob,cssString,omitImage,beakMarginX,beakMarginY){var s=ob.attributes[\"SearchTitle\"];if(s!=null&&s.value!=null)s=s.value;else{s=ob.innerHTML.replace(/<[^>]+>/g,\"\");}if(s==null||s.length==0)return;this.Styles.SetBeakMargins(beakMarginX,beakMarginY);if(cssString!=null){ob.UsesDefaultStyleBehavior=false;this.Styles.ApplyCSS(ob,cssString);}else{ob.UsesDefaultStyleBehavior=true;this.Styles.Apply(ob,\"tvTag\");}if(omitImage!=true){this.OmitImage=false;oImg=document.createElement(\"img\");oImg.src=this.ImagePath+\"tvtag_icon_10x10.gif\";oImg.style.cssText=\"margin-left:1px;cursor:pointer;width:10px;height:10px;\";var p=ob.parentNode;p.insertBefore(oImg,ob.nextSibling);eval(\"oImg.onmouseover = function() { \"+this.ObjectRef+\".OnOverIcon(ob); };\");eval(\"oImg.onmouseout = function() { \"+this.ObjectRef+\".OnLeaveIcon(ob); };\");eval(\"oImg.onclick = function() { \"+this.ObjectRef+\".OnClickTag(ob); };\");}var reNBSP=/&nbsp;/g;var reAMP=/&amp;/g;ob.DisplayableTitle=s.replace(reNBSP,\" \");ob.SearchableTitle=s.replace(reNBSP,\" \");ob.SearchableTitle=ob.SearchableTitle.replace(reAMP,\"&\");eval(\"ob.onmouseover = function() { \"+this.ObjectRef+\".OnOverTag(this); };\");eval(\"ob.onmouseout = function() { \"+this.ObjectRef+\".OnLeaveTag(this); };\");eval(\"ob.onclick = function() { \"+this.ObjectRef+\".OnClickTag(this); };\");},OnOverTag:function(ob){if(ob.UsesDefaultStyleBehavior)ob.style.textDecoration='underline';this.PendingLink=ob;eval(\"this.ShowTimer = window.setTimeout(function() {\"+this.ObjectRef+\".InitProgramTitle()}, 500);\");},OnOverIcon:function(ob){if(this.ActionPanel.Div.style.display==\"none\"){this.OnOverTag(ob);}else{window.clearTimeout(this.HideTimer);}},OnLeaveTag:function(ob){ob.style.textDecoration='none';window.clearTimeout(this.ShowTimer);eval(\"this.HideTimer = window.setTimeout(function() {\"+this.ObjectRef+\".ActionPanel.Hide();}, 500);\");},OnLeaveIcon:function(ob){ob.style.textDecoration='none';window.clearTimeout(this.ShowTimer);window.clearTimeout(this.HideTimer);eval(\"this.HideTimer = window.setTimeout(function() {\"+this.ObjectRef+\".ActionPanel.Hide();}, 500);\");},OnOverEnhPrev:function(){window.clearTimeout(this.HideTimer);},OnLeaveEnhPrev:function(){eval(\"this.HideTimer = window.setTimeout(function() {\"+this.ObjectRef+\".ActionPanel.Hide()}, 100);\");},OnClickTag:function(ob){if(ob.UsesDefaultStyleBehavior){ob.style.textDecoration='underline';}this.NowLink=ob;this.InitProgramTitle();},Browser:{Init:function(parent){this.ObjectName=\"Browser\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;this.Parent=parent;this.Common=parent.Common;this.IsIE=false;this.IsMozilla=false;this.IsMCEPC=false;this.AnalyzeBrowser();},AnalyzeBrowser:function(){this.IsInStrictMode=false;if(document.documentElement&&(document.documentElement.clientHeight||document.documentElement.clientHeight))this.IsInStrictMode=true;if(document.getElementById&&document.createElement)this.HasAdvancedScripting=true;var browserName=navigator.appName;this.navigatorUserAgent=navigator.userAgent;this.navigatorAppVersion=navigator.appVersion;this.IsIE=(browserName==\"Microsoft Internet Explorer\")?true:false;this.IsMozilla=(browserName==\"Netscape\")||(browserName==\"Firefox\")?true:false;this.IsMCEPC=(this.navigatorUserAgent.indexOf(\"Media Center\")>-1)||(this.navigatorUserAgent.indexOf(\"MediaCenter\")>-1);},GetWinOrFrameInnerDimensions:function(){var x,y;if(self.innerHeight||typeof(window.innerWidth)=='number'){x=self.innerWidth;y=self.innerHeight;}else if(this.IsInStrictMode){x=document.documentElement.clientWidth;y=document.documentElement.clientHeight;}else if(document.body){x=document.body.clientWidth;y=document.body.clientHeight;}return{x:x,y:y};},GetScrollingOffset:function(){var x,y;if(self.pageYOffset){x=self.pageXOffset;y=self.pageYOffset;}else if(this.IsInStrictMode){x=document.documentElement.scrollLeft;y=document.documentElement.scrollTop;}else if(document.body){x=document.body.scrollLeft;y=document.body.scrollTop;}return{x:x,y:y};},GetPageHeight:function(){var x,y;var test1=document.body.scrollHeight;var test2=document.body.offsetHeight;if(test1>test2){x=document.body.scrollWidth;y=document.body.scrollHeight;}else{x=document.body.offsetWidth;y=document.body.offsetHeight;}return{x:x,y:y};},GetEventTarget:function(e){return(e.target)?e.target:e.srcElement;},GetMousePosition:function(e){var posx=0;var posy=0;if(!e)var e=window.event;if(e.pageX||e.pageY){posx=e.pageX;posy=e.pageY;}else if(e.clientX||e.clientY){var scrl=this.GetScrollingOffset();posx=e.clientX+scrl.x;posy=e.clientY+scrl.y;}var tg=this.GetEventTarget(e);return{x:posx,y:posy,element:tg};}},PassportMgr:{PassportHandler:\"PassportContext.ashx\",PassportPage:\"/html/pplogin.aspx\",Init:function(parent,onWaitingMsg,onErrorMsg,onSignInMsg,onSignInFailedMsg,onSignOutFailedMsg,onSignedIn){this.ObjectName=\"PassportMgr\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;this.Parent=parent;this.DataFetcher=parent.DataFetcher;this.Utils=parent.Utils;this.PassportPagePath=this.Parent.WebResourcePath+this.PassportPage;this.PPWindow=null;this.PPContext=null;this.PPMsg={SummaryText:\"\",DetailsText:\"\",MsgCode:\"\"};this.StateNew=\"new\";this.StateSignedIn=\"signedIn\";this.StateWaitingForSignOut=\"waitingForSignOut\";this.StateSignInMsg=\"signInMsg\";this.StateSignOutFailedMsg=\"signOutFailedMsg\";this.StateSignInFailedMsg=\"signInFailedMsg\";this.StateAttemptedSignIn=\"attemptedSignIn\";this.PPSignInState=this.StateNew;this.OnWaitingMsg=onWaitingMsg;this.OnErrorMsg=onErrorMsg;this.OnSignInMsg=onSignInMsg;this.OnSignInFailedMsg=onSignInFailedMsg;this.OnSignOutFailedMsg=onSignOutFailedMsg;this.OnSignedIn=onSignedIn;this.MsgWaitingForStatus=\"waitingForStatus\";this.MsgWaitingForSignOut=\"waitingForSignOut\";this.MsgWaitingForSignIn=\"waitingForSignIn\";return true;},PPSignIn:function(){this.AlreadyAuthenticated=true;this.CommonToSignInAndOut();},CommonToSignInAndOut:function(){this.PPSignInState=this.StateNew;this.GetPPMsgText(this.MsgWaitingForStatus);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnWaitingMsg();}, 1);\");this.GetPassportContext();},PPSignInResume:function(){if(this.PPSignInState==this.StateSignOutFailedMsg){this.PPSignInState=this.StateWaitingForSignOut;this.GetPPMsgText(this.MsgWaitingForSignOut);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnWaitingMsg();}, 1);\");this.CreatePPWindow();}else{if(this.PPSignInState==this.StateSignInMsg||this.PPSignInState==this.StateSignInFailedMsg){this.PPSignInState=this.StateAttemptedSignIn;this.GetPPMsgText(this.MsgWaitingForSignIn);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnWaitingMsg();}, 1);\");this.CreatePPWindow();}else{this.GetPPMsgText(\"invalidState\");eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnErrorMsg();}, 1);\");}}},GetPPMsgText:function(msgCode,replaceStrings){var summaryText=\"\";var detailsText=\"\";if(msgCode==this.MsgWaitingForStatus){summaryText=\"Waiting for Passport information...\";}else{if(msgCode==this.MsgWaitingForSignOut){summaryText=\"Your Passport session has timed out. Waiting for Passport sign out to complete...\";}else{if(msgCode==this.MsgWaitingForSignIn){summaryText=\"Waiting for you to sign in to Passport...\";}else{if(msgCode==this.StateSignedIn){summaryText=\"You are now signed in to Passport.\";}else{if(msgCode==this.StateSignInMsg){summaryText=\"To perform this action, you must be signed into Passport.\";}else{if(msgCode==this.StateSignOutFailedMsg){summaryText=\"Passport sign out was unsuccessful. Try again.\";}else{if(msgCode==this.StateSignInFailedMsg){summaryText=\"Passport sign in was unsuccessful. Try again.\";}else{if(msgCode==\"onPPContextError\"||msgCode==\"onPPContextTimeout\"){summaryText=\"Passport is unavailable at this time. Try again later.\";}else{if(msgCode==\"OnErrorMsg\"){summaryText=\"An error occurred\";}else{summaryText=\"Invalid msgCode '\"+msgCode+\"'\";}}}}}}}}}if(replaceStrings!=null){var replaceStringsArray=replaceStrings.split(\"|\");summaryText=this.Utils.StringFormat(summaryText,replaceStringsArray);detailsText=this.Utils.StringFormat(detailsText,replaceStringsArray);}this.PPMsg.SummaryText=summaryText;this.PPMsg.DetailsText=detailsText;this.PPMsg.MsgCode=msgCode;},GetPassportContext:function(){var url=this.Parent.DiscoveryWSPath+\"/\"+this.PassportHandler+\"?ru=\"+encodeURIComponent(this.PassportPagePath);eval(\"onLoad = function(result) {\"+this.ObjectRef+\".OnPPContextLoad(result); };\");eval(\"onTimeout = function() {\"+this.ObjectRef+\".OnPPContextTimeout(); };\");eval(\"onError = function() {\"+this.ObjectRef+\".OnPPContextError(); };\");this.DataFetcher.LoadURL(url,false,true,20000,onLoad,onTimeout,onError);},OnPPContextLoad:function(passportContext){this.PPContext=passportContext;if(this.PPContext.isAuthenticated){this.DataFetcher.ClearCache();this.PPSignInState=this.StateSignedIn;this.GetPPMsgText(this.PPSignInState);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnSignedIn(\"+this.AlreadyAuthenticated+\");}, 1);\");}else{this.AlreadyAuthenticated=false;if(this.PPSignInState==this.StateNew){if(this.PPContext.requiresRedirect){this.PPSignInState=this.StateWaitingForSignOut;this.GetPPMsgText(this.MsgWaitingForSignOut);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnWaitingMsg();}, 1);\");this.CreatePPWindow();}else{this.PPSignInState=this.StateSignInMsg;this.GetPPMsgText(this.PPSignInState);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnSignInMsg();}, 1);\");}}else{if(this.PPSignInState==this.StateWaitingForSignOut||this.PPSignInState==this.StateSignOutFailed){if(this.PPContext.requiresRedirect){this.PPSignInState=this.StateSignOutFailedMsg;this.GetPPMsgText(this.PPSignInState);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnSignOutFailedMsg();}, 1);\");}else{this.PPSignInState=this.StateSignInMsg;this.GetPPMsgText(this.PPSignInState);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnSignInMsg();}, 1);\");}}else{if(this.PPSignInState==this.StateAttemptedSignIn){if(this.PPContext.requiresRedirect){this.PPSignInState=this.StateSignOutFailedMsg;this.GetPPMsgText(this.PPSignInState);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnSignOutFailedMsg();}, 1);\");}else{this.PPSignInState=this.StateSignInFailedMsg;this.GetPPMsgText(this.PPSignInState);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnSignInFailedMsg();}, 1);\");}}}}}},OnPPContextTimeout:function(){this.GetPPMsgText(\"onPPContextTimeout\");eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnErrorMsg();}, 1);\");},OnPPContextError:function(){this.GetPPMsgText(\"onPPContextError\");eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnErrorMsg();}, 1);\");},CreatePPWindow:function(){var winProps=\"width=950,height=480,status=yes,scrollbars=yes\";this.PPWindow=window.open(this.PPContext.webLoginURL,\"ppWindow\",winProps);eval(\"this.PPPoller = window.setInterval(function() { \"+this.ObjectRef+\".WaitForPPWinToClose(); }, 1000);\");this.PPWindow.focus();},WaitForPPWinToClose:function(){if(this.PPWindow.closed){window.clearInterval(this.PPPoller);eval(\"onLoad = function(result) {\"+this.ObjectRef+\".OnPPContextLoad(); };\");eval(\"onTimeout = function() {\"+this.ObjectRef+\".OnPPContextTimeout(); };\");eval(\"onError = function() {\"+this.ObjectRef+\".OnPPContextError(); };\");eval(this.Parent.ObjectRef+\".PassportMgr.GetPassportContext(onLoad, onTimeout, onError);\");}},AbortSignin:function(){if(this.PPWindow!=null&&this.PPWindow!='undefined'&&this.PPWindow.closed==false){this.PPWindow.close();}if(this.PPPoller!=null&&this.PPPoller!='undefined'){window.clearInterval(this.PPPoller);}}},RemoteRecordMgr:{MediaEventWSPath:\"https://mediaevent.msntv.msn.com/RemoteRecordWS\",GetRemoteDeviceHandler:\"GetRemoteDevice.ashx\",InitOnce:function(parent){this.ObjectName=\"RemoteRecordMgr\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;this.Utils=parent.Utils;this.Parent=parent;this.DataFetcher=parent.DataFetcher;},SetCallbacks:function(onWaitingMsg,onErrorMsg,onValidateDevice,onConflict,onHeadendChange,onSuccess){this.OnWaitingMsg=onWaitingMsg;this.OnErrorMsg=onErrorMsg;this.OnValidateDevice=onValidateDevice;this.OnConflict=onConflict;this.OnHeadendChange=onHeadendChange;this.OnSuccess=onSuccess;this.SetHeadendUrl=this.Parent.DiscoveryWSPath+\"/\"+this.Parent.SetHeadendHandler;this.RRMsg={SummaryText:\"\",DetailsText:\"\",MsgCode:\"\"};this.GetRemoteDeviceResponse=null;this.RemoteRecordResponse=null;return true;},CheckForDevice:function(title){this.Title=title;this.GetMsgText('checkingForRR');this.SendWaitingMsg();var url=this.MediaEventWSPath+\"/\"+this.GetRemoteDeviceHandler+\"?deviceType=MCE\";eval(\"onLoad = function(result, title) {\"+this.ObjectRef+\".OnGetRemoteDevice(result, \\\"\"+title+\"\\\"); };\");eval(\"onTimeout = function() {\"+this.ObjectRef+\".OnGetRemoteDeviceTimeout(); };\");eval(\"onError = function() {\"+this.ObjectRef+\".OnGetRemoteDeviceError(); };\");this.DataFetcher.LoadURL(url,false,true,35000,onLoad,onTimeout,onError);},OnGetRemoteDevice:function(remoteDeviceString,title){eval(remoteDeviceString);this.GetRemoteDeviceResponse=gRemoteDevice;if(this.GetRemoteDeviceResponse==null){this.GetMsgText(\"upsell\",title);this.SendErrorMsg();}else{eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnValidateDevice();}, 1);\");}},OnGetRemoteDeviceTimeout:function(){this.GetMsgText(\"getDeviceTimeout\");this.SendErrorMsg();},OnGetRemoteDeviceError:function(){this.GetMsgText(\"getDeviceError\");this.SendErrorMsg();},SubmitRecordRequest:function(title,utcDate,callLetters,channelID,channelPos,duration,progID,headendID,headendZip,isSeries,shouldAllowConflict){if(title==null||utcDate==null||callLetters==null||channelID==null||channelPos==null||duration==null||progID==null||headendID==null){this.GetMsgText(\"insufficientData\");this.SendErrorMsg();return;}this.GetMsgText(\"sendingRequest\");this.SendWaitingMsg();try{eval(\"onComplete = function(response) {\"+this.ObjectRef+\".OnSubmitRecordComplete(response); };\");eval(\"onTimeout = function() {\"+this.ObjectRef+\".OnSubmitRecordTimeout(); };\");eval(\"onError = function() {\"+this.ObjectRef+\".OnSubmitRecordError(); };\");this.Date=utcDate;this.CallLetters=callLetters;this.ChanID=channelID;this.ChannelPos=channelPos;this.Duration=Math.floor(duration/60);this.ProgId=progID;this.HeadendID=headendID;this.HeadendZip=headendZip;this.IsSeries=isSeries;this.AllowConflict=shouldAllowConflict;this.GetRemoteDeviceResponse.AddRecording2(this.Title,this.Date,this.CallLetters,this.ChanID,this.ChannelPos,this.Duration,this.ProgId,this.HeadendID,this.IsSeries,this.AllowConflict,true,onComplete,onTimeout,onError);}catch(e){this.GetMsgText(\"recordFailure\",e.message);this.SendErrorMsg();}},OnSubmitRecordComplete:function(recordingResp){this.RemoteRecordResponse=recordingResp;var responseCode=this.RemoteRecordResponse.ResponseCode;switch(responseCode){case\"ALREADY_SCHEDULED\":this.GetMsgText(responseCode);this.SendErrorMsg();break;case\"CANNOT_REACH_CLIENT\":case\"CLIENT_NOT_RESPONDED\":this.GetMsgText(responseCode);this.SendErrorMsg();break;case\"CLIENT_VERSION_OUTDATED\":this.GetMsgText(responseCode);this.SendErrorMsg();break;case\"CONFLICT_NOT_SCHEDULED\":this.GetMsgText(responseCode);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnConflict();}, 1);\");break;case\"GUIDE_DATA_EXPIRED\":case\"GUIDE_NOT_CONFIGURED\":this.GetMsgText(recordingResp);this.SendErrorMsg();break;case\"HEADEND_OUTSYNC\":this.GetMsgText(responseCode);this.SendWaitingMsg();url=this.SetHeadendUrl+\"?zipCode=\"+this.RemoteRecordResponse.NewZipCode+\"&headend=\"+this.RemoteRecordResponse.NewHeadend;eval(\"onLoad = function(result) {\"+this.ObjectRef+\".OnSetHeadendLoad(result); };\");eval(\"onTimeout = function() {\"+this.ObjectRef+\".OnSetHeadendTimeout(); };\");eval(\"onError = function() {\"+this.ObjectRef+\".OnSetHeadendError(); };\");this.DataFetcher.LoadURL(url,false,true,10000,onLoad,onTimeout,onError);break;case\"MAX_RECORDINGS_EXCEEDED\":this.GetMsgText(responseCode);this.SendErrorMsg();break;case\"SCHEDULE_NOT_FOUND\":this.GetMsgText(responseCode);this.SendErrorMsg();break;case\"SCHEDULED\":this.GetMsgText(responseCode);eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnSuccess();}, 1);\");break;case\"TUNER_NOT_CONFIGURED\":this.GetMsgText(responseCode);this.SendErrorMsg();break;case\"USER_DISABLED\":this.GetMsgText(responseCode);this.SendErrorMsg();break;case\"INVALID_PUID\":case\"MONITOR_LOCK_FAILED\":case\"PUID_NOT_REGISTERED\":case\"SERVICE_ERROR\":case\"UNKNOWN_DEVICE_TYPE\":case\"UNKNOWN_ERROR\":this.GetMsgText(\"UNKNOWN_ERROR\");this.SendErrorMsg();break;}},OnSubmitRecordTimeout:function(){this.GetMsgText(\"submitRecordTimeout\");this.SendErrorMsg();},OnSubmitRecordError:function(){this.GetMsgText(\"submitRecordError\");this.SendErrorMsg();},GetMsgText:function(msgCode,replaceStrings){var s;this.RRMsg.SummaryText=\"\";this.RRMsg.DetailsText=\"\";this.RRMsg.MsgCode=msgCode;switch(msgCode){case\"SCHEDULED\":if(!this.IsSeries){this.RRMsg.SummaryText=\"<b>Confirmed:</b> The following show has been successfully scheduled:\";}else{this.RRMsg.SummaryText=\"<b>Confirmed:</b> The following series has been successfully scheduled:\";}this.RRMsg.DetailsText=this.Title;break;case\"checkingForRR\":this.RRMsg.SummaryText=\"Checking to see if you have set up Remote Record. Please wait...\";break;case\"CONFLICT_NOT_SCHEDULED\":var recordingResp=this.RemoteRecordResponse;this.RRMsg.SummaryText=\"<b>Resolve Recording Conflict:</b>\";if(recordingResp.Conflicts.length>1){this.RRMsg.SummaryText+=\" The show \\\"\"+this.Title+\"\\\" conflicts with two or more recordings already scheduled at this time.\";}else{this.RRMsg.SummaryText+=\" The show \\\"\"+this.Title+\"\\\" conflicts with a previously scheduled recording: \\\"\"+recordingResp.Conflicts[0].ConflictingTitle+\"\\\"\";}break;case\"upsell\":this.RRMsg.SummaryText=\"<b>Introducing MSN Remote Record</b><p/>\";this.RRMsg.DetailsText=\"To record episodes of \\\"\"+this.Title+\"\\\" you must use the MSN Remote Record service.<p/>\"+\"<p><a id='UpsellServiceLink' href='' onclick='\"+this.ObjectRef+\".RRInfoPopupWin(\\\"http://tv.msn.com/tv/RR/RRInfo.aspx\\\"); return false;'>The MSN Remote Record service</a>\"+\" lets Windows XP Media Center Edition 2005 users schedule TV show recordings from any PC with an Internet connection.\"+\"<p>You can set up the MSN Remote Record service on your Windows Media Center PC and start using it today!<p/>\"+\"<a id='UpsellLearnRR' href='' onclick='\"+this.ObjectRef+\".OnClickMoreAbouRR(); return false;'>Learn more about MSN Remote Record</a><p/>\"+\"<p><a id='UpsellEmailReminder' href='\"+\"mailto:?\"+\"subject=Reminder: Set Up the MSN Remote Record Service\"+\"&amp;Body=Dont forget to set up the Remote Record service on your Windows XP Media Center Edition-based PC! \"+\"To get started, go to the Remote Record service Setup page at: http://tv.msn.com/tv/RR/RRSetup.aspx\"+\"'>Set up reminder</a></p>\"+\"<p>Don't have Windows XP Media Center Edition 2005?</p>\"+\"<p>With Windows XP Media Center Edition 2005, you get all the power and functionality of Windows XP, plus new features that let you watch and record TV, manage your music, play DVDs, and more.\"+\"<p><a id='UpsellLearnMCE' href=''onclick='\"+this.ObjectRef+\".RRInfoPopupWin(\\\"http://www.microsoft.com/windowsxp/mediacenter/default.mspx\\\"); return false;'>Learn more about Windows XP Media Center Edition</a><p/>\";break;case\"getDeviceTimeout\":case\"getDeviceError\":this.RRMsg.SummaryText=\"We are unable to communicate with your Remote Record device.\";break;case\"insufficientData\":this.RRMsg.SummaryText=\"No data is available. Try again later\";break;case\"sendingRequest\":var msg=\"Your recording request \";if(this.Title!=null&&this.Title!='undefined'&&this.Title!=\"\"){msg+=\"for \\\"\"+this.Title+\"\\\"\";}msg+=\" is in progress. Please wait...\";this.RRMsg.SummaryText=msg;break;case\"submitRecordTimeout\":case\"submitRecordError\":this.RRMsg.SummaryText=\"<b>We could not complete your record request.</b> Please try again later.\";break;case\"setHeadendTimeout\":case\"setHeadendError\":this.RRMsg.SummaryText=\"We are unable to synchronize your TV channel lineup with your Windows Media Center PC.\";break;case\"cancelRequest\":this.RRMsg.SummaryText=\"Record attempt cancelled.\";break;case\"recordFailure\":this.RRMsg.SummaryText=\"Record failure: {0}\";break;case\"ALREADY_SCHEDULED\":this.RRMsg.SummaryText=\"This show is already scheduled to record.\";break;case\"CANNOT_REACH_CLIENT\":case\"CLIENT_NOT_RESPONDED\":if(this.Title!=null&&this.Title!='undefined'&&this.Title!=\"\"){this.RRMsg.SummaryText=\"<b>\"+this.Title+\" did not record:</b> Your request to record \\\"\"+this.Title+\"\\\"\";}else{this.RRMsg.SummaryText=\"Your remote record request \";}this.RRMsg.SummaryText+=\" could not be fulfilled.\";this.RRMsg.DetailsText=\"There was a problem connecting to your XP Media Center PC. Please check that your Media Center PC is turned on and connected to the Internet.\";break;case\"CLIENT_VERSION_OUTDATED\":this.RRMsg.SummaryText=\"Your current version of the Remote Record service is out-of-date.\";this.RRMsg.DetailsText=\"Please visit the Remote Record Update Center from your Start menu to get the latest version.\";break;case\"GUIDE_DATA_EXPIRED\":case\"GUIDE_NOT_CONFIGURED\":this.RRMsg.SummaryText=\"Your Media Center PC Program Guide is out of date.\";this.RRMsg.DetailsText=\"Please update your Program Guide.\";break;case\"HEADEND_OUTSYNC\":this.RRMsg.SummaryText=\"Synchronizing the TV channel lineup for your Windows Media Center PC.  Please wait...\";break;case\"headendOutSyncComplete\":this.RRMsg.SummaryText=\"<b>Synchronizing your TV listings:</b> \\\"\"+this.Title+\"\\\" did not record. \"+\"When you scheduled this recording, the TV listings on your Media Center PC did not match your TV provider\\'s listings. The listings have now been synchronized.\";break;case\"MAX_RECORDINGS_EXCEEDED\":this.RRMsg.SummaryText=\"You have exceeded the maximum number of recording requests.\";break;case\"SCHEDULE_NOT_FOUND\":this.RRMsg.SummaryText=\"This show was not found.\";this.RRMsg.DetailsText=\"The Program Guide on your Media Center may not be updated, or the channel lineup you've chosen on MSN may not match the Media Center channel lineup.\";break;case\"TUNER_NOT_CONFIGURED\":this.RRMsg.SummaryText=\"Your Media Center PC tuner is not configured.\";this.RRMsg.DetailsText=\"Please configure your tuner and try again.\";break;case\"USER_DISABLED\":this.RRMsg.SummaryText=\"Remote Record is disabled on your Media Center PC.\";this.RRMsg.DetailsText=\"To turn Remote Record on, follow these steps: Go to your Start menu, Select Settings, Select General, Select More Program Options, Make sure the 'Control the media experience in Media Center' option is checked, and select Save\";break;case\"UNKNOWN_ERROR\":this.RRMsg.SummaryText=\"This action could not be performed. Please try again.\";break;}if(replaceStrings!=null){var a=replaceStrings.split(\"|\");this.RRMsg.SummaryText=this.Utils.StringFormat(this.RRMsg.SummaryText,a);this.RRMsg.DetailsText=this.Utils.StringFormat(this.RRMsg.DetailsText,a);}},OnClickMoreAbouRR:function(){this.Parent.Common.LogStats('RemoteRecord','RRInit');this.RRInfoPopupWin(\"http://tv.msn.com/tv/RR/RRInfo.aspx\");},RRInfoPopupWin:function(url){var winProps=\"width=800, height=640, toolbar=yes, menubar=yes, scrollbars=yes, resizable=yes, location=yes, directories=yes, status=yes\";window.open(url,\"RRWin\",winProps);},SendWaitingMsg:function(){eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnWaitingMsg();}, 1);\");},SendErrorMsg:function(){eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnErrorMsg();}, 1);\");},OnSetHeadendLoad:function(){this.GetMsgText(\"headendOutSyncComplete\");eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".OnHeadendChange();}, 1);\");},OnSetHeadendTimeout:function(){this.GetMsgText(\"setHeadendTimeout\");this.SendErrorMsg();},OnSetHeadendError:function(){this.GetMsgText(\"setHeadendError\");this.SendErrorMsg();}},TestUtils:{ShowPerf:function(txt){window.status=txt;}},Tracer:{IsTraceOn:true,TraceLevel:0,Entering:1,Exiting:-1,Trace:function(text,levelDelta){if(!this.IsTraceOn)return;if(levelDelta==this.Exiting){this.TraceLevel--;}if(this.TraceLevel<0){this.TraceLevel=0;}for(var i=0;i<this.TraceLevel;i++){this.TraceWindow.document.write(\"----\");}if(typeof this.TraceWindow==\"undefined\"||this.TraceWindow==null){this.TraceWindow=window.open(\"\",\"TraceWindowName\",\"resizable=yes,scrollbars=yes\");this.TraceWindow.document.open();this.TraceWindow.document.write(\"<HTML><HEAD><TITLE>MAIN TRACE</TITLE></HEAD><BODY>BEGIN TRACING...<BR>\");this.TraceWindow.document.write(text+\"<br>\");}else{this.TraceWindow.document.write(\"[\"+this.TraceLevel+\"] \"+text+\"<br>\");this.TraceWindow.document.body.scrollTop=this.TraceWindow.document.body.scrollHeight;}if(levelDelta==this.Entering){this.TraceLevel++;}}},Utils:{AddElement:function(parentOb,tagName,className){var e=document.createElement(tagName);e.className=className;return parentOb.appendChild(e);},FillDigits:function(num,count,dir){var s=num.toString();while(s.length<count){if(dir==1)s=\"0\"+s;elses=s+\"0\";}return s;},ArraysAreEqual:function(a,b){if(a==null||b==null)return false;if(a.length!=b.length)return false;for(var i=0;i<a.length;i++){if(a[i]!=b[i])return false;}return true;},WindowOffsetTop:function(ob){var y=0;if(ob.offsetTop!=null){y+=ob.offsetTop;while(ob.offsetParent){y+=ob.offsetParent.offsetTop;ob=ob.offsetParent;}}return y;},StringFormat:function(str,arr){if(arr!=null){for(var i=0;i<arr.length;i++){var newS=arr[i];var oldS=\"{\"+i+\"}\";var a=str.indexOf(oldS);if(a!=-1){var b=a+oldS.length;str=str.substring(0,a)+newS+str.substring(b,str.length)}}}return str;}},ActionPanel:{InitOnce:function(parent){this.ObjectName=\"ActionPanel\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;this.Div=this.Common.AddElement(document.body,\"div\",\"\",\"enhPrv\",\"\",\"EnhancedPreview\");brandingDiv=this.Common.AddElement(this.Div,\"div\",\"\",\"enhPrvTitleArea\");brandingLog=this.Common.AddElement(brandingDiv,\"div\",\"\",\"enhPrvLogo wLiveIcon\",\"\",this.ObjectName+\"LogoImg\");eval(\"brandingLog.onclick = function() { \"+this.Parent.ObjectRef+\" .Common.LogStats('WindowsLiveLogo'); window.open('http://www.live.com',''); };\");brandingLog.onmouseover=function(){this.style.cursor='pointer';};this.TextArea=this.Common.AddElement(this.Div,\"div\",\"\",\"enhPrvPreviewArea\");var actionsMargin=this.Common.AddElement(this.Div,\"div\",\"\",\"enhPrvActionsAreaMargin\");this.Common.AddElement(actionsMargin,\"div\",\"\",\"enhPrvActionsAreaSpacer\");this.InnerDivBottom=this.Common.AddElement(actionsMargin,\"div\",\"\",\"enhPrvActionsArea\");this.Common.AddElement(actionsMargin,\"div\",\"\",\"enhPrvActionsAreaSpacer\");eval(\"onOver = function(){ \"+this.Parent.ObjectRef+\".OnOverEnhPrev() }\");eval(\"onExit = function(){ \"+this.Parent.ObjectRef+\".OnLeaveEnhPrev(this.CurrentTag) }\");this.Div.onmouseover=onOver;this.Div.onmouseout=onExit;if(parent.EnableDetails){this.DetailsLink=this.AddActionLink(this.InnerDivBottom,\"Details and Show Times\",this.ObjectName+\"DetailsLink\");eval(\"this.DetailsLink.button.onclick = function(){ \"+this.Parent.ObjectRef+\".ShowDetails();};\");}if(parent.EnableRemoteRecord){this.RecordLink=this.AddActionLink(this.InnerDivBottom,\"Record This Show\",this.ObjectName+\"RecordLink\");eval(\"this.RecordLink.button.onclick = function(){ \"+this.Parent.ObjectRef+\".LastPopover = 'EnhancedPreview'; \"+this.Parent.ObjectRef+\".DoRecord(); };\");}if(parent.EnableLiveSearch){this.SearchLink=this.AddActionLink(this.InnerDivBottom,\"More on Live Search\",this.ObjectName+\"SearchLink\");eval(\"this.SearchLink.button.onclick = function(){ \"+this.Parent.ObjectRef+\".DoSearch('live'); };\");}this.Custom.AddAdsArea();var footerMargin=this.AdAreaMargin=this.Common.AddElement(this.Div,\"div\",\"\",\"enhPrvFooterAreaMargin\");this.Footer=this.AdAreaMargin=this.Common.AddElement(footerMargin,\"div\",\"\",\"enhPrvFooterArea\");this.CreateFooter();this.Shadow=this.Common.AddElement(document.body,\"div\",\"\",\"shadowDiv\");var imgL=\"<img src='\"+parent.ImagePath+\"beakL.png' width='\"+this.Styles.ActionPanelArrowWidth+\"' height='\"+this.Styles.BeakHeight+\"px' />\";this.BeakL=this.Common.AddElement(document.body,\"div\",\"\",\"panelArrow\",imgL);this.BeakL.onmouseover=onOver;this.BeakL.onmouseout=onExit;var imgR=\"<img src='\"+parent.ImagePath+\"beakR.png' width='\"+this.Styles.ActionPanelArrowWidth+\"' height='\"+this.Styles.BeakHeight+\"px' />\";this.BeakR=this.Common.AddElement(document.body,\"div\",\"\",\"panelArrow\",imgR);this.BeakR.onmouseover=onOver;this.BeakR.onmouseout=onExit;this.Custom.InitAds();},InitOnHover:function(){},Hide:function(){this.BeakL.style.display=\"none\";this.BeakR.style.display=\"none\";this.Shadow.style.display=\"none\";this.Div.style.display=\"none\";},Unhide:function(){this.Div.style.display=\"block\";if(this.ArrowOnLeft){this.BeakL.style.display=\"block\";}else{this.BeakR.style.display=\"block\";}this.Shadow.style.display=\"block\";},Show:function(tag){this.CurrentTag=tag;this.Title=tag.DisplayableTitle;this.Custom.CreateAds();this.Common.ClearChildren(this.TextArea);this.Common.AddElement(this.TextArea,\"div\",\"\",\"enhPrvTitle\",this.Title);this.NextOnDiv=this.Common.AddElement(this.TextArea,\"div\");this.ShowMessage(\"Searching for show times...\",\"waiting\");if(this.DetailsLink!=null)this.DetailsLink.button.style.display=\"none\";if(this.RecordLink!=null)this.RecordLink.button.style.display=\"none\";if(this.SearchLink!=null)this.SearchLink.button.style.display=\"block\";this.SetTop(tag);if(this.Parent.OmitImage==false){this.SetLeft(tag.nextSibling);}else{this.SetLeft(tag);}this.Unhide();},SetTop:function(e,adjustTop){var elementOffsetTop=this.Common.GetVertOffset(e);var popupShiftY=this.Styles.ActionPanelArrowTop;var popupHeight=this.Div.clientHeight;var popupBott=elementOffsetTop+popupShiftY+popupHeight;var popupTop;var finalPopupTop;if(adjustTop&&adjustTop==true){var windowHeight;var visibleDocOffsetY;if(this.Parent.Browser.IsInStrictMode){windowHeight=document.documentElement.clientHeight;visibleDocOffsetY=document.documentElement.scrollTop+2;}else{windowHeight=document.body.clientHeight;visibleDocOffsetY=document.body.scrollTop+2;}var windowBottom=windowHeight+visibleDocOffsetY;if(popupBott>windowBottom){popupTop=windowBottom-popupHeight;}else{popupTop=elementOffsetTop+popupShiftY;}finalPopupTop=popupTop;if(popupTop<visibleDocOffsetY){finalPopupTop=visibleDocOffsetY;}else{}}else{finalPopupTop=elementOffsetTop+popupShiftY;}this.Div.style.top=finalPopupTop+\"px\";var arrT=elementOffsetTop-this.Styles.BeakHalfHeight+this.Styles.BeakMarginY;this.BeakL.style.top=arrT+\"px\";this.BeakR.style.top=arrT+\"px\";this.DrawShadow('top');},SetLeft:function(e){var elementOffsetLeft=this.Common.GetHorizOffset(e);var elementWidth=e.offsetWidth;var elementRight=elementOffsetLeft+elementWidth;var popupWidth=this.Styles.ActionPanelWidth;if(this.Parent.Browser.IsInStrictMode||this.Parent.Browser.IsMozilla){popupWidth=popupWidth+2;}var arrowWidth=this.Styles.ActionPanelArrowWidth;var gapWidth=this.Styles.BeakMarginX;var oDims=this.Browser.GetWinOrFrameInnerDimensions();var windowWidth=oDims.x;var oOffsets=this.Browser.GetScrollingOffset();var visibleDocOffsetX=oOffsets.x;var windowRight=windowWidth+visibleDocOffsetX;var popupLeft;this.ArrowOnLeft=true;var testRightPopupLeftEdge=elementRight+gapWidth+arrowWidth;var testRightPopupRightEdge=testRightPopupLeftEdge+popupWidth;var testLeftPopupLeftEdge=elementOffsetLeft-gapWidth-popupWidth-arrowWidth;if(testRightPopupRightEdge>windowRight){if(testLeftPopupLeftEdge<0){popupLeft=testRightPopupLeftEdge;}else{this.ArrowOnLeft=false;if(this.Parent.OmitImage==false){elementOffsetLeft=this.Common.GetHorizOffset(e.previousSibling);testLeftPopupLeftEdge=elementOffsetLeft-gapWidth-popupWidth-arrowWidth;}popupLeft=testLeftPopupLeftEdge;}}else{popupLeft=testRightPopupLeftEdge;}var arrowLPos,arrowRPos;if(this.ArrowOnLeft){arrowLPos=popupLeft-arrowWidth+1;this.BeakL.style.left=arrowLPos+\"px\";}else{arrowRPos=popupLeft+popupWidth-1;this.BeakR.style.left=arrowRPos+\"px\";}this.Div.style.left=popupLeft+\"px\";this.DrawShadow('left',this.ArrowOnLeft);},Update:function(nextOn,headend){var h=\"\";if(nextOn!=null){this.ExactSearchUtils.AddNextOnInfo(this.NextOnDiv,nextOn.program,nextOn.airing,headend);}else{this.Common.ClearChildren(this.NextOnDiv);infoDiv=this.Common.AddElement(this.NextOnDiv,\"div\",\"\",\"enhPrvPreviewInfoMsg\");tbl=this.Common.AddElement(infoDiv,\"table\");tbd=this.Common.AddElement(tbl,\"tbody\");tr=this.Common.AddElement(tbd,\"tr\");td=this.Common.AddElement(tr,\"td\",\"\",\"enhPrvPreviewInfoMsgIconCell\");this.Common.AddElement(td,\"div\",\"\",\"enhPrvPreviewInfoMsgIcon infoSmallUrl topMrg4 rightMrg4\");if(this.Parent.Headend.isDefault==false){msg=\"There are no upcoming airings of this show in the listings for \"+this.Parent.Headend.name+\", \"+this.Parent.Headend.zip+\".\";td=this.Common.AddElement(tr,\"td\",\"\",\"enhPrvPreviewInfoMsgText italic\");div=this.Common.AddElement(td,\"div\");div.innerHTML=msg;div=this.Common.AddElement(td,\"div\");providerLnk=this.Common.AddElement(div,\"a\",\"\",\"enhPrvPreviewInfoMsgPrvLnk\",\"Change TV Provider\",this.ObjectName+\"ChangeProvLink\");}else{msg=\"To see if this show is in your local listings, enter your \";td=this.Common.AddElement(tr,\"td\",\"\",\"enhPrvPreviewInfoMsgText italic\",msg);providerLnk=this.Common.AddElement(td,\"a\",\"\",\"enhPrvPreviewInfoMsgPrvLnk\",\"TV provider\",this.ObjectName+\"ChangeProvLink\");}providerLnk.onmouseover=function(){this.style.textDecoration='underline';};providerLnk.onmouseout=function(){this.style.textDecoration='none';};providerLnk.href=\"javascript:\"+this.Parent.ObjectRef+\".ChooseHeadend.Show()\";}if(nextOn!=null){if(this.DetailsLink!=null)this.DetailsLink.button.style.display=\"block\";if(this.RecordLink!=null)this.RecordLink.button.style.display=\"block\";this.Common.LogStats(\"EnhancedPreview\",\"NextOn\");}else{if(this.DetailsLink!=null)this.DetailsLink.button.style.display=\"none\";if(this.RecordLink!=null)this.RecordLink.button.style.display=\"none\";this.Common.LogStats(\"EnhancedPreview\",\"NoUpcomingAirings\");}},ShowError:function(msg){if(msg==null){msg=\"An error occurred while trying to retrieve that information. Try again.\";}this.ShowMessage(msg,\"error\");if(this.DetailsLink!=null)this.DetailsLink.button.style.display=\"none\";if(this.RecordLink!=null)this.RecordLink.button.style.display=\"none\";this.Common.LogStats(\"EnhancedPreview\",\"Error\");},ShowMessage:function(msg,msgType){if(msg==null){return;}this.Common.ClearChildren(this.NextOnDiv);tbl=this.Common.AddElement(this.NextOnDiv,\"table\");tbd=this.Common.AddElement(tbl,\"tbody\");tr=this.Common.AddElement(tbd,\"tr\");td=this.Common.AddElement(tr,\"td\",\"\",\"enhPrvPreviewInfoMsgIconCell\");switch(msgType){case\"error\":this.Common.AddElement(td,\"div\",\"\",\"msgDivImg errorSmallUrl rightMrg4\");break;case\"warning\":this.Common.AddElement(td,\"div\",\"\",\"msgDivImg warningSmallUrl\");break;case\"waiting\":this.Common.AddElement(td,\"div\",\"\",\"msgDivImg msgDivWaitingUrl\");break;case\"info\":this.Common.AddElement(td,\"div\",\"\",\"msgDivImg infoSmallUrl\");break;}td=this.Common.AddElement(tr,\"td\",\"\",\"enhPrvPreviewInfoMsgText italic\",msg);},AddActionLink:function(div,label,id){var button=this.Common.AddElement(div,\"div\",\"\",\"enhPrvAction\",label,id);button.onmouseover=function(){this.style.textDecoration='underline';};button.onmouseout=function(){this.style.textDecoration='none';};return{button:button};},CreateFooter:function(){this.Common.ClearChildren(this.Footer);tbl=this.Common.AddElement(this.Footer,\"table\",\"\",\"enhPrvFooterTbl\");tbd=this.Common.AddElement(tbl,\"tbody\",\"\",\"enhPrvFooterTbl\");tr=this.Common.AddElement(tbd,\"tr\");infoUrl=this.Common.AddElement(tr,\"td\",\"\",\"\",\"What's this?\",this.ObjectName+\"WhatsThisLink\");infoUrl.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};infoUrl.onmouseout=function(){this.style.textDecoration='none';};eval(\"infoUrl.onclick = function(){ \"+this.Parent.ObjectRef+\".Common.LogStats('WhatsThis'); window.open('http://www.msntv.com/tagstemp', 'SearchWin');};\");feedbackUrl=this.Common.AddElement(tr,\"td\",\"\",\"enhPrvFooterFeedback\",\"Feedback\",this.ObjectName+\"FeedbackLink\");feedbackUrl.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};feedbackUrl.onmouseout=function(){this.style.textDecoration='none';};feedbackUrl.onclick=this.Common.ShowFeedback;},DrawShadow:function(pos,arrowOnLeft){this.Shadow.style.width=this.Div.offsetWidth+\"px\";this.Shadow.style.height=this.Div.offsetHeight;+\"px\";offset=3;if(arrowOnLeft!=null&&arrowOnLeft==false){offset=-3;}eval(\"this.Shadow.style.\"+pos+\" = (parseInt(this.Div.style.\"+pos+\") + \"+offset+\") + \\\"px\\\"\");}},ChooseHeadend:{InitOnce:function(parent,includeLinksOnConfirmation){this.ObjectName=\"ChooseHeadend\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;this.GetHeadendsUrl=parent.DiscoveryWSPath+\"/\"+parent.GetHeadendsHandler;this.SetHeadendUrl=parent.DiscoveryWSPath+\"/\"+parent.SetHeadendHandler;this.DoAfterChooseProvider=null;this.IncludeLinksOnConfirmation=(includeLinksOnConfirmation!=null)?includeLinksOnConfirmation:true;this.SavedZIP=\"\";this.HeadendsToChooseFrom=null;this.HeadendId=null;this.HeadendTimezone=null;this.HeadendName=null;this.HeadendNumChan=null;this.HeadendType=null;this.HeadendZip=null;this.Common.CreatePopup(this,this.ObjectRef,\"Choose your TV service provider\",430,350,'',\"ChooseHeadend\");},InitOnHover:function(){this.HeadendZip=null;this.HeadendType=null;},Show:function(doAfterChooseProvider){this.DoAfterChooseProvider=(doAfterChooseProvider!=null)?doAfterChooseProvider:null;this.Parent.Common.LogStats('ChooseProvider','ChoosePrvUserInfo');this.ShowView('chooseZipAndType');},Hide:function(){if(this.Timer){window.clearTimeout(this.Timer);}this.Div.style.display=\"none\";},Unhide:function(){this.Common.PositionPopup(this);this.Div.style.display=\"block\";},ShowView:function(view,flag){this.Common.HideAll();this.Unhide();this.Common.ClearChildren(this.DetailArea);this.DetailArea.innerHTML=\"\";this.Common.ClearChildren(this.FooterArea);var oForm,oDiv,oHr,oBr,oInput,oSpan,oZIP;var attrStr=\"\";switch(view){case\"chooseZipAndType\":oMainDiv=this.Common.AddElement(this.DetailArea,\"div\",\"\",\"choosePrvContent\");var msg=\"To see channel information and show times\";msg+=\", you must enter your location and the type of TV service provider you use. (This information is stored as a \\\"cookie\\\" in your Web browser to provide information that is accurate for your location and provider.)\";this.Common.AddElement(oMainDiv,\"div\",\"\",\"choosePrvCnt1\",msg);this.Common.AddElement(oMainDiv,\"div\",\"\",\"tvTagChoosePrvCntDivider1\");oZIPDiv=this.Common.AddElement(oMainDiv,\"div\",\"\",\"choosePrvCnt2\");this.Common.AddElement(oZIPDiv,\"div\",\"\",\"choosePrvZip\",\"1. Enter your ZIP/postal code:\");oInputDiv=this.Common.AddElement(oZIPDiv,\"div\",\"\",\"choosePrvZipInput\");attrStr=\"id=\"+this.ObjectName+\"ZipInput;\"+\"type=text; size=20\";this.ZIPinput=this.Common.AddElement(oInputDiv,\"input\",attrStr);this.ZIPinput.maxLength=9;eval(\"this.ZIPinput.onkeypress = function(){ \"+this.ObjectRef+\".ZipFormOnKeyPress(); };\");this.PrvCntWrnIcon=this.Common.AddElement(oZIPDiv,\"div\",\"\",\"choosePrvZipWrnIcon warningSmallUrl\");this.Common.AddElement(oZIPDiv,\"div\",\"\",\"choosePrvZipEg\",\"ex. 90012 (US), M4G-4J3 (Can.)\");this.Common.AddElement(oMainDiv,\"div\",\"\",\"tvTagChoosePrvCntDivider2\");oOuterDiv=this.Common.AddElement(oMainDiv,\"div\",\"\",\"choosePrvCnt3\");this.Common.AddElement(oOuterDiv,\"div\",\"\",\"choosePrvSrvType\",\"2. Choose your TV service type:\");oTable=this.Common.AddElement(oOuterDiv,\"table\",\"\",\"choosePrvSrvTypeInput\");oTbody=this.Common.AddElement(oTable,\"tbody\");var commonName=this.ObjectName+\"ProvTypeName\";oTr=this.Common.AddElement(oTbody,\"tr\");oTd=this.Common.AddElement(oTr,\"td\");attrStr=\"id=\"+this.ObjectName+\"ProvAnt;\"+\"name=\"+commonName+\";\"+\"type=radio\";this.RadioAnt=this.Common.AddElement(oTd,\"input\",attrStr);oTd=this.Common.AddElement(oTr,\"td\",\"\",\"\",\"Antenna\");oTr=this.Common.AddElement(oTbody,\"tr\");oTd=this.Common.AddElement(oTr,\"td\");attrStr=\"id=\"+this.ObjectName+\"ProvCable;\"+\"name=\"+commonName+\";\"+\"defaultChecked=true;\"+\"type=radio\";this.RadioCbl=this.Common.AddElement(oTd,\"input\",attrStr);oTd=this.Common.AddElement(oTr,\"td\",\"\",\"\",\"Cable\");oTr=this.Common.AddElement(oTbody,\"tr\");oTd=this.Common.AddElement(oTr,\"td\");attrStr=\"id=\"+this.ObjectName+\"ProvSat;\"+\"name=\"+commonName+\";\"+\"type=radio\";this.RadioSat=this.Common.AddElement(oTd,\"input\",attrStr);oTd=this.Common.AddElement(oTr,\"td\",\"\",\"\",\"Satellite\");if(this.HeadendType){this.RadioCbl.checked=false;switch(this.HeadendType){case'antenna':this.RadioAnt.checked=true;break;case'cable':this.RadioCbl.checked=true;break;case'satellite':this.RadioSat.checked=true;break;}}this.PrvCntWrn=this.Common.AddElement(this.DetailArea,\"div\",\"\",\"choosePrvCntWrn\");this.Common.AddElement(this.PrvCntWrn,\"div\",\"\",\"choosePrvCntWrnIcon warningUrl\");this.Common.AddElement(this.PrvCntWrn,\"div\",\"\",\"choosePrvCntWrnText text12\",\"You entered your ZIP/postal code incorrectly. Try again.\");this.Common.CreateButton(\"OK\",this.ObjectName+\"OKBtn\",74,\"right\",100,this.FooterArea,false,true,this.ObjectRef+\".SubmitZIPform();\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Cancel();\");var initZIP=\"\";if(this.HeadendZip){this.ZIPinput.value=this.HeadendZip;initZIP=this.HeadendZip;}eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".ZIPinput.focus();\"+this.ObjectRef+\".ZIPinput.value='\"+initZIP+\"';}, 1000);\");break;case\"waitForHeadends\":this.Common.DisplayMessage(this.DetailArea,\"waiting\",\"Looking up \"+this.HeadendType+\" providers in your area. Please wait...\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Cancel();\");break;case\"setHeadendTimeoutOrError\":this.Common.DisplayMessage(this.DetailArea,\"warning\",\"<b>Unable to save your TV service provider selection.<br/>Would you like to send this request again?\");this.Common.CreateButton(\"OK\",this.ObjectName+\"OKBtn\",74,\"right\",100,this.FooterArea,false,true,this.ObjectRef+\".CommitHeadend();\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Cancel();\");this.Parent.Common.LogStats('ChooseProvider','ChoosePrvErrSave');break;case\"getHeadendTimeoutOrError\":this.Common.DisplayMessage(this.DetailArea,\"warning\",\"<b>Unable to retrieve the list of available TV service providers. Would you like to send this request again?\");this.Common.CreateButton(\"OK\",this.ObjectName+\"OKBtn\",74,\"right\",100,this.FooterArea,false,true,this.ObjectRef+\".GetHeadends(\"+this.ObjectRef+\".HeadendZip,\"+this.ObjectRef+\".HeadendType);\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Cancel();\");this.Parent.Common.LogStats('ChooseProvider','ChoosePrvErrRetrieve');break;case\"noProviders\":this.Common.DisplayMessage(this.DetailArea,\"warning\",\"There are no \"+this.HeadendType+\" providers in your area.<br/>Click \\\"Back\\\" to select another type of service provider.\");this.Common.CreateButton(\"Back\",this.ObjectName+\"BackBtn\",74,\"left\",8,this.FooterArea,false,true,this.ObjectRef+\".ShowView('chooseZipAndType');\");this.Common.CreateButton(\"Close\",this.ObjectName+\"CloseBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Hide();\");this.Parent.Common.LogStats('ChooseProvider','ChoosePrvNoPrvs');break;case\"chooseHeadend\":var oMainDiv=this.Common.AddElement(this.DetailArea,\"div\",\"\",\"choosePrvContent\");this.Common.AddElement(oMainDiv,\"div\",\"\",\"choosePrvListHdr\",\"Choose the \"+this.HeadendType+\" provider you use:\");var oProvListDiv=this.Common.AddElement(oMainDiv,\"div\",\"\",\"choosePrvListDiv\");var attrStr=\"name=provListForm;\"+\"onSubmit=return \"+this.ObjectRef+\".SubmitProvListform()\";this.ProvListForm=this.Common.AddElement(oProvListDiv,\"form\",attrStr);oTable=this.Common.AddElement(this.ProvListForm,\"table\",\"\",\"choosePrvListTbl\");oTbody=this.Common.AddElement(oTable,\"tbody\");this.ProvListRadioBtnComName=this.ObjectName+\"ProvListName\";for(var i=0;i<this.HeadendsToChooseFrom.length;i++){oTr=this.Common.AddElement(oTbody,\"tr\");oTd=this.Common.AddElement(oTr,\"td\");attrStr=\"id=\"+this.ObjectName+\"ProvListID\"+i+\";\"+\"name=\"+this.ProvListRadioBtnComName+\";\";if(i==0)attrStr+=\"defaultChecked=true;\";attrStr+=\"type=radio\";this.RadioAnt=this.Common.AddElement(oTd,\"input\",attrStr);displayStr=this.HeadendsToChooseFrom[i].Name+\" (\"+this.HeadendsToChooseFrom[i].numChannels+\" channels)\";oTd=this.Common.AddElement(oTr,\"td\",\"\",\"\",displayStr);}this.Common.CreateButton(\"Back\",this.ObjectName+\"BackBtn\",74,\"left\",8,this.FooterArea,false,true,this.ObjectRef+\".ShowView('chooseZipAndType');\");this.Common.CreateButton(\"OK\",this.ObjectName+\"OKBtn\",74,\"right\",100,this.FooterArea,false,false,this.ObjectRef+\".ProcessHeaderRadioBtn();\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Cancel();\");this.Parent.Common.LogStats('ChooseProvider','ChoosePrvListOfPrvs');break;case\"confirmHeadend\":msg=\"<b>Is this the correct information?</b><br/>\";msg+=this.HeadendType.substring(0,1).toUpperCase()+this.HeadendType.substring(1);msg+=\", \"+this.HeadendsToChooseFrom[this.HeadendsToChooseFromIdx].Name+\" in zip/postal code \"+this.HeadendZip;oDetMsg=this.Common.DisplayMessage(this.DetailArea,\"info\",msg);oDetMsg.innerHTML=\"Click <b>Back</b> to select a different service provider.\";this.Common.CreateButton(\"Back\",this.ObjectName+\"BackBtn\",74,\"left\",8,this.FooterArea,false,true,this.ObjectRef+\".ShowView('chooseZipAndType');\");this.Common.CreateButton(\"OK\",this.ObjectName+\"OKBtn\",74,\"right\",100,this.FooterArea,false,false,this.ObjectRef+\".CommitHeadend();\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Cancel();\");this.Parent.Common.LogStats('ChooseProvider','ChoosePrvConfirm');break;case\"savingHeadend\":this.Common.DisplayMessage(this.DetailArea,\"waiting\",\"Setting up your TV service provider. Please wait...\");break;case\"chooseHeadendSuccess\":var prvString=new String();prvString=this.HeadendsToChooseFrom[this.HeadendsToChooseFromIdx].Name;if(prvString==\"\"){prvString=this.HeadendType;prvString=prvString.charAt(0).toUpperCase()+prvString.substr(1);}oBottomMsg=this.Common.DisplayMessage(this.DetailArea,\"info\",\"<b>Confirmed:</b> Your TV service provider is now set to \"+prvString+\" \"+this.HeadendZip+\".\");if(this.IncludeLinksOnConfirmation){this.Common.AddElement(oBottomMsg,\"div\",\"\",\"tvTextStd\",\"Because you changed your TV service provider, the show you selected might not appear in your channel lineup. Click one of the links below:\");oLink=this.Common.AddElement(oBottomMsg,\"div\",\"\",\"panelBtnTextSmall topMrg8\",\"Look for all airings\",this.ObjectName+\"AllAirLink\");eval(\"oLink.onclick = function(){ \"+this.Parent.ObjectRef+\".Common.LogStats('ProgramDetails','AllAirings'); \"+this.Parent.ObjectRef+\".DoExactSearchThenAllAirings();};\");oLink.onmouseover=function(){this.style.textDecoration='underline';};oLink.onmouseout=function(){this.style.textDecoration='none';};oLink=this.Common.AddElement(oBottomMsg,\"div\",\"\",\"panelBtnTextSmall\",\"Look for next on\",this.ObjectName+\"NextOnLink\");eval(\"oLink.onclick = function(){ \"+this.Parent.ObjectRef+\".Common.LogStats('ProgramDetails','Summary'); \"+this.Parent.ObjectRef+\".DoExactSearchThenProgDet();};\");oLink.onmouseover=function(){this.style.textDecoration='underline';};oLink.onmouseout=function(){this.style.textDecoration='none';};}if(this.DoAfterChooseProvider==null){this.Common.CreateButton(\"Close\",this.ObjectName+\"CloseBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Hide();\");}else{this.Common.CreateButton(\"Close\",this.ObjectName+\"NextBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".HideAndCallBack();\");}this.Parent.Common.LogStats('ChooseProvider','ChoosePrvSuccess');this.HeadendZip=null;this.HeadendType=null;break;}},Hide:function(){var ui=Microsoft.Msn.MediaTags.TvTagUI;if(ui.ChooseHeadend.Timer){window.clearTimeout(ui.ChooseHeadend.Timer);}ui.ChooseHeadend.Div.style.display=\"none\";},HideAndCallBack:function(){var panel=Microsoft.Msn.MediaTags.TvTagUI.ChooseHeadend;panel.Hide();panel.DoAfterChooseProvider();},SubmitZIPform:function(){oZIP=this.ZIPinput;if((oZIP.value.length<5||oZIP.value.length>7)||(oZIP.value.match(/[^a-zA-Z0-9-]/)!=null)){this.PrvCntWrnIcon.style.visibility=\"visible\";this.PrvCntWrn.style.visibility=\"visible\";oZIP.focus();this.Parent.Common.LogStats('ChooseProvider','ChoosePrvUserInfoErr');return false;}else{this.GetHeadends(oZIP.value);this.PrvCntWrnIcon.style.visibility=\"hidden\";this.PrvCntWrn.style.visibility=\"hidden\";return true;}},GetHeadends:function(zipCode,prvType){var zip=zipCode;var dashPos=zip.indexOf(\"-\");var tempZip=\"\";if(dashPos!=-1){tempZip=zip.substring(0,dashPos);if(dashPos<zip.length){tempZip+=zip.substring(dashPos+1);}zip=tempZip;}var type;if(!prvType){if(this.RadioAnt.checked){type=\"antenna\";}else{if(this.RadioCbl.checked){type=\"cable\";}else{type=\"satellite\";}}}else{type=prvType;}this.HeadendZip=zip;this.HeadendType=type;this.ShowView('waitForHeadends');eval(\"window.setTimeout(function() { \"+this.ObjectRef+\".CallGetHeadendWebSvc(); }, 1);\");},CallGetHeadendWebSvc:function(){url=this.GetHeadendsUrl+\"?zipCode=\"+this.HeadendZip+\"&providerType=\"+this.HeadendType;eval(\"onLoad = function(result) {\"+this.ObjectRef+\".GetHeadendOnLoad(result); };\");eval(\"onTimeout = function() {\"+this.ObjectRef+\".ShowView('getHeadendTimeoutOrError'); };\");eval(\"onError = function() {\"+this.ObjectRef+\".ShowView('getHeadendTimeoutOrError'); };\");this.DataFetcher.LoadURL(url,false,true,10000,onLoad,onTimeout,onError);},GetHeadendOnLoad:function(d){var headends=d.headends;if(headends==null||headends.length==0){this.ShowView(\"noProviders\");return;}this.HeadendsToChooseFrom=headends;if(headends.length==1){this.ProcessChosenHeadend(0);}else{this.ShowView('chooseHeadend');}},ZipFormOnKeyPress:function(){e=event;if(e){var key=window.event?e.keyCode:e.which;var keychar=String.fromCharCode(key);xCode=keychar.charCodeAt(0);if(xCode==13){this.SubmitZIPform();}}},ProcessHeaderRadioBtn:function(){eval(\"var oRadioBtns = this.ProvListForm.\"+this.ProvListRadioBtnComName);var checkedIdx=-1;for(var i=oRadioBtns.length-1;i>-1;i--){if(oRadioBtns[i].checked){checkedIdx=i;i=-1;}}if(checkedIdx==-1)checkedIdx=0;this.ProcessChosenHeadend(checkedIdx);},ProcessChosenHeadend:function(checkedIdx){var h=this.HeadendsToChooseFrom[checkedIdx];this.HeadendName=h.Name;this.HeadendId=h.Id;this.HeadendNumChan=h.numChannels;this.HeadendsToChooseFromIdx=checkedIdx;this.ShowView('confirmHeadend');},CommitHeadend:function(){this.ShowView('savingHeadend');url=this.SetHeadendUrl+\"?zipCode=\"+this.HeadendZip+\"&headend=\"+this.HeadendId;eval(\"onLoad = function(result) {\"+this.ObjectRef+\".OnSetHeadendReturn(result); };\");eval(\"onTimeout = function() {\"+this.ObjectRef+\".OnSetHeadendTimeoutOrError(); };\");eval(\"onError = function() {\"+this.ObjectRef+\".OnSetHeadendTimeoutOrError(); };\");this.DataFetcher.LoadURL(url,false,true,10000,onLoad,onTimeout,onError);},OnSetHeadendReturn:function(d){this.DataFetcher.ClearCache();this.Parent.Headend=null;if(this.Parent.OnChangeHeadend!=null)this.Parent.OnChangeHeadend(true);this.ShowView('chooseHeadendSuccess');},OnSetHeadendTimeoutOrError:function(){if(this.Parent.OnChangeHeadend!=null)this.Parent.OnChangeHeadend(false);this.ShowView('setHeadendTimeoutOrError');},Cancel:function(){this.HeadendZip=null;this.HeadendType=null;this.Hide();}},Common:{InitOnce:function(parent){this.ObjectName=\"Common\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;},InitOnHover:function(){},AddElement:function(parentOb,tagName,elementAttributeList,styleClassNames,html,id){var inputType=null;var inputChecked=false;var inputName=null;var elemAttrPairsParsedNamesArray=new Array();var elemAttrPairsParsedValuesArray=new Array();if(this.NotEmpty(elementAttributeList)){var elemAttrPairsUnparsedArray=elementAttributeList.split(\";\");for(var i=0;i<elemAttrPairsUnparsedArray.length;i++){nvStr=elemAttrPairsUnparsedArray[i];if(this.NotEmpty(nvStr)){idx=nvStr.indexOf(\"=\");if(idx!=-1){var attrName=nvStr.substring(0,idx);var attrValue=nvStr.substr(idx+1);attrName=this.Trim(attrName);attrValue=this.Trim(attrValue);if(!this.Browser.IsIE){elemAttrPairsParsedNamesArray[elemAttrPairsParsedNamesArray.length]=attrName;elemAttrPairsParsedValuesArray[elemAttrPairsParsedValuesArray.length]=attrValue;}else{switch(attrName){case\"name\":inputName=attrValue;break;case\"type\":inputType=attrValue;break;case\"defaultChecked\":inputChecked=true;break;default:elemAttrPairsParsedNamesArray[elemAttrPairsParsedNamesArray.length]=attrName;elemAttrPairsParsedValuesArray[elemAttrPairsParsedValuesArray.length]=attrValue;break;}}}}}}var rawElement,oElement;tagName=tagName.toLowerCase();if(tagName==\"input\"){if(this.Browser.IsIE){if(inputType==null){return null;}var inputHTML=\"<input type='\"+inputType+\"'\";if(inputName!=null){inputHTML+=\" name='\"+inputName+\"'\";}if(inputChecked){inputHTML+=\" checked\";}inputHTML+=\" />\";rawElement=document.createElement(inputHTML);oElement=parentOb.appendChild(rawElement);}else{rawElement=document.createElement(tagName);oElement=parentOb.appendChild(rawElement);}}else{rawElement=document.createElement(tagName);oElement=parentOb.appendChild(rawElement);}if(this.NotEmpty(elementAttributeList)){for(var i=0;i<elemAttrPairsParsedNamesArray.length;i++){eval(\"oElement.\"+elemAttrPairsParsedNamesArray[i]+\"='\"+elemAttrPairsParsedValuesArray[i]+\"';\");}}if(this.NotEmpty(styleClassNames))this.Styles.Apply(oElement,styleClassNames);if(this.NotEmpty(html))oElement.innerHTML=html;if(this.NotEmpty(id)){oElement.id=id;}return oElement;},CreatePopup:function(ob,popupName,headerTxt,width,height,isCloseXShown,id){ob.Div=this.AddElement(document.body,\"div\",\"\",\"popupBackground\",\"\",id);var borderWidth=width+2;var borderHeight=height+2;ob.Div.style.width=borderWidth+\"px\";ob.Div.style.height=borderHeight+\"px\";ob.Dimensions={w:width,h:height};innerDiv=this.AddElement(ob.Div,\"div\",\"\",\"popupInner\");innerDiv.style.width=width+\"px\";innerDiv.style.height=height+\"px\";if(isCloseXShown!=null&&isCloseXShown==true){var closeX=this.AddElement(innerDiv,\"div\",\"\",\"closeX closeXIcon\");eval(\"closeX.onclick = function(){\"+this.ObjectRef+\".Details.Hide();}\");}oDiv=this.AddElement(innerDiv,\"div\",\"\",\"popupHdrMargins\");ob.HeaderText=this.AddElement(oDiv,\"div\",\"\",\"popupHdrTxt\");ob.HeaderText.innerHTML=headerTxt;ob.DetailArea=this.AddElement(innerDiv,\"div\",\"\",\"popupDetail\");ob.FooterArea=this.AddElement(innerDiv,\"div\",\"\",\"popupFooter\");},CreatePopupEx:function(ob,popupName,headerTxt,width,height,isCloseXShown,id){ob.Div=this.AddElement(document.body,\"div\",\"\",\"popupBackground\",'',id);var borderWidth=width+2;var borderHeight=height+2;ob.Div.style.width=borderWidth+\"px\";ob.Div.style.height=borderHeight+\"px\";ob.Dimensions={w:width,h:height};innerDiv=this.AddElement(ob.Div,\"div\",\"\",\"popupInner\");innerDiv.style.width=width+\"px\";;innerDiv.style.height=height+\"px\";if(isCloseXShown==null||isCloseXShown==true){var closeX=this.AddElement(innerDiv,\"div\",\"\",\"closeX closeXIcon\");eval(\"closeX.onclick = function(){\"+this.ObjectRef+\".Details.Hide();}\");}oDiv=this.AddElement(innerDiv,\"div\",\"\",\"popupHdrMargins\");ob.Header=this.AddElement(oDiv,\"div\",\"\",\"popupHdrTxt\",headerTxt);ob.DetailArea=this.AddElement(innerDiv,\"div\",\"\",\"popupDetailEx\");ob.LiveSrch=this.AddElement(innerDiv,\"div\",\"\",\"popupLiveSrch\");ob.Ads=this.AddElement(innerDiv,\"div\",\"\",\"popupAds\");ob.Footer=this.AddElement(innerDiv,\"div\",\"\",\"popupFooterEx\");},GetVertOffset:function(ob){var y=0;if(typeof ob!='undefined'&&ob!=null&&ob.offsetTop!=null){y+=ob.offsetTop;while(ob.offsetParent){y+=ob.offsetParent.offsetTop;ob=ob.offsetParent;}}return y;},ClearChildren:function(ob){if(ob==null||ob=='undefined'){return;}if(ob.childNodes.length>0){var child;for(var i=ob.childNodes.length;i>0;i--){child=ob.childNodes[i-1];ob.removeChild(child);}}},GetHorizOffset:function(ob){var x=0;if(ob.offsetLeft!=null){x+=ob.offsetLeft;while(ob.offsetParent){x+=ob.offsetParent.offsetLeft;ob=ob.offsetParent;}}return x;},NotEmpty:function(s){return(s!=null&&s!=\"\");},PositionPopup:function(popup){this.CenterToWindow(popup.Div,popup.Dimensions.w,popup.Dimensions.h);},CenterToWindow:function(obj,w,h){var oOffsets=this.Browser.GetScrollingOffset();var left=oOffsets.x;var top=oOffsets.y;var x=left-(w/2);var y=top-(h/2);obj.style.marginLeft=x+\"px\";obj.style.marginTop=y+\"px\";},FillDigits:function(num,count){var s=num.toString();while(s.length<count){s=\"0\"+s;}return s;},DayName:new Array(\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"),MonthName:new Array(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sept\",\"Oct\",\"Nov\",\"Dec\"),GetDateString:function(LocalTime){var headendTimezone=(this.Parent.ExactSearchOb.headend.timezone==\"\")?this.ChooseHeadend.HeadendTimezone:this.Parent.ExactSearchOb.headend.timezone;var oLocalTime=new Date(LocalTime+(headendTimezone-this.Parent.TZ)*60*1000);var s=\"\";var now=new Date();var oneDayMLS=24*60*60*1000;var midnightToday=new Date(now.getFullYear(),now.getMonth(),now.getDate(),23,59,59);var midnightYesterday=new Date(midnightToday.valueOf()-oneDayMLS);if(oLocalTime<midnightYesterday){s+=this.MonthName[oLocalTime.getMonth()]+\" \"+oLocalTime.getDate();}else if(oLocalTime<midnightToday){s+=\"Today\";}else{var offset=oLocalTime-midnightToday;offset/=24*60*60*1000;offset=Math.floor(offset)+1;var endOfWeek=new Date(midnightToday.getTime()+(6-now.getDay())*oneDayMLS);if(oLocalTime<endOfWeek){s+=this.DayName[oLocalTime.getDay()];}else{s+=this.MonthName[oLocalTime.getMonth()]+\" \"+oLocalTime.getDate();}}return s;},GetTimeString:function(UtcTime){var headendTimezone=(this.Parent.ExactSearchOb.headend.timezone==\"\")?this.ChooseHeadend.HeadendTimezone:this.Parent.ExactSearchOb.headend.timezone;var oLocalTime=new Date(UtcTime+(headendTimezone-this.Parent.TZ)*60*1000);var hour=oLocalTime.getHours();var meridian=\"AM\";var minute;if(hour==0){hour=12;}else if(hour==12){meridian=\"PM\";}else if(hour>12){hour-=12;meridian=\"PM\";}var minute=oLocalTime.getMinutes();if(minute<10)minute=\"0\"+minute;return hour+\":\"+minute+\" \"+meridian;},LocalDateToUTCStr:function(LocalDate){var oLocalDate=new Date(LocalDate);var yyyy=oLocalDate.getUTCFullYear();var mm=this.FillDigits(oLocalDate.getUTCMonth()+1,2);var dd=this.FillDigits(oLocalDate.getUTCDate(),2);var hh=this.FillDigits(oLocalDate.getUTCHours(),2);var mn=this.FillDigits(oLocalDate.getUTCMinutes(),2);var ss=this.FillDigits(oLocalDate.getUTCSeconds(),2);var date=yyyy+\"-\"+mm+\"-\"+dd+\"T\"+hh+\":\"+mn+\":\"+ss;return date;},UTCStrToUTCDate:function(UTCDateStr){var oUTCDate;try{var yyyy=UTCDateStr.substr(0,4);var mo=(UTCDateStr.substr(5,2))-1;var dd=UTCDateStr.substr(8,2);var hh=UTCDateStr.substr(11,2);var mm=UTCDateStr.substr(14,2);var ss=UTCDateStr.substr(17,2);var oUTCDate=new Date(Date.UTC(yyyy,mo,dd,hh,mm,ss,0))}catch(e){trace(\"Common.UTCStrToUTCDate: error=\"+e.message+\", bad UTC date string=\"+UTCDateStr);oUTCDate=new Date(0,0,0,0,0,0,0);}return oUTCDate;},UTCStrToLocalDate:function(UTCDateStr){var oUTCDate=this.UTCStrToUTCDate(UTCDateStr);var oLocalDate=new Date(oUTCDate.getFullYear(),oUTCDate.getMonth(),oUTCDate.getDate(),oUTCDate.getHours(),oUTCDate.getMinutes(),oUTCDate.getSeconds());return oLocalDate;},CreateButton:function(labelText,id,widthPx,leftOrRight,PosPx,footerArea,isDisabled,shouldClearFooterChildren,onClickFuncStr){if(shouldClearFooterChildren!=null&&shouldClearFooterChildren==true){this.Common.ClearChildren(footerArea);}attrStr=\"id=\"+id;if(isDisabled==null||!isDisabled){var btn=this.AddElement(footerArea,\"DIV\",attrStr,\"popupFooterBtn btnRest\",labelText);eval(\"btn.onmouseover = function(){\"+this.ObjectRef+\".OnOverBtn(btn); };\");eval(\"btn.onmouseout = function(){\"+this.ObjectRef+\".OnLeaveBtn(btn); };\");eval(\"btn.onmousedown = function(){\"+this.ObjectRef+\".OnPressBtn(btn); };\");eval(\"btn.onclick = function(){\"+onClickFuncStr+\"};\");}else{var btn=this.AddElement(footerArea,\"DIV\",attrStr,\"popupFooterBtn btnDisabled\",labelText);}btn.minWidth=widthPx;if(leftOrRight==\"right\"){btn.style.right=PosPx+\"px\";}else{btn.style.left=PosPx+\"px\";}footerArea.style.display=\"block\";},OnOverBtn:function(ob){ob.style.backgroundImage=\"url(\"+this.Parent.ImagePath+\"btn_hot_normal.gif)\";},OnLeaveBtn:function(ob){ob.style.backgroundImage=\"url(\"+this.Parent.ImagePath+\"btn_default_normal.gif)\";},OnPressBtn:function(ob){ob.style.backgroundImage=\"url(\"+this.Parent.ImagePath+\"btn_pressed_normal.gif)\";eval(\"window.setTimeout(function() { try {\"+\"ob.style.backgroundImage = \\\"url(\"+this.Parent.ImagePath+\"btn_default_normal.gif)\\\";\"+\"} catch(e) {}; }, 100);\");},CreateTblRow:function(parentOb,html,cellStyleName){var oTR,oTD;oTR=this.Common.AddElement(parentOb,\"TR\");oTD=this.Common.AddElement(oTR,\"TD\",\"\",cellStyleName,html);return this.TD;},DisplayPopupMsg:function(oPopup,msgType,msgCode,shouldShowFooter,shouldShowCloseButton,msgTop,msgBottom){var oImg,oSpan,oDiv,oHr;this.ClearChildren(oPopup.DetailArea);this.ClearChildren(oPopup.FooterArea);var oBottomMsg;if(typeof msgBottom==\"undefined\")msgBottom=\"\";switch(msgType){case\"error\":case\"warning\":oImg=this.AddElement(oPopup.DetailArea,\"img\");oImg.src=this.Parent.ImagePath+\"exclamation_point.gif\";oImg.align=\"left\";oSpan=this.AddElement(oPopup.DetailArea,\"span\",\"\",\"tvTextWarning\",msgTop);oDiv=this.AddElement(oPopup.DetailArea,\"div\",\"\",\"msgRuleDIV\");oHr=this.AddElement(oDiv,\"hr\",\"size=1;\",\"msgRuleHR\");oBottomMsg=this.AddElement(oPopup.DetailArea,\"div\",\"\",\"msgBottomDIV\");oSpan=this.AddElement(oBottomMsg,\"span\",\"\",\"tvTextStd\",msgBottom);break;case\"waiting\":oImg=this.AddElement(oPopup.DetailArea,\"img\");oImg.src=this.Parent.ImagePath+\"waiting_animation.gif\";oImg.align=\"left\";oSpan=this.AddElement(oPopup.DetailArea,\"span\",\"\",\"tvTextStd\",msgTop);oDiv=this.AddElement(oPopup.DetailArea,\"div\",\"\",\"msgRuleDIV\");oHr=this.AddElement(oDiv,\"hr\",\"\",\"msgRuleHR\");oHr.size=1;oBottomMsg=this.AddElement(oPopup.DetailArea,\"div\",\"\",\"msgBottomDIV\");oSpan=this.AddElement(oDiv,\"span\",\"\",\"tvTextStd\",msgBottom);break;case\"info\":this.AddElement(oPopup.DetailArea,\"div\",\"\",\"tvTextStd\",msgTop);oBottomMsg=this.AddElement(oPopup.DetailArea,\"div\",\"\",\"msgBottomDIV\");oSpan=this.AddElement(oBottomMsg,\"span\",\"\",\"tvTextStd\",msgBottom);break;}this.PositionPopup(oPopup);this.HideAll();oPopup.Unhide();return oBottomMsg;},DisplayMessage:function(oDiv,msgType,msgText,showDivider){this.Common.ClearChildren(oDiv);msgSummDiv=this.AddElement(oDiv,\"div\",\"\",\"msgDiv\");if(msgType==\"none\"){this.AddElement(msgSummDiv,\"div\",\"\",\"bottomMrg16 text11\",msgText);}else{tblDiv=this.AddElement(msgSummDiv,\"div\",\"\",\"bottomMrg16\");tbl=this.AddElement(tblDiv,\"table\",\"\",\"tblCollapse\");tbd=this.AddElement(tbl,\"tbody\");tr=this.AddElement(tbd,\"tr\",\"\",\"msgDivFont trNoMargin\");td=this.AddElement(tr,\"td\");var oImg,oSpan,oDiv,oHr;switch(msgType){case\"error\":this.AddElement(td,\"div\",\"\",\"msgDivImg errorUrl\");break;case\"warning\":this.AddElement(td,\"div\",\"\",\"msgDivImg warningUrl\");break;case\"waiting\":this.AddElement(td,\"div\",\"\",\"msgDivImg msgDivWaitingUrl\");break;case\"info\":this.AddElement(td,\"div\",\"\",\"msgDivImg infoUrl\");break;}td=this.AddElement(tr,\"td\");textDiv=this.AddElement(td,\"div\",\"\",\"msgDivTextDiv\");textDiv.innerHTML=msgText;}if(showDivider==true){divider=this.AddElement(msgSummDiv,\"div\",\"\",\"msgDivDivider\");this.AddElement(divider,\"div\",\"\",\"divider\");}msgDetDiv=this.Common.AddElement(oDiv,\"div\",\"\",\"msgDetails text11\");return msgDetDiv;},DisplayPopupInfo:function(oPopup,oContents,shouldShowCloseButton){this.ClearChildren(oPopup.DetailArea);this.ClearChildren(oPopup.FooterArea);this.PositionPopup(oPopup);oPopup.DetailArea.appendChild(oContents);oPopup.FooterArea.style.display=\"block\";if(shouldShowCloseButton){this.CreateButton(\"Close\",oPopup.ObjectName+\"Close\",74,\"right\",8,oPopup.FooterArea,oPopup.ObjectRef+\".Hide();\");}this.PositionPopup(oPopup);this.HideAll();oPopup.Unhide();},Trim:function(s){while(s.charAt(0)==\" \"){s=s.substring(1,s.length);}while(s.charAt(s.length-1)==\" \"){s=s.substring(0,s.length-1);}return s;},HideAll:function(popupName){this.ActionPanel.Hide();this.ChooseHeadend.Hide();this.Details.Hide();this.Record.Hide();this.SignIn.Hide();this.Remind.Hide();},PopupWin:function(url){var winProps=\"width=800, height=640, toolbar=yes, menubar=yes, scrollbars=yes, resizable=yes, location=yes, directories=yes, status=yes\";window.open(url,\"RRWin\",winProps);},InitStats:function(){if(typeof tvs_s!='undefined'&&tvs_s!=null){this.StatsEnabled=true;tvs_s.prop1=\"TVTags\";tvs_s.prop2=\"en-us\";tvs_s.prop6=document.URL;this.StatsResetLogProps();}else{this.StatsEnabled=false;}return;},LogStats:function(action,subAction,searchTerms){if(this.StatsEnabled==false){return;}if(action==null||action=='undefined'){this.StatsResetLogProps();return;}tvs_s.pageName=action;if(this.Parent.NowShow){tvs_s.prop3=this.Parent.NowShow.program.Title;}else if(this.Parent.NowLink){tvs_s.prop3=this.Parent.NowLink.DisplayableTitle;}else{tvs_s.prop3=\"Not Available\";}if(subAction!=''){tvs_s.prop4=subAction;}if(searchTerms!=''){tvs_s.prop5=searchTerms;}var elm=document.getElementById(\"tvServicesLogging\");if(elm){elm.innerHTML=tvs_s.t();}else{logDiv=document.createElement(\"div\");logDiv.id=\"tvServicesLogging\";logDiv.innerHTML=tvs_s.t();}this.StatsResetLogProps();},StatsResetLogProps:function(){if(this.statsenabled==false){return;}tvs_s.pagename=\"\";tvs_s.prop3=\"\";tvs_s.prop4=\"\";tvs_s.prop5=\"\";},ShowFeedback:function(){Microsoft.Msn.MediaTags.TvTagUI.Common.LogStats('Feedback');O_LC('tvtags.live.com');return false;}},Details:{InitOnce:function(parent){this.ObjectName=\"Details\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;this.Common.CreatePopupEx(this,this.ObjectRef,\"Program details\",432,444,true,\"ProgramDetails\");this.Sidebar=this.Common.AddElement(this.DetailArea,\"div\",\"\",\"progDetSideBar\");this.Mainarea=this.Common.AddElement(this.DetailArea,\"div\",\"\",\"progDetMainArea\");this.Sidebar.Summary=this.Common.AddElement(this.Sidebar,\"div\",\"\",\"progDetSummary\");this.Common.AddElement(this.Sidebar.Summary,\"div\",\"\",\"progDetSummaryText\",\"Summary\",this.ObjectName+\"SummaryBtn\");this.Sidebar.Credits=this.Common.AddElement(this.Sidebar,\"div\",\"\",\"progDetCredits\");this.Common.AddElement(this.Sidebar.Credits,\"div\",\"\",\"progDetCreditsText\",\"Credits\",this.ObjectName+\"CreditsBtn\");this.Sidebar.AllAirings=this.Common.AddElement(this.Sidebar,\"div\",\"\",\"progDetAllAirings\");this.Common.AddElement(this.Sidebar.AllAirings,\"div\",\"\",\"progDetAllAiringsText\",\"All airings\",this.ObjectName+\"AllAirBtn\");eval(\"this.Sidebar.Summary.onmouseover = function(){ \"+this.ObjectRef+\".MouseOver('Summary'); };\");eval(\"this.Sidebar.Credits.onmouseover = function(){ \"+this.ObjectRef+\".MouseOver('Credits'); };\");eval(\"this.Sidebar.AllAirings.onmouseover = function(){ \"+this.ObjectRef+\".MouseOver('AllAirings'); };\");eval(\"this.Sidebar.Summary.onmouseout = function(){ \"+this.ObjectRef+\".MouseOut('Summary'); };\");eval(\"this.Sidebar.Credits.onmouseout = function(){ \"+this.ObjectRef+\".MouseOut('Credits'); };\");eval(\"this.Sidebar.AllAirings.onmouseout = function(){ \"+this.ObjectRef+\".MouseOut('AllAirings'); };\");eval(\"this.Sidebar.Summary.onclick = function(){ \"+this.ObjectRef+\".Common.LogStats('ProgramDetails','Summary');\"+this.ObjectRef+\".Show('Summary'); };\");eval(\"this.Sidebar.Credits.onclick = function(){ \"+this.ObjectRef+\".Common.LogStats('ProgramDetails','Credits'); \"+this.ObjectRef+\".Show('Credits'); };\");eval(\"this.Sidebar.AllAirings.onclick = function(){ \"+this.ObjectRef+\".Common.LogStats('ProgramDetails','AllAirings'); \"+this.ObjectRef+\".Show('AllAirings'); };\");this.AddLiveSrch();this.AddAdArea();this.AddFooter();},InitOnHover:function(){},Hide:function(){this.AdImg.src=this.Parent.ImagePath+\"s.gif\";this.Div.style.display=\"none\";},Unhide:function(){this.Common.PositionPopup(this);this.Div.style.display=\"block\";},Show:function(selection){this.Common.HideAll();this.Unhide();this.Common.PositionPopup(this);this.Parent.NowShow=this.ExactSearchUtils.GetShow(this.Parent.ExactSearchOb,this.Parent.ScheduleIdx,this.Parent.AiringIdx);eval(\"this.Sidebar.\"+selection+\".style.cursor = 'default'\");this.Common.ClearChildren(this.Mainarea);this.SearchTxtBoxReset();this.NowAdInd=(this.NowAdInd==\"1\")?\"2\":\"1\";this.AdImg.src=this.Parent.ImagePath+\"temp/msn_remoterecord_234x60_v\"+this.NowAdInd+\".gif\";this.AdImg.onclick=function(){window.open(\"http://tv.msn.com/tv/RR/RRInfo.aspx\")};switch(selection){case'Summary':this.ShowSummary();break;case'Credits':this.ShowCredits();break;case'AllAirings':this.ShowAllAirings();break;}},ShowSummary:function(){this.Selection=\"Summary\";this.SetSidebarSelection();exactSearchOb=this.Parent.ExactSearchOb;var oTable,oTBody,oTR,oTD,oA;if(this.Parent.ScheduleIdx==-1||this.Parent.AiringIdx==-1){this.NoAiringsMsg();return;}var prog=this.Parent.NowShow.program;var airing=this.Parent.NowShow.airing;var showTime=this.Common.GetDateString(airing.StartTime)+\" \"+this.Common.GetTimeString(airing.StartTime)+\" \"+this.Parent.Headend.timezoneAbbreviation;var channel=this.ExactSearchUtils.GetChannelText(this.Parent.NowShow.airing,this.Parent.NowShow.headend);this.Summary=this.Common.AddElement(this.Mainarea,\"div\",\"\",\"progDetMainInnerDiv\");this.AddMainareaToolbar(this.Summary);this.Common.AddElement(this.Summary,\"div\",\"\",\"progDetMainToolbarDivider\");this.Common.AddElement(this.Summary,\"div\",\"\",\"progDetMainShowName\",prog.Title);var episodeTitle=prog.EpisodeTitle;if(typeof prog.EpisodeTitle=='undefined'||prog.EpisodeTitle==\"\"){episodeTitle=\"Episode title not available\";}else{episodeTitle=\"Episode: \\\"\"+prog.EpisodeTitle+\"\\\"\";}this.Common.AddElement(this.Summary,\"div\",\"\",\"progDetMainEpisode\",episodeTitle);if(typeof prog.Description!='undefined'&&prog.Description!=\"\"){var desc=new String(prog.Description);desc=desc.replace(/``/g,\"\\\"\");this.Common.AddElement(this.Summary,\"div\",\"\",\"progDetMainDescription\",desc);}if(prog.Repeat){this.Common.AddElement(this.Summary,\"div\",\"\",\"progDetMainRepeat\",\"Repeat\");}var channelDiv=this.Common.AddElement(this.Summary,\"div\",\"\",\"progDetMainChannel\",\"Channel:\");this.Common.AddElement(channelDiv,\"div\",\"\",\"progDetMainChannelInfo\",channel);var timeDiv=this.Common.AddElement(this.Summary,\"div\",\"\",\"progDetMainTime\",\"Time:\");this.Common.AddElement(timeDiv,\"div\",\"\",\"progDetMainTimeInfo\",showTime);var durationDiv=this.Common.AddElement(this.Summary,\"div\",\"\",\"progDetMainDuration\",\"Duration:\");var duration=Math.floor(airing.Duration)+\" min.\";this.Common.AddElement(durationDiv,\"div\",\"\",\"progDetMainDurationInfo\",duration);var mainFooter=this.Common.AddElement(this.Summary,\"div\",\"\",\"progDetMainFooter\");this.Common.AddElement(mainFooter,\"div\",\"\",\"progDetMainFooterInfoIcon infoSmallUrl topMrg4\");var provStr;var provLinkStr;if(this.Parent.Headend.isDefault){provStr=\"Check your local listings\";provLinkStr=\"Enter your TV provider\"}else{provStr=\"Your provider is \"+this.Parent.Headend.name+\" \"+this.Parent.Headend.zip;provLinkStr=\"Change provider\"}this.Common.AddElement(mainFooter,\"div\",\"\",\"progDetMainFooterProvider\",provStr);var providerLink=this.Common.AddElement(mainFooter,\"a\",\"\",\"progDetMainFooterChangeProvider\",provLinkStr,this.ObjectName+\"ChangeProvLink\");this.Parent.LastPopover='ProgramDetails';providerLink.href=\"javascript:\"+this.Parent.ObjectRef+\".ChooseHeadend.Show()\";providerLink.onmouseover=function(){this.style.textDecoration='underline';};providerLink.onmouseout=function(){this.style.textDecoration='none';};},NoAiringsMsg:function(){this.Common.DisplayMessage(this.Mainarea,\"info\",\"There are no upcoming airings.\");},ShowCredits:function(){this.Selection=\"Credits\";this.SetSidebarSelection();var oTable,oTBody,oTR,oTD,oA;if(this.Parent.ScheduleIdx==-1||this.Parent.AiringIdx==-1){this.NoAiringsMsg();return;}var prog=this.Parent.NowShow.program;var credits=this.Common.AddElement(this.Mainarea,\"div\",\"\",\"progDetMainInnerDiv\");this.AddMainareaToolbar(credits);this.Common.AddElement(credits,\"div\",\"\",\"progDetMainToolbarDivider\");creditsInnerDiv=this.Common.AddElement(credits,\"div\",\"\",\"progDetMainCreditsDiv\");if((typeof prog.LeadActors=='undefined'||prog.LeadActors=='')&&(typeof prog.Actors=='undefined'||prog.Actors=='')&&(typeof prog.OtherCredits=='undefined'||prog.OtherCredits=='')&&(typeof prog.Directors=='undefined'||prog.Directors=='')){this.Common.AddElement(creditsInnerDiv,\"div\",\"\",\"progDetMainCredits\",\"No credits available\");}else{this.Common.AddElement(creditsInnerDiv,\"div\",\"\",\"progDetMainCredits\",\"Credits\");if(typeof prog.LeadActors!='undefined'&&prog.LeadActors!=\"\"){this.Common.AddElement(creditsInnerDiv,\"div\",\"\",\"progDetCreditsCaption\",\"Lead Actors:\");this.Common.AddElement(creditsInnerDiv,\"div\",\"\",\"progDetCreditsDetails\",prog.LeadActors);}if(typeof prog.Actors!='undefined'&&prog.Actors!=\"\"){this.Common.AddElement(creditsInnerDiv,\"div\",\"\",\"progDetCreditsCaption\",\"Actors:\");this.Common.AddElement(creditsInnerDiv,\"div\",\"\",\"progDetCreditsDetails\",prog.Actors);}if(typeof prog.Directors!='undefined'&&prog.Directors!=\"\"){this.Common.AddElement(creditsInnerDiv,\"div\",\"\",\"progDetCreditsCaption\",\"Director:\");this.Common.AddElement(creditsInnerDiv,\"div\",\"\",\"progDetCreditsDetails\",prog.Directors);}if(typeof prog.OtherCredits!='undefined'&&prog.OtherCredits!=\"\"){this.Common.AddElement(creditsInnerDiv,\"div\",\"\",\"progDetCreditsCaption\",\"Other Credits:\");this.Common.AddElement(creditsInnerDiv,\"div\",\"\",\"progDetCreditsDetails\",prog.OtherCredits);}}},ShowAllAirings:function(){this.Selection=\"AllAirings\";this.SetSidebarSelection();this.Parent.DisplayRetrievingAllAiringsMsg();eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".ShowAllAirInit();}, 1);\");},ShowAllAirInit:function(){this.Selection=\"AllAirings\";this.SetSidebarSelection();if(this.Parent.Headend.isDefault){this.ChooseHeadend.Show();return;}this.AiringsPerPage=10;this.Common.ClearChildren(this.Mainarea);if(this.ExactSearchUtils.AiringsSorted==null){this.ExactSearchUtils.SortAiringsByDay();}this.AllAiringsCurrPage=1;if(this.ExactSearchUtils.AiringsSorted==null||this.ExactSearchUtils.AiringsSorted.length==0){this.NoAiringsMsg();return;}this.AiringsLength=this.ExactSearchUtils.AiringsSorted.length;this.TotalPages=Math.ceil(this.AiringsLength/this.AiringsPerPage);this.AllAirOutline();},AllAirOutline:function(){this.Common.ClearChildren(this.Mainarea);var allAirings=this.Common.AddElement(this.Mainarea,\"div\",\"\",\"allAirContentArea\");this.Common.AddElement(allAirings,\"div\",\"\",\"allAirHdr\",\"All airings\");this.Common.AddElement(allAirings,\"div\",\"\",\"allAirDivider\");this.AllAirShowings=this.Common.AddElement(allAirings,\"div\",\"\",\"allAirShowings\");var allAiringsTblDiv=this.Common.AddElement(allAirings,\"div\",\"\",\"allAirTblDiv\");var allAiringsTbl=this.Common.AddElement(allAiringsTblDiv,\"table\",\"\",\"allAirTbl\");this.AllAirTbd=this.Common.AddElement(allAiringsTbl,\"tbody\");var footerTbl=this.Common.AddElement(allAirings,\"table\",\"height=10px width=80px\",\"allAirRepeat\");var footerTBody=this.Common.AddElement(footerTbl,\"tbody\");var footerTR=this.Common.AddElement(footerTBody,\"tr\");td=this.Common.AddElement(footerTR,\"td\",\"width=14px\");this.Common.AddElement(td,\"div\",\"\",\"12x12 repeatIcon\");this.Common.AddElement(footerTR,\"td\",\"valign=middle\",\"\",\"= repeat\");var prevNextDiv=this.Common.AddElement(allAirings,\"div\",\"\",\"allAirPrevNextDiv\");var pagingTbl=this.Common.AddElement(prevNextDiv,\"table\",\" height=14px width=100%\",\"allAirPaging\");var pagingTBody=this.Common.AddElement(pagingTbl,\"tbody\");var pagingTR=this.Common.AddElement(pagingTBody,\"tr\");td=this.Common.AddElement(pagingTR,\"td\",\"width=12px align=left\");this.AllAirPrevLnkDiv=this.Common.AddElement(td,\"div\",\"\",\"allAirPrevHover allAirPrevIcon\");this.AllAirPrevIcon=this.AllAirPrevLnkDiv;this.AllAirPrevCaption=this.Common.AddElement(pagingTR,\"td\",\"width=24px valign=top\",\"\",\"Prev\",\"DetailsPrevLink\");td=this.Common.AddElement(pagingTR,\"td\",\"width=12px valign=top align=left\");this.PagingPrev=this.Common.AddElement(td,\"div\",\"\",\"\",\"&hellip;\");td=this.Common.AddElement(pagingTR,\"td\",\"width=48px\");this.AllAirPagesDiv=this.Common.AddElement(td,\"div\",\"\",\"allAirPagesLinks\");td=this.Common.AddElement(pagingTR,\"td\");td=this.Common.AddElement(pagingTR,\"td\",\"width=12px valign=top align=left\");this.PagingNext=this.Common.AddElement(td,\"div\",\"\",\"\",\"&hellip;\");this.AllAirNextCaption=this.Common.AddElement(pagingTR,\"td\",\"width=24px valign=top\",\"\",\"Next\",\"DetailsNextLink\");td=this.Common.AddElement(pagingTR,\"td\",\"width=11px\");this.AllAirNextIcon=this.Common.AddElement(td,\"div\",\"\",\"allAirNextIcon allAirNextHover\");this.AllAiringsTable();this.UpdateNavLinks();},AllAiringsTable:function(){this.Common.ClearChildren(this.AllAirTbd);trw=this.Common.AddElement(this.AllAirTbd,\"TR\");tcl=this.Common.AddElement(trw,\"TD\",\"\",\"allAirDayTimeCell  allAirTblHdr\",\"Day/Time\");tcl=this.Common.AddElement(trw,\"TD\",\"\",\"allAirChanCell allAirTblHdr\",\"Ch.\");tcl=this.Common.AddElement(trw,\"TD\",\"\",\"allAirEpisodeCell allAirTblHdr\",\"Episode\");var programEntry,airingEntry,channelID,airingsSortedEntry;var startingIdx=(this.AllAiringsCurrPage-1)*this.AiringsPerPage;var endingIdx=startingIdx+this.AiringsPerPage-1;if((startingIdx+1)>this.AiringsLength){startingIdx=this.AiringsLength-1;}if((endingIdx+1)>this.AiringsLength){endingIdx=this.AiringsLength-1;}this.AllAirShowings.innerHTML=\"showing \"+eval(\"startingIdx + 1\")+\"-\"+eval(\"endingIdx + 1\")+\" of \"+this.AiringsLength;for(var i=startingIdx;i<=endingIdx;i++){airingsSortedEntry=this.ExactSearchUtils.AiringsSorted[i];scheduleIdx=airingsSortedEntry.schedIdx;programEntry=this.Parent.ExactSearchOb.shows[scheduleIdx];programID=programEntry.ProgramId;airingsIdx=airingsSortedEntry.airingsIdx;airingEntry=programEntry.Schedule[airingsIdx];channelID=airingEntry.ChanID;trw=this.Common.AddElement(this.AllAirTbd,\"TR\");tcl=this.Common.AddElement(trw,\"TD\",\"\",\"allAirDayTimeCell\");var dateTime=airingsSortedEntry.displayDate+\" \"+airingsSortedEntry.displayTime;this.Common.AddElement(tcl,\"div\",\"\",\"allAirDayTimeDiv\",dateTime);tcl=this.Common.AddElement(trw,\"TD\",\"\",\"allAirChanCell\");this.Common.AddElement(tcl,\"div\",\"\",\"allAirChanDiv\",airingEntry.Channel+\" \"+airingEntry.CallLetters);tcl=this.Common.AddElement(trw,\"TD\",\"\",\"allAirEpisodeCell\");var episodeDiv;if(programEntry.Repeat){var div=this.Common.AddElement(tcl,\"div\",\"\",\"allAirRepeatDiv\");var table=this.Common.AddElement(div,\"table\",\"\",\"allAirTbl\");var tbody=this.Common.AddElement(table,\"tbody\");var trow=this.Common.AddElement(tbody,\"tr\");var td=this.Common.AddElement(trow,\"td\",\"\",\"allAirEpisodeCellSmall\");episodeDiv=this.Common.AddElement(td,\"div\",\"\",\"allAirEpisodeDivSmall\");td=this.Common.AddElement(trow,\"TD\",\"\");this.Common.AddElement(td,\"div\",\"\",\"img12x12 repeatIcon\");}else{episodeDiv=this.Common.AddElement(tcl,\"div\",\"\",\"allAirEpisodeDiv\");}var episodeTitle=programEntry.EpisodeTitle;if(typeof episodeTitle=='undefined'||episodeTitle==\"\"){episodeTitle=programEntry.Title;}var episodeLnk=this.Common.AddElement(episodeDiv,\"a\",\"\",\"allAirEpisodeLink\",episodeTitle,(this.ObjectName+\"EpisodeLink\"+i));episodeLnk.onmouseover=function(){this.style.textDecoration='underline';};episodeLnk.onmouseout=function(){this.style.textDecoration='none';};episodeLnk.href=\"javascript:\"+this.Parent.ObjectRef+\".Common.LogStats('ProgramDetails','Summary');\"+this.Parent.ObjectRef+\".ScheduleIdx=\"+scheduleIdx+\";\"+this.Parent.ObjectRef+\".AiringIdx=\"+airingsIdx+\";\"+this.ObjectRef+\".Show('Summary')\";}},UpdateNavLinks:function(){if(this.AllAiringsCurrPage>1){eval(\"this.AllAirPrevIcon.onclick = function(){ \"+this.ObjectRef+\".OnClickPrev(); };\");eval(\"this.AllAirPrevCaption.onclick = function(){ \"+this.ObjectRef+\".OnClickPrev(); };\");this.AllAirPrevCaption.style.color=\"#0088E4\";this.AllAirPrevCaption.style.cursor=\"pointer\";this.AllAirPrevIcon.style.cursor=\"pointer\";this.Common.ClearChildren(this.AllAirPrevIcon);this.Common.AddElement(this.AllAirPrevIcon,\"div\",\"\",\"allAirPrevHover allAirPrevIcon\",\"&nbsp;\");}else{eval(\"this.AllAirPrevIcon.onclick = function(){ };\");eval(\"this.AllAirPrevCaption.onclick = function(){ };\");this.AllAirPrevCaption.style.color=\"#999999\";this.AllAirPrevIcon.style.cursor=\"default\";this.AllAirPrevCaption.style.cursor=\"default\";this.Common.ClearChildren(this.AllAirPrevIcon);this.Common.AddElement(this.AllAirPrevIcon,\"div\",\"\",\"allAirPrevRest allAirPrevIcon\",\"&nbsp;\");}var startingIdx=(this.AllAiringsCurrPage-1)*this.AiringsPerPage;var endingIdx=startingIdx+this.AiringsPerPage-1;if(endingIdx<this.ExactSearchUtils.AiringsSorted.length-1){eval(\"this.AllAirNextIcon.onclick = function() {\"+this.ObjectRef+\".OnClickNext();};\");eval(\"this.AllAirNextCaption.onclick = function() {\"+this.ObjectRef+\".OnClickNext();};\");this.AllAirNextCaption.style.color=\"#0088E4\";this.AllAirNextCaption.style.cursor=\"pointer\";this.AllAirNextIcon.style.cursor=\"pointer\";this.Common.ClearChildren(this.AllAirNextIcon);this.Common.AddElement(this.AllAirNextIcon,\"div\",\"\",\"allAirNextHover allAirNextIcon\");}else{eval(\"this.AllAirNextIcon.onclick = function() {};\");eval(\"this.AllAirNextCaption.onclick = function() {};\");this.AllAirNextCaption.style.color=\"#999999\";this.AllAirNextIcon.style.cursor=\"default\";this.AllAirNextCaption.style.cursor=\"default\";this.Common.ClearChildren(this.AllAirNextIcon);this.Common.AddElement(this.AllAirNextIcon,\"div\",\"\",\"allAirNextRest allAirNextIcon\",\"&nbsp;\");}this.Common.ClearChildren(this.AllAirPagesDiv);var numPageLnk=3;var maxPage=(Math.ceil(this.AllAiringsCurrPage/numPageLnk))*numPageLnk;var i=0;for(i=maxPage-numPageLnk+1;i<=maxPage&&i<=this.TotalPages;i++){var allAirPagesLnk=this.Common.AddElement(this.AllAirPagesDiv,\"a\",\"\",\"allAirNavLink\",i+\"&nbsp;\",(this.ObjectName+\"PageLink\"+i));if(i==this.AllAiringsCurrPage){allAirPagesLnk.innerHTML=\"<b>\"+i+\"</b>&nbsp;\";allAirPagesLnk.style.color=\"#555555\";allAirPagesLnk.cursor=\"default\";}else{allAirPagesLnk.href=\"javascript:\"+this.ObjectRef+\".OnClickPageNum(\"+i+\")\";;allAirPagesLnk.style.cursor=\"pointer\";allAirPagesLnk.style.textDecoration=\"none\";}}if(maxPage==numPageLnk){this.PagingPrev.style.display=\"none\";}else{this.PagingPrev.style.display=\"block\";}if(maxPage>=this.TotalPages){this.PagingNext.style.display=\"none\";}else{this.PagingNext.style.display=\"block\";}},OnClickPrev:function(){this.OnClickPageNum(this.AllAiringsCurrPage-1);},OnClickNext:function(){this.OnClickPageNum(this.AllAiringsCurrPage+1);},OnClickPageNum:function(page){this.AllAiringsCurrPage=page;this.Parent.DisplayRetrievingAllAiringsMsg();eval(\"this.Timer = window.setTimeout(function() {\"+this.ObjectRef+\".AllAirOutline();}, 1);\");},AddMainareaToolbar:function(parent){var parentDiv=this.Common.AddElement(parent,\"div\",\"\",\"progDetMainToolbar\");if(this.Parent.EnableRemoteRecord){var recordIcon=this.Common.AddElement(parentDiv,\"div\",\"\",\"progDetMainIcon progDetMainIconRecord\");var recordLink=this.Common.AddElement(parentDiv,\"a\",\"\",\"progDetMainLink\",\"\",this.ObjectName+\"RecShowLink\");recordLink.onmouseover=function(){this.style.textDecoration='underline';};recordLink.onmouseout=function(){this.style.textDecoration='none';};recordLink.innerHTML=\"Record show\";this.Parent.LastPopover=\"ProgramDetails\";eval(\"recordLink.onclick = function(){ \"+this.Parent.ObjectRef+\".LastPopover = 'ProgramDetails';\"+this.ObjectRef+\".DoRecord(); };\");eval(\"recordIcon.onclick = function(){ \"+this.Parent.ObjectRef+\".LastPopover = 'ProgramDetails';\"+this.ObjectRef+\".DoRecord(); };\");}if(this.Parent.EnableMSNSearch){var moreOnLiveIcon=this.Common.AddElement(parentDiv,\"div\",\"\",\"progDetMainIcon progDetMainIconMSN\");var moreOnLiveText=this.Common.AddElement(parentDiv,\"a\",\"\",\"progDetMainLink\",\"\",this.ObjectName+\"MoreLink\");moreOnLiveText.innerHTML=\"More TV from MSN\";moreOnLiveText.onmouseover=function(){this.style.textDecoration='underline';};moreOnLiveText.onmouseout=function(){this.style.textDecoration='none';};eval(\"moreOnLiveText.onclick = function(){ \"+this.Parent.ObjectRef+\".DoSearch('msn'); };\");eval(\"moreOnLiveIcon.onclick = function(){ \"+this.Parent.ObjectRef+\".DoSearch('msn'); };\");}},SetSidebarSelection:function(){var selections=new Array();selections[0]=\"Summary\";selections[1]=\"Credits\";selections[2]=\"AllAirings\";for(var i=0;i<selections.length;i++){var s=selections[i];if(s!=this.Selection){eval(\"this.Sidebar.\"+s+\".style.background = '#ffffff';\");}else{eval(\"this.Sidebar.\"+s+\".style.background = '#e4edf4';\");}}},DoRecord:function(){this.Parent.DoRecord(null);},MouseOver:function(selection){if(selection!=this.Selection){eval(\"this.Sidebar.\"+selection+\".style.cursor = 'pointer';\");}eval(\"this.Sidebar.\"+selection+\".style.background = '#e4edf4';\");},MouseOut:function(selection){if(selection!=this.Selection){eval(\"this.Sidebar.\"+selection+\".style.background = '#ffffff';\");}},SearchTxtBoxOnKeyPress:function(){e=event;if(e){var key=window.event?e.keyCode:e.which;var keychar=String.fromCharCode(key);xCode=keychar.charCodeAt(0);if(xCode==13){this.SearchBtnOnClick();}}},AddLiveSrch:function(){var srchTbl=this.Common.AddElement(this.LiveSrch,\"table\",\"\",\"progDetLiveSrchTbl\");srchTbl.align=\"center\";var tbd=this.Common.AddElement(srchTbl,\"tbody\");var tr=this.Common.AddElement(tbd,\"tr\",\"\",\"progDetLiveSrchTbl\");var td=this.Common.AddElement(tr,\"td\",\"\",\"progDetLiveSrchCell\");td.valign=\"top\";var attrStr=\"type=text; size=35; maxlength=30\";this.LiveSrchTxtBox=this.Common.AddElement(td,\"input\",attrStr,\"progDetLiveSrchTxtBox\",\"\",this.ObjectName+\"SearchInput\");this.LiveSrchTxtBox.value=\" Search the web...\";td=this.Common.AddElement(tr,\"td\",\"\",\"progDetLiveSrchCell\");this.LiveSrchBtn=this.Common.AddElement(td,\"div\",\"\",\"progDetLiveSrchImg\",\"\",this.ObjectName+\"SearchIcon\");eval(\"this.LiveSrchBtn.onclick = function(){ \"+this.ObjectRef+\".SearchBtnOnClick(); };\");eval(\"this.LiveSrchBtn.onmouseover = function(){ \"+this.ObjectRef+\".SearchBtnOnMouseOver(); };\");eval(\"this.LiveSrchBtn.onmouseout = function(){ \"+this.ObjectRef+\".SearchBtnOnMouseOut(); };\");eval(\"this.LiveSrchTxtBox.onclick = function(){ \"+this.ObjectRef+\".SearchTxtBoxOnClick(); };\");eval(\"this.LiveSrchTxtBox.onkeypress = function(){ \"+this.ObjectRef+\".SearchTxtBoxOnKeyPress(); };\");this.LiveSrchClicked=false;},SearchBtnOnClick:function(){var searchTerm=\"\";searchTerm=this.LiveSrchTxtBox.value;if(searchTerm==\" Search the web...\"&&this.LiveSrchClicked==false){searchTerm=\"\";}this.LiveSrchClicked==false;if(searchTerm!=\"\"){this.Parent.Common.LogStats('LiveSearch');var url=\"http://www.live.com/#q=\"+encodeURIComponent(searchTerm);window.open(url,\"\");}},SearchBtnOnMouseOver:function(){this.LiveSrchBtn.style.cursor=\"pointer\";},SearchBtnOnMouseOut:function(){this.LiveSrchBtn.style.cursor=\"default\";},SearchTxtBoxOnClick:function(){if(this.LiveSrchTxtBox.value==\" Search the web...\"&&this.LiveSrchClicked==false){this.LiveSrchTxtBox.value=\"\";this.LiveSrchTxtBox.style.color=\"#333333\";this.LiveSrchClicked=true;}},SearchTxtBoxReset:function(){this.LiveSrchTxtBox.value=\" Search the web...\";this.LiveSrchTxtBox.style.color=\"#999999\";this.LiveSrchClicked=false;},AddAdArea:function(){var tbl=this.Common.AddElement(this.Ads,\"table\");tbl.align=\"center\";var tbd=this.Common.AddElement(tbl,\"tbody\");var tr=this.Common.AddElement(tbd,\"tr\");var td=this.Common.AddElement(tr,\"td\",\"\",\"progDetAdsCaption\",\"Advertisement\");td.align=\"center\";tr=this.Common.AddElement(tbd,\"tr\");td=this.Common.AddElement(tr,\"td\");td.align=\"center\";this.AdImg=this.Common.AddElement(td,\"img\",\"\",\"progDetMainAd\");},AddFooter:function(){var footerMargin=this.Common.AddElement(this.Footer,\"div\",\"\",\"progDetFooterMargin\");var footerContents=this.Common.AddElement(footerMargin,\"div\",\"\",\"progDetFooterContents\");var tbl=this.Common.AddElement(footerContents,\"table\",\"\",\"progDetFooterTbl\");var tbd=this.Common.AddElement(tbl,\"tbody\");var tr=this.Common.AddElement(tbd,\"tr\");var td=this.Common.AddElement(tr,\"td\",\"\",\"\",\"What's this?\",this.ObjectName+\"WhatsThisLink\");eval(\"td.onclick = function(){ \"+this.Parent.ObjectRef+\".Common.LogStats('WhatsThis'); window.open('http://www.msntv.com/tagstemp', 'SearchWin'); return false;}\");td=this.Common.AddElement(tr,\"td\",\"\",\"progDetFooterFeedback\",\"Feedback\",this.ObjectName+\"FeedbackLink\");td.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};td.onmouseout=function(){this.style.textDecoration='none';};td.onclick=this.Common.ShowFeedback;}},ExactSearchUtils:{InitOnce:function(parent){this.ObjectName=\"ExactSearchUtils\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;},InitOnHover:function(){},CurrentRequest:0,DoExactSearch:function(postLoadFunction,onErrorOrTimeout){this.Parent.OnExactSearchBegin();this.PostLoadFunction=postLoadFunction;var onESError,onESTimeout;if(onErrorOrTimeout==null){eval(\"onESError = function(result) {\"+this.ObjectRef+\".OnESError(); };\");eval(\"onESTimeout = function(result) {\"+this.ObjectRef+\".OnESTimeout(); };\");}else{eval(\"onESError = function(result) {\"+onErrorOrTimeout+\"; };\");eval(\"onESTimeout = function(result) {\"+onErrorOrTimeout+\"; };\");}var lnk=this.Parent.NowLink;var url=this.Parent.DiscoveryWSPath+\"/\"+this.Parent.ExactSearchHandler+\"?source=tv&title=\"+encodeURIComponent(lnk.SearchableTitle)+\"&timezoneOffset=\"+this.Parent.TZ+\"&observesDST=\"+this.Parent.DST;if(this.Parent.Headend!=null)url+=\"&headend=\"+this.Parent.Headend.id;this.CurrentRequest++;eval(\"OnESLoad = function(result) {\"+this.ObjectRef+\".OnESLoad(result, onESError, \"+this.CurrentRequest+\"); };\");this.AiringsSorted=null;this.Parent.DataFetcher.LoadURL(url,true,true,10000,OnESLoad,onESTimeout,onESError);},OnESLoad:function(exactSearchResult,onESError,requestNumber){if(requestNumber!=this.CurrentRequest)return;try{eval(\"var result = \"+exactSearchResult);}catch(e){if(onESError!=null){onESError(e.message);}else{var msgDetails=\"\";this.OnESProblem(msgDetails);}return;}this.Parent.OnExactSearchComplete(result);if(this.PostLoadFunction!=null)this.PostLoadFunction.call();},OnESError:function(){var msgDetails=\"\";this.OnESProblem(msgDetails);},OnESTimeout:function(){var msgDetails=\"\";this.OnESProblem(msgDetails);},OnESProblem:function(msgDetails){var msgSummary=\"Program details are not available. Try again later.\";this.Common.DisplayMessage(this.Details.Mainarea,\"error\",msgSummary+\" \"+msgDetails);},IndicesToNextAiring:function(exactSearchOb){var scheduleIndex=-1;var airingIndex=-1;var localTime=new Date();var now=Date.UTC(localTime.getUTCFullYear(),localTime.getUTCMonth(),localTime.getUTCDate(),localTime.getUTCHours(),localTime.getUTCMinutes());var closestToNow=null;for(var i=0;i<exactSearchOb.shows.length;i++){if(exactSearchOb.shows[i].Schedule!=null){for(var j=0;j<exactSearchOb.shows[i].Schedule.length;j++){var startTime=exactSearchOb.shows[i].Schedule[j].StartTime;var endTime=startTime+exactSearchOb.shows[i].Schedule[j].Duration*60*1000;if(endTime>now&&(closestToNow==null||startTime<closestToNow)){closestToNow=startTime;scheduleIndex=i;airingIndex=j;}}}}var indices={schedule:scheduleIndex,airing:airingIndex};return indices;},IndicesToSpecificAiring:function(exactSearchOb,startTime,channelId){var scheduleIndex=-1;var airingIndex=-1;for(var i=0;i<exactSearchOb.shows.length;i++){if(exactSearchOb.shows[i].Schedule!=null){for(var j=0;j<exactSearchOb.shows[i].Schedule.length;j++){if(exactSearchOb.shows[i].Schedule[j].StartTime==startTime){scheduleIndex=i;airingIndex=j;}}}}var indices={schedule:scheduleIndex,airing:airingIndex};return indices;},GetShow:function(exactSearchOb,schedInd,airingInd){try{var progId=exactSearchOb.shows[schedInd].ProgramID;var p=exactSearchOb.shows[schedInd];var a=exactSearchOb.shows[schedInd].Schedule[airingInd];var show={program:p,programID:progId,airing:a};return show;}catch(e){return null;}},GetChannelText:function(schedule,headend){var s=\"\";if(this.Parent.Headend.isDefault){if(schedule.Affiliate!=\"Satellite\"&&schedule.Affiliate!=\"PAY\"){s+=schedule.Affiliate}else{s=schedule.CallLetters}}else{s=schedule.CallLetters+\" Ch. \"+schedule.Channel;}return s;},AddNextOnInfo:function(div,program,airing,headend){this.Common.ClearChildren(div);if(!this.Parent.NowLink.UseSpecificAiring){this.Common.AddElement(div,\"div\",\"\",\"enhPrvNextOnLabel\",\"Next on:\");nextOnInfo=this.Common.GetDateString(airing.StartTime)+\", \"+this.Common.GetTimeString(airing.StartTime);nextOnInfo+=\" \"+headend.timezoneAbbreviation+\" <br />on \"+this.GetChannelText(airing,headend);this.Common.AddElement(div,\"div\",\"\",\"enhPrvNextOn\",nextOnInfo);}if(typeof program.EpisodeTitle!='undefined'&&program.EpisodeTitle!=\"\"){this.Common.AddElement(div,\"div\",\"\",\"enhPrvEpisodeTitleLabel\",\"Episode title:\");this.Common.AddElement(div,\"div\",\"\",\"enhPrvEpisodeTitle\",program.EpisodeTitle);}else if(this.Parent.NowLink.UseSpecificAiring&&typeof program.Description!='undefined'&&program.Description!=\"\"){var desc=new String(program.Description);desc=desc.replace(/``/g,\"\\\"\");this.Common.AddElement(div,\"div\",\"\",\"enhPrvEpisodeTitleLabel\",\"Description:\");this.Common.AddElement(div,\"div\",\"\",\"enhPrvEpisodeTitle\",desc);}if(this.Parent.Headend.isDefault){infoDiv=this.Common.AddElement(div,\"div\",\"\",\"enhPrvPreviewInfoMsg\");tbl=this.Common.AddElement(infoDiv,\"table\");tbd=this.Common.AddElement(tbl,\"tbody\");tr=this.Common.AddElement(tbd,\"tr\");td=this.Common.AddElement(tr,\"td\",\"\",\"enhPrvPreviewInfoMsgIconCell\");this.Common.AddElement(td,\"div\",\"\",\"enhPrvPreviewInfoMsgIcon infoSmallUrl topMrg4 rightMrg4\");msg=\"To see if this show is in your local listings, enter your \";td=this.Common.AddElement(tr,\"td\",\"\",\"enhPrvPreviewInfoMsgText\",msg);providerLnk=this.Common.AddElement(td,\"a\",\"\",\"enhPrvPreviewInfoMsgPrvLnk\",\"TV provider\",this.ActionPanel.ObjectName+\"ChangeProvLink\");providerLnk.onmouseover=function(){this.style.textDecoration='underline';};providerLnk.onmouseout=function(){this.style.textDecoration='none';};this.Parent.LastPopover='EnhancedPreview';providerLnk.href=\"javascript:\"+this.Parent.ObjectRef+\".ChooseHeadend.Show()\";}return;},SortAiringsByDay:function(){exactSearchOb=this.Parent.ExactSearchOb;if(this.AiringsSorted!=null){return;}var airings=new Array();var shows=exactSearchOb.shows;var now=new Date();var time=Date.UTC(now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate(),now.getUTCHours(),now.getUTCMinutes());for(var i=0;i<shows.length;i++){if(shows[i].Schedule){for(var j=0;j<shows[i].Schedule.length;j++){var endTime=shows[i].Schedule[j].StartTime;endTime+=shows[i].Schedule[j].Duration*60*1000;if(endTime<=now)continue;airings[airings.length]={time:shows[i].Schedule[j].StartTime,displayDate:this.Common.GetDateString(shows[i].Schedule[j].StartTime),displayTime:this.Common.GetTimeString(shows[i].Schedule[j].StartTime),schedIdx:i,airingsIdx:j};}}}if(airings.length>0)airings.sort(function(a,b){return a.time-b.time;});this.AiringsSorted=airings;this.Details.AllAiringsLastPage=Math.floor(this.AiringsSorted.length/this.Details.AiringsPerPage+1);return;}},Record:{IsSeriesRecord:null,ShouldAllowConflict:false,InitOnce:function(parent,remoteRecordManager){this.ObjectName=\"Record\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;this.Common.CreatePopup(this,this.ObjectRef,\"Record a show\",430,304,'',\"RemoteRecord\");this.RRManager=remoteRecordManager;eval(\"var onValidateDevice = function() {\"+this.ObjectRef+\".OnValidateDevice() }\");eval(\"var onWaitingMsg = function() {\"+this.ObjectRef+\".OnWaitingMsg() }\");eval(\"var onErrorMsg = function() {\"+this.ObjectRef+\".OnErrorMsg() }\");eval(\"var onConflict = function(recordingResp) {\"+this.ObjectRef+\".OnConflict(recordingResp) }\");eval(\"var onHeadendChange = function() {\"+this.ObjectRef+\".OnHeadendChange() }\");eval(\"var onSuccess = function() {\"+this.ObjectRef+\".OnSuccess() }\");this.RRManager.SetCallbacks(onWaitingMsg,onErrorMsg,onValidateDevice,onConflict,onHeadendChange,onSuccess);},InitOnHover:function(){},Hide:function(){this.Div.style.display=\"none\";},Unhide:function(){this.Common.HideAll();this.Common.PositionPopup(this);this.Div.style.display=\"block\";},DoRecord:function(showOb){this.ShowOb=showOb;this.RRManager.CheckForDevice(showOb.program.Title);},SetPreferences:function(isSeries){this.IsSeriesRecord=isSeries;},Show:function(view){this.Div.style.display=\"block\";this.Common.ClearChildren(this.DetailArea);this.Common.ClearChildren(this.FooterArea);var h=\"\";switch(view){case\"cancelRequest\":msg=\"<b>Cancelled:</b> Your request to record \\\"\"+this.ShowOb.program.Title+\"\\\" has been cancelled.\";detMsgDiv=this.Common.DisplayMessage(this.DetailArea,\"info\",msg);a=this.Common.AddElement(detMsgDiv,\"a\",\"\",\"colorLnk nounderline\",\"View your scheduled recordings\",this.ObjectName+\"RRSettingsLink\");a.onmouseover=function(){this.style.textDecoration='underline';};a.onmouseout=function(){this.style.textDecoration='none';};a.href=\"http://tv.msn.com/tv/RR/RRHistory.aspx\";this.Common.CreateButton(\"Close\",this.ObjectName+\"CloseBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Hide();\");break;}},SubmitRecordRequestToMgr:function(){var show=this.ShowOb;var date=this.Common.LocalDateToUTCStr(show.airing.StartTime);this.RRManager.SubmitRecordRequest(show.program.Title,date,show.airing.CallLetters,show.airing.ChanID,show.airing.Channel,show.airing.Duration,show.programID,this.Parent.Headend.id,this.Parent.Headend.zip,this.IsSeriesRecord,this.ShouldAllowConflict);},NoUpcomingError:function(){this.Common.DisplayMessage(this.DetailArea,\"warning\",\"There are no upcoming episodes of <b>\"+this.Parent.NowLink.DisplayableTitle+\"</b> in your listings provider.\",false);},OnValidateDevice:function(){if(this.IsSeriesRecord==null){this.RenderSeriesEposodeChoice();}else{this.ShouldAllowConflict=false;this.SubmitRecordRequestToMgr();}},RenderSeriesEposodeChoice:function(){var oDiv,oTable,oTbody,oTr,oTd;var attrStr;this.Common.ClearChildren(this.DetailArea);this.Common.ClearChildren(this.FooterArea);var show=this.ShowOb;var channel=show.channel;var program=show.program;var airing=show.airing;var headend=show.headend;this.Common.AddElement(this.DetailArea,\"div\",\"\",\"rrTypeCaption\",\"Choose how you would like to schedule this recording:\");this.Common.AddElement(this.DetailArea,\"div\",\"\",\"rrDivider\");var progAndEpisodeTitles=program.Title;if(typeof program.EpisodeTitle!='undefined'&&program.EpisodeTitle!=\"\"){progAndEpisodeTitles+=\" &ndash; \\\"\"+program.EpisodeTitle+\"\\\"\";}this.Common.AddElement(this.DetailArea,\"div\",\"\",\"rrTypeProgAndEpisodeTitles\",progAndEpisodeTitles);oDiv=this.Common.AddElement(this.DetailArea,\"div\",\"\",\"rrTypeChoicesDiv\");oTable=this.Common.AddElement(oDiv,\"table\",\"\",\"rrTypeChoicesTbl\");oTbody=this.Common.AddElement(oTable,\"tbody\");oTr=this.Common.AddElement(oTbody,\"tr\",\"\",\"rrTypeChoicesTbl\");var commonRadioName=\"RRSeriesSingle\";oTd=this.Common.AddElement(oTr,\"td\",\"\",\"rrTypeChoicesRadioCell\");attrStr=\"id=\"+this.ObjectName+\"RecEpisode;\"+\"name=\"+commonRadioName+\";\"+\"defaultChecked=true;\"+\"type=radio\";this.RadioRecEpisode=this.Common.AddElement(oTd,\"input\",attrStr);oTd=this.Common.AddElement(oTr,\"td\",\"\",\"rrTypeChoiceCell\");this.Common.AddElement(oTd,\"div\",\"\",\"rrTypeChoicesLabel\",\"Record single show\");this.Common.AddElement(oTd,\"div\",\"\",\"\",this.Common.GetDateString(airing.StartTime));this.Common.AddElement(oTd,\"div\",\"\",\"\",this.Common.GetTimeString(airing.StartTime));oTd=this.Common.AddElement(oTr,\"td\",\"\",\"rrTypeChoicesRadioCell\");attrStr=\"id=\"+this.ObjectName+\"RecordSeries;\"+\"name=\"+commonRadioName+\";\"+\"type=radio\";this.RadioRecSeries=this.Common.AddElement(oTd,\"input\",attrStr);oTd=this.Common.AddElement(oTr,\"td\",\"\",\"rrTypeChoiceCell\");this.Common.AddElement(oTd,\"div\",\"\",\"rrTypeChoicesLabel\",\"Record entire series\");var everyDayName=\"Every \"+this.Common.DayName[(new Date(airing.StartTime)).getDay()];this.Common.AddElement(oTd,\"div\",\"\",\"\",everyDayName);this.Common.AddElement(oTd,\"div\",\"\",\"\",this.Common.GetTimeString(airing.StartTime));this.FooterArea.style.display=\"block\";this.Common.CreateButton(\"OK\",this.ObjectName+\"OKBtn\",95,\"right\",110,this.FooterArea,false,true,this.ObjectRef+\".RecordTypeSelected();\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",95,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Hide();\");this.Parent.Common.LogStats('RemoteRecord','RRShowOrSeries');},RecordTypeSelected:function(){if(this.RadioRecEpisode.checked){this.IsSeriesRecord=false;}else{this.IsSeriesRecord=true;}this.ShouldAllowConflict=false;this.SubmitRecordRequestToMgr();},OnWaitingMsg:function(){this.Common.DisplayMessage(this.DetailArea,\"waiting\",this.RRManager.RRMsg.SummaryText,false);this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Hide();\");this.Unhide();},OnErrorMsg:function(){if(this.RRManager.RRMsg.MsgCode==\"upsell\"){if(this.Parent.Browser.IsMCEPC){window.open(\"http://tv.msn.com/tv/rr/RRSetup.aspx\");this.Hide();return;}this.Common.ClearChildren(this.DetailArea);upsellScroll=this.Common.AddElement(this.DetailArea,\"div\",\"\",\"rrUpsell\");upsellScroll.innerHTML=this.RRManager.RRMsg.SummaryText+this.RRManager.RRMsg.DetailsText;this.Parent.Common.LogStats('RemoteRecord','RRUpsell');}else if(this.RRManager.RRMsg.MsgCode==\"getDeviceTimeout\"||this.RRManager.RRMsg.MsgCode==\"ALREADY_SCHEDULED\"||this.RRManager.RRMsg.MsgCode==\"setHeadendError\"||this.RRManager.RRMsg.MsgCode==\"setHeadendTimeout\"){msgDetDiv=this.Common.DisplayMessage(this.DetailArea,\"warning\",this.RRManager.RRMsg.SummaryText,false);msgDetDiv.innerHTML=this.RRManager.RRMsg.DetailsText;this.Parent.Common.LogStats('RemoteRecord','RRWarning');}else if(this.RRManager.RRMsg.MsgCode==\"TUNER_NOT_CONFIGURED\"){msgDetDiv=this.Common.DisplayMessage(this.DetailArea,\"warning\",this.RRManager.RRMsg.SummaryText,false);this.Common.AddElement(msgDetDiv,\"div\",\"\",\"bottomMrg8\",\"Configure your tuner and try again.\");var tunerFAQ=this.Common.AddElement(msgDetDiv,\"div\",\"\",\"tvTextStd colorLnk topMrg8\",\"Learn how to configure your tuner\",this.ObjectName+\"RRTunerFAQ\");tunerFAQ.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};tunerFAQ.onmouseout=function(){this.style.textDecoration='none';};eval(\"tunerFAQ.onclick = function(){ \"+this.ObjectRef+\".Parent.Common.PopupWin('http://tv.msn.com/help/tv/rrfaq#CONFIGTUNER'); };\");}else if(this.RRManager.RRMsg.MsgCode==\"USER_DISABLED\"){msgDetDiv=this.Common.DisplayMessage(this.DetailArea,\"warning\",this.RRManager.RRMsg.SummaryText,false);this.Common.AddElement(msgDetDiv,\"div\",\"\",\"bottomMrg8\",\"Enable Remote Record.\");var tunerFAQ=this.Common.AddElement(msgDetDiv,\"div\",\"\",\"tvTextStd colorLnk topMrg8\",\"Learn how to enable Remote Record\",this.ObjectName+\"RREnableFAQ\");tunerFAQ.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};tunerFAQ.onmouseout=function(){this.style.textDecoration='none';};eval(\"tunerFAQ.onclick = function(){ \"+this.ObjectRef+\".Parent.Common.PopupWin('http://tv.msn.com/help/tv/rrfaq#ACTIVATERR'); };\");}else if(this.RRManager.RRMsg.MsgCode==\"SCHEDULE_NOT_FOUND\"){msgDetDiv=this.Common.DisplayMessage(this.DetailArea,\"warning\",this.RRManager.RRMsg.SummaryText,false);this.Common.AddElement(msgDetDiv,\"div\",\"\",\"bottomMrg8\",\"Your Media Center PC Program Guide might be out of date. Update your Program Guide and try again.\");var tunerFAQ=this.Common.AddElement(msgDetDiv,\"div\",\"\",\"tvTextStd colorLnk topMrg8\",\"Learn how to update your Program Guide\",this.ObjectName+\"RRPgmGuideFAQ\");tunerFAQ.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};tunerFAQ.onmouseout=function(){this.style.textDecoration='none';};eval(\"tunerFAQ.onclick = function(){ \"+this.ObjectRef+\".Parent.Common.PopupWin('http://tv.msn.com/help/tv/rrfaq#PROGRAMGUIDE'); };\");}else if(this.RRManager.RRMsg.MsgCode==\"GUIDE_DATA_EXPIRED\"||this.RRManager.RRMsg.MsgCode==\"GUIDE_DATA_NOT_CONFIGURED\"){msgDetDiv=this.Common.DisplayMessage(this.DetailArea,\"warning\",this.RRManager.RRMsg.SummaryText,false);this.Common.AddElement(msgDetDiv,\"div\",\"\",\"bottomMrg8\",\"You need to update your Program Guide.\");var tunerFAQ=this.Common.AddElement(msgDetDiv,\"div\",\"\",\"tvTextStd colorLnk topMrg8\",\"Learn how to update your Program Guide\",this.ObjectName+\"RRPgmGuide1FAQ\");tunerFAQ.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};tunerFAQ.onmouseout=function(){this.style.textDecoration='none';};eval(\"tunerFAQ.onclick = function(){ \"+this.ObjectRef+\".Parent.Common.PopupWin('http://tv.msn.com/help/tv/rrfaq#PROGRAMGUIDE'); };\");}else{msgDetDiv=this.Common.DisplayMessage(this.DetailArea,\"error\",this.RRManager.RRMsg.SummaryText,false);msgDetDiv.innerHTML=this.RRManager.RRMsg.DetailsText;this.Parent.Common.LogStats('RemoteRecord','RRError');}this.Common.CreateButton(\"Close\",this.ObjectName+\"CloseBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Hide();\");},OnConflict:function(){var oForm,oDiv,oHr,oBr,oInput,oSpan,oZIP;recordingResp=this.RRManager.RemoteRecordResponse;this.Common.ClearChildren(this.DetailArea);this.Common.ClearChildren(this.FooterArea);if(this.RRManager.GetRemoteDeviceResponse.ConflictPolicy==\"ALWAYS_CANCEL\"){msg=\"<b>Request Cancelled:</b> Your request to record \\\"\"+this.ShowOb.program.Title+\"\\\" was canceled due to a scheduling conflict.\";msg+=\" The current show is still scheduled to record.\";detMsgDiv=this.Common.DisplayMessage(this.DetailArea,\"info\",msg,true);this.Common.AddElement(detMsgDiv,\"span\",\"\",\"\",\"To change your settings so you can decide which show to record when there is a conflict visit your \");a=this.Common.AddElement(detMsgDiv,\"a\",\"\",\"colorLnk nounderline\",\"MSN Remote Record settings\",this.ObjectName+\"RRSettingsLink\");a.onmouseover=function(){this.style.textDecoration='underline';};a.onmouseout=function(){this.style.textDecoration='none';};a.href=\"http://tv.msn.com/tv/rr/RRSettingsFromExternal.aspx\";this.Common.AddElement(detMsgDiv,\"span\",\"\",\" page\",\"&nbsp;page.\");this.Common.CreateButton(\"Close\",this.ObjectName+\"CloseBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Hide();\");this.Parent.Common.LogStats('RemoteRecord','RRConflictAlwaysCancel');}else{oDetArea=this.Common.DisplayMessage(this.DetailArea,\"warning\",this.RRManager.RRMsg.SummaryText,true);this.Common.AddElement(oDetArea,\"div\",\"\",\"topMrg0\",\"Choose a recording option:\");var attrStr=\"name=conflictForm\";this.ConflictForm=this.Common.AddElement(oDetArea,\"form\",attrStr,\"topMrg4\");var frm=this.ConflictForm;var commonName=\"RRConflict\";oTable=this.Common.AddElement(this.ConflictForm,\"table\");oTbody=this.Common.AddElement(oTable,\"tbody\");oTr=this.Common.AddElement(oTbody,\"tr\");oTd=this.Common.AddElement(oTr,\"td\");attrStr=\"id=\"+this.ObjectName+\"ConflictCancel;\"+\"name=\"+commonName+\";\"+\"defaultChecked=true;\"+\"type=radio\";this.RadioCancel=this.Common.AddElement(oTd,\"input\",attrStr);this.Common.AddElement(oTr,\"td\",\"\",\"text11\",\"Cancel this request and record the previously scheduled show\");oTr=this.Common.AddElement(oTbody,\"tr\");oTd=this.Common.AddElement(oTr,\"td\");attrStr=\"id=\"+this.ObjectName+\"ConflictOverride;\"+\"name=\"+commonName+\";\"+\"type=radio\";this.RadioOverride=this.Common.AddElement(oTd,\"input\",attrStr);this.Common.AddElement(oTr,\"td\",\"\",\"text11\",\"Record this show instead of the previously scheduled show\");var conflictsFaqLink=this.Common.AddElement(frm,\"div\",\"\",\"tvTextStd colorLnk topMrg8\",\"Learn more about conflicts\",this.ObjectName+\"RRConflictFAQ\");conflictsFaqLink.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};conflictsFaqLink.onmouseout=function(){this.style.textDecoration='none';};eval(\"conflictsFaqLink.onclick = function(){ \"+this.ObjectRef+\".Parent.Common.PopupWin('http://tv.msn.com/help/tv/rrfaq#CONFLICT'); };\");this.Common.CreateButton(\"OK\",this.ObjectName+\"OKBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".ProcessConflict();\");this.Parent.Common.LogStats('RemoteRecord','RRConflictAsk');}},ProcessConflict:function(){if(this.RadioOverride.checked){this.ShouldAllowConflict=true;this.SubmitRecordRequestToMgr();}else{this.Show('cancelRequest');};},CancelRecord:function(){msg=\"<b>Canceled:</b> Your request to record \\\"\"+this.Parent.NowLink.DisplayableTitle+\"\\\" has been canceled. The previous show is still scheduled to record.\";this.Common.DisplayMessage(this.DetailArea,\"info\",this.RRManager.RRMsg.SummaryText,false);this.CreateViewRecLink(this.DetailArea);this.CreateSettingsLink(this.DetailArea);this.Common.CreateButton(\"Close\",this.ObjectName+\"CloseBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Hide();\");this.Parent.Common.LogStats('RemoteRecord','RRConflictCancelled');},CreateViewRecLink:function(oParent){this.RRSchedule=this.Common.AddElement(oParent,\"div\",\"\",\"tvTextStd colorLnk topMrg8\",\"View your recordings\",this.ObjectName+\"ViewRecLink\");this.RRSchedule.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};this.RRSchedule.onmouseout=function(){this.style.textDecoration='none';};eval(\"this.RRSchedule.onclick = function(){ \"+this.ObjectRef+\".Parent.Common.PopupWin('http://tv.msn.com/tv/RR/RRHistory.aspx'); };\");},CreateSettingsLink:function(oParent){this.RRSchedule=this.Common.AddElement(oParent,\"div\",\"\",\"tvTextStd colorLnk topMrg8\",\"MSN Remote Record Settings\",this.ObjectName+\"RRSettingsLink\");this.RRSchedule.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};this.RRSchedule.onmouseout=function(){this.style.textDecoration='none';};eval(\"this.RRSchedule.onclick = function(){ \"+this.ObjectRef+\".Parent.Common.PopupWin('http://tv.msn.com/tv/RR/RRSettingsFromExternal.aspx'); };\");},OnHeadendChange:function(){detMsgDiv=this.Common.DisplayMessage(this.DetailArea,\"info\",this.RRManager.RRMsg.SummaryText,true);this.Parent.Headend=null;this.Common.AddElement(detMsgDiv,\"div\",\"\",\"tvTextStd bottomMrg8\",\"Choose a link to look for this show in the updated listings and reschedule the recording:\");oLink=this.Common.AddElement(detMsgDiv,\"div\",\"\",\"panelBtnTextSmall\",\"Look for all airings\",this.ObjectName+\"LookAllLink\");eval(\"oLink.onclick = function(){ \"+this.Parent.ObjectRef+\".DoExactSearchThenAllAirings();};\");oLink.onmouseover=function(){this.style.textDecoration='underline';};oLink.onmouseout=function(){this.style.textDecoration='none';};oLink=this.Common.AddElement(detMsgDiv,\"div\",\"\",\"panelBtnTextSmall\",\"Look for next on\",this.ObjectName+\"LookNextLink\");eval(\"oLink.onclick = function(){ \"+this.Parent.ObjectRef+\".DoExactSearchThenProgDet();};\");oLink.onmouseover=function(){this.style.textDecoration='underline';};oLink.onmouseout=function(){this.style.textDecoration='none';};this.Common.CreateButton(\"Close\",this.ObjectName+\"CloseBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Hide();\");this.Parent.Common.LogStats('RemoteRecord','RRHeadendSync');},OnSuccess:function(){detailDiv=this.Common.DisplayMessage(this.DetailArea,\"info\",this.RRManager.RRMsg.SummaryText);tbl=this.Common.AddElement(detailDiv,\"table\",\"\",\"rrConfTbl\");tbd=this.Common.AddElement(tbl,\"tbody\");tr=this.Common.AddElement(tbd,\"tr\");var airing=this.Parent.NowShow.airing;this.Common.AddElement(tr,\"td\",\"\",\"rrConfLbl\",\"Show name:\");this.Common.AddElement(tr,\"td\",\"\",\"rrConfValue\",this.Parent.NowShow.program.Title);tr=this.Common.AddElement(tbd,\"tr\");this.Common.AddElement(tr,\"td\",\"\",\"rrConfLbl\",\"Channel:\");var channel=this.ExactSearchUtils.GetChannelText(airing,this.Parent.NowShow.headend);this.Common.AddElement(tr,\"td\",\"\",\"rrConfValue\",channel);tr=this.Common.AddElement(tbd,\"tr\");this.Common.AddElement(tr,\"td\",\"\",\"rrConfLbl\",\"Time:\");var duration=Math.floor(airing.Duration);var showTime=this.Common.GetDateString(airing.StartTime)+\" \"+this.Common.GetTimeString(airing.StartTime)+\" \"+this.Parent.Headend.timezoneAbbreviation+\" (\"+duration+\" min)\";this.Common.AddElement(tr,\"td\",\"\",\"rrConfValue\",showTime);tr=this.Common.AddElement(tbd,\"tr\");this.Common.AddElement(tr,\"td\",\"\",\"rrConfLbl\",\"Record type:\");var recType;if(!this.RRManager.IsSeries){recType=\"Episode\";}else{recType=\"Series\";}this.Common.AddElement(tr,\"td\",\"\",\"rrConfValue\",recType);this.CreateViewRecLink(detailDiv);this.Common.CreateButton(\"Close\",this.ObjectName+\"CloseBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Hide();\");this.Parent.Common.LogStats('RemoteRecord','RRSuccess');},OnSignInMsg:function(oMsg){this.Common.HideAll();this.Unhide();if(this.Parent.NowShow!=null&&this.Parent.NowShow!='undefined'&&this.Parent.NowShow!=\"\"){msg=\"To record this episode of \\\"\"+this.Parent.NowShow.program.Title+\"\\\" with MSN&reg; Remote Record, you must be signed in to Windows Live&trade; ID.\";}else{msg=\"To record this episode MSN&reg; Remote Record, you must be signed in to Windows Live&trade; ID.\";}detailDiv=this.Common.DisplayMessage(this.DetailArea,\"none\",msg,true);this.Common.AddElement(detailDiv,\"div\",\"\",\"tvTextStdBold bottomMrg8\",\"Sign in to Windows Live&trade; ID\");this.Common.AddElement(detailDiv,\"div\",\"\",\"tvTextStd\",\"The MSN Remote Record service provides Windows&reg; XP Media Center Edition 2005 users with a way to schedule TV show recordings from virtually any PC with an Internet connection.\");this.RRinfo=this.Common.AddElement(detailDiv,\"div\",\"\",\"tvTextStd colorLnk topMrg8\",\"Find out about MSN Remote Record\",this.ObjectName+\"FindOutLink\");this.RRinfo.onmouseover=function(){this.style.textDecoration='underline';this.style.cursor='pointer';};this.RRinfo.onmouseout=function(){this.style.textDecoration='none';};eval(\"this.RRinfo.onclick = function(){ \"+this.ObjectRef+\".Parent.Common.LogStats('RRMoreAbout');\"+this.ObjectRef+\".Parent.Common.PopupWin('http://tv.msn.com/tv/RR/RRInfo.aspx'); };\");this.Common.CreateButton(\"Sign In\",this.ObjectName+\"SignInBtn\",74,\"right\",100,this.FooterArea,false,true,this.ObjectRef+\".PassportMgr.PPSignInResume();\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Hide();\");}},SignIn:{InitOnce:function(parent){this.ObjectName=\"SignIn\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;this.Common.CreatePopup(this,this.ObjectRef,\"Sign In\",363,304,'',\"PassportSignIn\");},InitOnHover:function(){this.DoAfterSignOut=null;},Hide:function(){this.Div.style.display=\"none\";},Unhide:function(){this.Common.HideAll();this.Common.PositionPopup(this);this.Div.style.display=\"block\";},BeginSignIn:function(onSignInComplete){this.DoAfterSignIn=onSignInComplete;this.PassportMgr.PPSignIn();},OnWaitingMsg:function(){this.Common.DisplayMessage(this.DetailArea,\"waiting\",this.PassportMgr.PPMsg.SummaryText);this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".AbortSignin();\");this.Unhide();},AbortSignin:function(){this.PassportMgr.AbortSignin();this.Hide();},OnErrorMsg:function(oMsg){this.Common.DisplayMessage(this.DetailArea,\"warning\",this.PassportMgr.PPMsg.SummaryText);this.Common.CreateButton(\"Close\",this.ObjectName+\"CloseBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Hide();\");this.Unhide();},OnSignInMsg:function(oMsg){this.Common.HideAll();this.Unhide();this.Common.ClearChildren(this.DetailArea);var summaryText=this.PassportMgr.PPMsg.SummaryText;var detailsText=this.PassportMgr.PPMsg.DetailsText;h=\"<img src='\"+this.Parent.ImagePath+\"exclamation_point.gif' align='left'>\";h=\"<span style='color:#FA4600; font:bold 13 verdana;'>\"+summaryText+\"</span><br>\";h+=\"<br><hr size=1 color='#88A8D4' /></div>\";this.DetailArea.innerHTML=h;this.Common.CreateButton(\"OK\",this.ObjectName+\"OKBtn\",74,\"right\",100,this.FooterArea,false,true,this.ObjectRef+\".PassportMgr.PPSignInResume();\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Hide();\");},OnSignInFailedMsg:function(oMsg){this.Common.DisplayMessage(this.DetailArea,\"warning\",this.PassportMgr.PPMsg.SummaryText);this.Unhide();this.Common.CreateButton(\"Sign In\",this.ObjectName+\"SignInBtn\",74,\"right\",100,this.FooterArea,false,true,this.ObjectRef+\".PassportMgr.PPSignInResume();\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Hide();\");},OnSignOutFailedMsg:function(oMsg){this.Common.DisplayMessage(this.DetailArea,\"warning\",this.PassportMgr.PPMsg.SummaryText+\" \"+this.PassportMgr.PPMsg.DetailsText,false);this.Common.CreateButton(\"OK\",this.ObjectName+\"OKBtn\",74,\"right\",100,this.FooterArea,false,true,this.ObjectRef+\".PassportMgr.PPSignInResume();\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,false,this.ObjectRef+\".Hide();\");},OnSignedIn:function(alreadyAuthenticated){if(this.DoAfterSignIn!=null){this.DoAfterSignIn(alreadyAuthenticated);}else{this.Hide();}}},Remind:{InitOnce:function(parent){this.ObjectName=\"Remind\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;this.Common.CreatePopup(this,this.ObjectRef,\"Remind Me\",363,363,'',\"Remind\");this.DoOutlookReminderUrl=parent.DiscoveryWSPath+\"/ReminderCreateICS.ashx\";this.DoMsnReminderUrl=parent.DiscoveryWSPath+\"/ReminderSignup.ashx?\";this.ManageSubscriptionsUrl=parent.DiscoveryWSPath+\"/ReminderPrototype/ManageSubscriptions.aspx\";this.ReminderTimeSelectionArray=new Array();},InitOnHover:function(){},Show:function(){this.ShowView('chooseReminder');},Hide:function(){this.Div.style.display=\"none\";},Unhide:function(){this.Common.PositionPopup(this);this.Div.style.display=\"block\";},ShowView:function(view){this.Common.HideAll();this.Unhide();this.Common.ClearChildren(this.DetailArea);this.DetailArea.innerHTML=\"\";this.Common.ClearChildren(this.FooterArea);var oForm,oDiv,oHr,oBr,oInput,oSpan,oZIP;switch(view){case\"chooseReminder\":this.TVShow=this.ExactSearchUtils.GetShow(this.Parent.ExactSearchOb,this.Parent.ScheduleIdx,this.Parent.AiringIdx);var prog=this.TVShow.program;var airing=this.TVShow.airing;var showTime=this.Common.GetDateString(airing.StartTime)+\" \"+this.Common.GetTimeString(airing.StartTime);var channel=this.ExactSearchUtils.GetChannelText(this.TVShow.schedule,this.TVShow.headend);var oProvForm=document.createElement(\"<form name='provForm' onSubmit='return \"+this.ObjectRef+\".RedirectToManageSubscriptions()'>\");this.ProvForm=this.DetailArea.appendChild(oProvForm);this.CreateDetailsTable(oProvForm,prog,showTime,channel);oSelectTimeLabel=this.Common.AddElement(oProvForm,\"span\",\"\",\"remHdrText\",\"<br/>Select the time you wish to be notified<br/>\");this.CreateSelectTimeTable(oProvForm,airing);oP=this.Common.AddElement(oProvForm,\"p\");oSelectDeliveryLabel=this.Common.AddElement(oProvForm,\"span\",\"\",\"remHdrText\",\"Select the method of notification\");var messengerButton=this.Common.AddElement(oProvForm,\"lnk\",\"\",\"remMessengerBtn\",\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\");var MsnMessengerLink=this.Common.AddElement(messengerButton,\"lnk\",\"\",\"panelBtnText\",\"<img src='\"+this.Parent.ImagePath+\"messenger[1].gif'/>MSN Messenger\");MsnMessengerLink.onmouseover=function(){this.style.textDecoration='underline';};MsnMessengerLink.onmouseout=function(){this.style.textDecoration='none';};var outlookButton=this.Common.AddElement(oProvForm,\"lnk\",\"\",\"remOutlookBtn\");var OutlookLink=this.Common.AddElement(outlookButton,\"lnk\",\"\",\"panelBtnText\",\"<img src='\"+this.Parent.ImagePath+\"icon-appt[1].gif'/>&nbsp;MS Outlook\");OutlookLink.onmouseover=function(){this.style.textDecoration='underline';};OutlookLink.onmouseout=function(){this.style.textDecoration='none';};var params=\"'\"+this.TVShow.programID+\"', '\"+this.Parent.Headend.id+\"', '\"+this.TVShow.airing.ChanID+\"'\";eval(\"MsnMessengerLink.onclick = function(){ \"+this.ObjectRef+\".RemindWithMessenger(\"+params+\"); };\");eval(\"OutlookLink.onclick = function(){ \"+this.ObjectRef+\".RemindWithOutlook(); };\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Hide();\");this.FooterArea.style.display=\"block\";break;case\"signupComplete\":this.Common.AddElement(this.DetailArea,\"p\");var text=\"You can manage your reminder settings here\";this.Common.AddElement(this.DetailArea,\"div\",\"\",\"remText\",text);this.Common.AddElement(this.DetailArea,\"p\");var label=\"Manage My Reminders\";var link=this.Common.AddElement(this.DetailArea,\"div\",\"\",\"panelBtnText\",label);link.onmouseover=function(){this.style.textDecoration='underline';};link.onmouseout=function(){this.style.textDecoration='none';};eval(\"link.onclick = function(){ \"+this.ObjectRef+\".RedirectToManageSubscriptions(); };\");this.Common.CreateButton(\"Cancel\",this.ObjectName+\"CancelBtn\",74,\"right\",8,this.FooterArea,false,true,this.ObjectRef+\".Hide();\");this.FooterArea.style.display=\"block\";break;}},RedirectToManageSubscriptions:function(){window.location=this.ManageSubscriptionsUrl;},RemindWithMessenger:function(programId,headendId,channelId){this.DoMsnReminderUrl+=(\"programId=\"+programId+\"&headendId=\"+headendId);this.DoMsnReminderUrl+=(\"&channelId=\"+channelId);this.DoMsnReminderUrl+=(\"&reminderTime=\"+this.GetSelectedReminderTime());this.DoMsnReminderUrl+=(\"&zip=\"+this.Parent.Headend.zip);eval(\"onLoad = function(result) {\"+this.ObjectRef+\".OnCompletedSignup(result); };\");eval(\"onTimeout = function() {\"+this.ObjectRef+\".OnSignupTimeout(); };\");eval(\"onError = function() {\"+this.ObjectRef+\".OnSignupError(); };\");this.DataFetcher.LoadURL(this.DoMsnReminderUrl,false,true,25000,onLoad,onTimeout,onError);},OnCompletedSignup:function(result){if(result.code==326){this.ShowView(\"signupComplete\");}else if(result.code==0){window.location=result.url;}else{this.Common.DisplayPopupMsg(this,\"error\",\"ResultCode\"+result.code,true,true,\"An error has occurred in setting up your reminder.\");}},OnSignupTimeout:function(){this.Common.DisplayPopupMsg(this,\"error\",\"OnSignupTimeout\",true,true,\"An error has occurred in setting up your reminder.\");},OnSignupError:function(){this.Common.DisplayPopupMsg(this,\"error\",\"OnSignupError\",true,true,\"An error has occurred in setting up your reminder.\");},RemindWithOutlook:function(){this.Hide();var millis=this.TVShow.airing.StartTime;var end=new Date(millis+(this.TVShow.program.Duration*60*1000));var querystring=\"?startTime=\"+this.Common.LocalDateToUTCStr(this.TVShow.airing.StartTime);querystring+=\"&endTime=\"+this.Common.LocalDateToUTCStr(end);querystring+=\"&title=\"+this.TVShow.program.Title;querystring+=\"&affiliate=\"+this.TVShow.schedule.Affiliate;querystring+=\"&channel=\"+this.TVShow.schedule.Channel;querystring+=\"&reminderTrigger=\"+this.GetReminderTrigger();window.location=this.DoOutlookReminderUrl+querystring;},GetSelectedReminderTime:function(){var timeSel=document.getElementById(\"remTimeSel\");var idx=timeSel.selectedIndex;var remTime=this.ReminderTimeSelectionArray[idx];return this.Common.LocalDateToUTCStr(remTime);},GetReminderTrigger:function(){var timeSel=document.getElementById(\"remTimeSel\");var idx=timeSel.selectedIndex;var ret;switch(idx){case 0:ret=\"-PT15M\";break;case 1:ret=\"-PT30M\";break;case 2:ret=\"-PT45M\";break;case 3:ret=\"-PT60M\";break;}return ret;},CalculateReminderTime:function(airingTime,minutes){var millis=airingTime.getTime();var newTime=millis-(minutes*60*1000);var reminderTime=new Date(newTime);this.ReminderTimeSelectionArray.push(reminderTime);return this.Common.GetTimeString(reminderTime);},CreateSelectTimeTable:function(parentObj,airing){var SelectTimeHtml=\"<select id='remTimeSel' NAME='remTime'>\";SelectTimeHtml+=(\"<option VALUE='time 1'>\"+this.CalculateReminderTime(airing.StartTime,15)+\"&nbsp;</option>\");SelectTimeHtml+=(\"<option VALUE='time 2'>\"+this.CalculateReminderTime(airing.StartTime,30)+\"</option>\");SelectTimeHtml+=(\"<option VALUE='time 3'>\"+this.CalculateReminderTime(airing.StartTime,45)+\"</option>\");SelectTimeHtml+=(\"<option VALUE='time 4'>\"+this.CalculateReminderTime(airing.StartTime,60)+\"</option></select>\");this.TimeSelectionTable=this.Common.AddElement(parentObj,\"table\",\"width=100;\");oTR=this.Common.AddElement(this.TimeSelectionTable,\"tr\");this.Common.AddElement(oTR,\"td\",\"align=right\",\"\",SelectTimeHtml);},CreateDetailsTable:function(parentObj,prog,showTime,channel){var oTable,oTBody,oTR,oTD,oA;this.DetTable=this.Common.AddElement(parentObj,\"TABLE\",\"\",\"progDetTable\");this.DetTableBody=this.Common.AddElement(this.DetTable,\"tbody\");this.OneRow(this.DetTableBody,\"\",\"remDivider1\");this.OneRow(this.DetTableBody,prog.EpisodeTitle,\"progDetEpisode\");this.OneRow(this.DetTableBody,prog.Description,\"progDetDesc\");oTR=this.Common.AddElement(this.DetTableBody,\"TR\");oTD=this.Common.AddElement(oTR,\"TD\");oTable=this.Common.AddElement(oTD,\"TABLE\",\"\",\"progDetTimeTbl\");oTBody=this.Common.AddElement(oTable,\"tbody\");oTR=this.Common.AddElement(oTBody,\"TR\");oTD=this.Common.AddElement(oTR,\"TD\",\"\",\"progDetTime\",showTime);oTD=this.Common.AddElement(oTR,\"TD\",\"\",\"progDetChan\",channel);this.OneRow(this.DetTableBody,\"\",\"remDivider2\");},OneRow:function(parentOb,html,cellStyleName){var oTR,oTD;oTR=this.Common.AddElement(parentOb,\"TR\");if(html==null||html==\"\"){oTD=this.Common.AddElement(oTR,\"TD\",\"\",cellStyleName);}else{oTD=this.Common.AddElement(oTR,\"TD\",\"\",cellStyleName,html);}return this.TD;},Cancel:function(){this.Hide();}},Styles:{InitOnce:function(parent){this.ObjectName=\"Styles\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;this.All=new Array();this.PTag=this.Parent.Browser.IsInStrictMode?\"<p>&nbsp;</p> \":\"<p/>\";this.Add(\"tvTag\",\"cursor:pointer; color:#1AAB1F; font-weight:bold\");this.ActionPanelWidth=200;this.ActionPanelArrowWidth=19;this.ActionPanelArrowTop=-85;this.BeakHeight=33;this.BeakHalfHeight=16;this.DefaultBeakMarginX=0;this.DefaultBeakMarginY=8;this.Add(\"panelArrow\",\"position:absolute; display:none;z-index:100;\");this.Add(\"enhPrv\",\"position:absolute; width: 200px; z-index:100; border:1px solid #aaaaaa;background-color:white;\");this.Add(\"enhPrvTitleArea\",\"height: 36px;\");this.Add(\"enhPrvLogo\",\"position:absolute; top:8px; right:12px; height:30px; width:110px;\");this.Add(\"enhPrvPreviewArea\",\"margin-right:12px;margin-bottom: 8px;margin-left:12px; font:11px Verdana, sans-serif; color: #333333; line-height:120%;\");this.Add(\"enhPrvTitle\",\"font-size: 12px; font-weight:bold; margin-bottom: 4px;\");this.Add(\"enhPrvNextOnLabel\",\"font-weight:bold; margin-bottom: 2px;\");this.Add(\"enhPrvNextOn\",\"margin-bottom:3px;\");this.Add(\"enhPrvEpisodeTitleLabel\",\"font-weight:bold; margin-bottom:4px;\");this.Add(\"enhPrvPreviewInfoMsg\",\"margin-top:8px;\");this.Add(\"enhPrvPreviewInfoMsgIconCell\",\"vertical-align:top;\");this.Add(\"enhPrvPreviewInfoMsgIcon\",\"background-repeat:no-repeat;top:0px; width:18px; height:22px; vertical-align:top;\");this.Add(\"enhPrvPreviewErrorMsgIcon\",\"background-image:url(\"+parent.ImagePath+\"error_16x16.png); background-repeat:no-repeat;top:0px; width:18px; height:22px; vertical-align:top;\");this.Add(\"enhPrvPreviewInfoMsgText\",\"width:190px; font:11px Verdana, sans-serif; color: #333333;\");this.Add(\"enhPrvPreviewInfoMsgPrvLnk\",\"color:#0088E4; text-decoration:none; cursor:pointer; font-style:normal;\");this.Add(\"shadowDiv\",\"position:absolute; opacity:0.25; -moz-opacity:0.25; filter:alpha(opacity=25); background-color:black;\");this.Add(\"enhPrvActionsAreaMargin\",\"margin: 0px 4px 0px 4px; background-color:#e4edf3;\");this.Add(\"enhPrvActionsArea\",\"margin: 0px 8px 0px 8px; font:11px Verdana, sans-serif; color:#0088e4; line-height:170%;\");this.Add(\"enhPrvActionsAreaSpacer\",\"height:5px; font-size:0px;\");this.Add(\"enhPrvAction\",\"cursor:pointer;\");this.Add(\"enhPrvAdAreaMargin\",\"margin: 2px 4px 0px 4px;  background-color:#f1f2f4;\");this.Add(\"enhPrvAdAreaSpacer\",\"height:5px; font-size:0px;\");this.Add(\"enhPrvAdArea\",\"margin:0px 0px 0px 8px; font:10px Verdana, sans-serif;line-height:130%;\");this.Add(\"enhPrvAdSponsorLabel\",\"margin-right:4px; font-size:10px; color:#777777; text-align:right;\");this.Add(\"enhPrvAdTitle\",\"color:#0088e4; cursor:pointer;\");this.Add(\"enhPrvAdText\",\"color:#333333;\");this.Add(\"enhPrvOrgURL\",\"font-size:10px; color:#0088e4; cursor:pointer;\");this.Add(\"enhPrvFooterAreaMargin\",\"margin:0px 4px 0px 4px;\");this.Add(\"enhPrvFooterArea\",\"width:100%;\");this.Add(\"enhPrvFooterTbl\",\"width:100%;font:10px Verdana, sans-serif; color: #777777;\");this.Add(\"enhPrvFooterFeedback\",\"text-align:right;\");this.Add(\"popupBackground\",\"position:absolute; background-color:black; display:none; left:50%; top:50%;\");this.Add(\"popupInner\",\"position:absolute; top:1px; left:1px; background-color:white;\");this.Add(\"popupHdrMargins\",\"height:28px;background-color:#e4edf4;\");this.Add(\"popupHdrTxt\",\"margin:0px 8px 0px 8px; line-height:28px; color:#333333; font-size:17px; font-family:Verdana, Tahoma, Sans-Serif;\");this.Add(\"popupDetail\",\"position:absolute; top:28px; left:0px; margin:8px 8px 8px 8px; width:95%; color:#333333; font:11px Verdana, Tahoma, Sans-Serif;\");this.Add(\"popupHeaderEx\",\"position:absolute; top:0px; left:0px; width:100%; height:26px; font-size:17px; font-family:Verdana, Tahoma, Sans-Serif; color:#333333; background-color:#e4edf4;\");this.Add(\"popupDetailEx\",\"position:absolute; top:26px; left:0px; width:100%; height:276px; font-size:11px; font-family:Verdana, Tahoma, Sans-Serif;\");this.Add(\"popupLiveSrch\",\"position:absolute; top:302px; left:0px; width:100%; height:28px; font-size:11px; font-family:Verdana, Tahoma, Sans-Serif;\");this.Add(\"popupAds\",\"position:absolute; top:330px; left:0px; width:416px; height:98px; font-size:11px; font-family:Verdana, Tahoma, Sans-Serif; margin-left:8px; margin-right:8px;background-color:#EEEEEE;\");this.Add(\"popupFooterEx\",\"position:absolute; top:428px; left:0px; width:100%; height:16px; font-size:11px; font-family; Verdana, Tahoma, Sans-Serif;\");this.Add(\"progDetSideBar\",\"position:absolute; top:8px; left:8px; width:89px; height:260px; font-size:11px; font-family:Verdana, Tahoma, Sans-Serif;border:solid 1px #e4edff;\");this.Add(\"progDetMainArea\",\"position:absolute; top:8px; left:102px; width:322px; height:260px; font-size:11px; font-family:Verdana, Tahoma, Sans-Serif;border:solid 1px #e4edff;\");this.Add(\"popupClose\",\"position:absolute; top:6px; right:5px; z-index:1; color:#333333; font:14px Verdana, Tahoma, Sans-Serif; cursor:pointer; text-decoration:none;\");this.Add(\"popupFooter\",\"position:absolute; bottom:0px; left:0px; width:100%; height:37px; background-color:#e4edf4;\");this.Add(\"innerDiv\",\"position:absolute; border:solid 1px #E4EDF3;\");this.Add(\"tvTagGeneral\",\"position:absolute; width:100%; border:solid 1px #E4EDF3\");this.Add(\"popupFooterBtn\",\"position:absolute; top:8px; height:22px; line-height:22px; width:85px; minWidth:85px; cursor:pointer; text-align:center; font-size:12px; font-family:Verdana, Tahoma, Sans-Serif; border:solid 1px #4c73b9; background-position:center center\");this.Add(\"btnRest\",\"background-image:url(\"+parent.ImagePath+\"btn_default_normal.gif);\");this.Add(\"btnHover\",\"background-image:url(\"+parent.ImagePath+\"btn_hot_normal.gif);\");this.Add(\"btnPressed\",\"background-image:url(\"+parent.ImagePath+\"btn_pressed_normal.gif);\");this.Add(\"btnHot\",\"background-image:url(\"+parent.ImagePath+\"btn_hot_normal.gif);\");this.Add(\"btnDisabled\",\"border-left-color:#c7c7c7; background-image:none; border-bottom-color:#c7c7c7; color:#c7c7c7; border-top-color:#c7c7c7; background-color:#f1f1f1; border-right-color:#c7c7c7;\");this.Add(\"msgRuleDIV\",\"position:absolute; top:37px; left:0px;\");this.Add(\"msgRuleHR\",\"color:#88A8D4; size:1px;\");this.Add(\"msgBottomDIV\",\"position:absolute; top:50px; left:0px;\");this.Add(\"allAirContentArea\",\"position: absolute; height:244px; width:306px; margin: 8px;\");this.Add(\"allAirHdr\",\"position:absolute; top:0px; left:0px; width:306px; font-weight:bold; font-size:14px; font-family: Verdana, sans-serif; color: #333333; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; \");this.Add(\"allAirDivider\",\"position:absolute; top:23px; left:0; border-top: #e4edff 1px solid; width:306px; height:1px;  color:#e4edf4; font-size:1px;\");this.Add(\"allAirShowings\",\"position:absolute; top:0px; right:0px; width:150px; text-align: right;font: 11px Verdana, sans-serif; color: #333333;\");this.Add(\"allAirTblDiv\",\"position:absolute; top:26px; left:0px; width:306px;\");this.Add(\"allAirTbl\",\"font:11px Verdana, sans-serif; width:100%; border-collapse:collapse;\");this.Add(\"allAirTblHdr\",\"font-weight:bold;\");this.Add(\"allAirDayTimeCell\",\"width:102px; min-width:102px; max-width:102px;\");this.Add(\"allAirDayTimeDiv\",\"overflow:hidden; width:97px; white-space: nowrap; text-overflow: ellipsis;margin-top:1px\");this.Add(\"allAirChanCell\",\"width:68px; min-width:68px; max-width:68px;\");this.Add(\"allAirChanDiv\",\"overflow:hidden; width:63px; white-space: nowrap; text-overflow: ellipsis;margin-top:1px\");this.Add(\"allAirEpisodeCell\",\"width: 141px; min-width:141px; max-width:141px;\");this.Add(\"allAirEpisodeCellSmall\",\"width:121px; min-width:121px; max-width:121px;\");this.Add(\"allAirEpisodeDiv\",\"overflow:hidden; width:137px; white-space:nowrap; text-overflow:ellipsis; margin-top:1px\");this.Add(\"allAirEpisodeDivSmall\",\"overflow:hidden; width:117px; white-space:nowrap; text-overflow:ellipsis;\");this.Add(\"allAirRepeatDiv\",\"margin-top:1px\");this.Add(\"allAirEpisodeRepeat\",\"margin-top:0px\");this.Add(\"allAirEpisodeLink\",\"color: #0088E4; text-decoration:none\");this.Add(\"allAirRepeat\",\"border-collapse:collapse; font-size:11px; font-family: Verdana, Tahoma, Sans-Serif; position:absolute; top:230px; left:0px;\");this.Add(\"allAirRepeat1\",\"position:absolute; top:230px; left:16px; width:80px; font-size:11px; font-family: Verdana, Tahoma, Sans-Serif\");this.Add(\"allAirPaging\",\"border-collapse:collapse; font-size:11px; font-family: Verdana, Tahoma, Sans-Serif; position:absolute; top:0px; left:0px;\");this.Add(\"allAirPrevNextDiv\",\"position:absolute; top:230px; right:0px; height:15px; width:145px; text-align:right; overflow:hidden; white-space:nowrap; text-overflow:clip;\");this.Add(\"allAirPrevLinkDiv\",\"position:absolute; left:0px;color: #0088E4;\");this.Add(\"allAirPrevCaption\",\"position:absolute; left:10px;\");this.Add(\"allAirPrevIcon\",\"width:8px; height:11px; background-repeat:no-repeat;\");this.Add(\"allAirPrevPage\",\"position:absolute; left:40px;\");this.Add(\"allAirPagesLinks\",\"text-align:center; overflow:hidden; white-space:nowrap; text-overflow:clip; color:#0088E4;\");this.Add(\"allAirNavLink\",\"color: #0088E4;\");this.Add(\"allAirNextLinkDiv\",\"position:absolute; left:94px; color:#0088E4;\");this.Add(\"allAirNextCaption\",\"position:absolute; left:0px;\");this.Add(\"allAirNextIcon\",\"width:8px; height:11px; background-repeat:no-repeat;\");this.Add(\"allAirNextPage\",\"position:absolute; left:82px;\");this.Add(\"parentMsgDiv\",\"position:absolute; left:5%; top:5%; width:90%; height:90%;\");this.Add(\"progDetLiveSrchTbl\",\"border-collapse:collapse;\");this.Add(\"progDetLiveSrchCell\",\"margin:0px; padding:0px; border:solid 1px #999999;\");this.Add(\"progDetLiveSrchTxtBox\",\"font-size:11px; vertical-align:top; font-family:Verdana, Tahoma, sans-serif; color:#999999; border-style:none; border-color:#ffffff;\");this.Add(\"progDetLiveSrchBtn\",\"height:15px; vertical-align:middle; border-top:solid 1px #999999; border-bottom:solid 1px #999999; border-right:solid 1px #999999;\");this.Add(\"progDetLiveSrchImg\",\"background-image:url(\"+parent.ImagePath+\"search_button_rest.gif); background-repeat:no-repeat; width:20px; height:15px; vertical-align:middle;\");this.Add(\"progDetAdsCaption\",\"font-size:10px; font-family:Verdana, Tahoma, Sans-Serif; color:#8A8A8A;\");this.Add(\"progDetAdsAdContent\",\"border:solid 1px #8A8A8A; width:230px; height:60px; background-color:#ffffff;\");this.Add(\"progDetFooterMargin\",\"margin:0px 8px 0px 8px;\");this.Add(\"progDetFooterContents\",\"width:100%;\");this.Add(\"progDetFooterTbl\",\"border-collapse:collapse; width:100%; font:10px Verdana, sans-serif; color:#777777; cursor:pointer;\");this.Add(\"progDetFooterFeedback\",\"text-align: right;\");this.Add(\"choosePrvContent\",\"background-color:red;position:absolute; top:0px; left:0px; height:280px; width:414px; color: #333333; font: 11px Verdana, Tahoma, sans-serif;\");this.Add(\"choosePrvCnt1\",\"position:absolute; top:8px; width:414px; height:65px;\");this.Add(\"tvTagChoosePrvCntDivider1\",\"position:absolute; top:66px; width:414px; border-top: #e4edff 1px solid; height:1px; font-size:1px;\");this.Add(\"choosePrvCnt2\",\"position:absolute; top:67px; width:414px; height:65px;\");this.Add(\"choosePrvZip\",\"position:absolute; top:12px; left:0px; font-weight:bold;\");this.Add(\"choosePrvZipInput\",\"position:absolute; top:8px; left: 204px;\");this.Add(\"choosePrvZipEg\",\"position:absolute; top:32px; left: 204px;\");this.Add(\"choosePrvZipWrnIcon\",\"position:absolute; top:10px; left:360px; height:18px; width:18px; background-repeat:no-repeat; visibility:hidden;\");this.Add(\"tvTagChoosePrvCntDivider2\",\"position:absolute; top:132px; width:414px; border-top: #e4edff 1px solid; height:1px; font-size:1px;\");this.Add(\"choosePrvCnt3\",\"position:absolute; top:130px; width:414px; height:132px;\");this.Add(\"choosePrvSrvType\",\"position:absolute; top:12px; left:0px; font-weight:bold;\");this.Add(\"choosePrvSrvTypeInput\",\"position:absolute; top:25px; left:200px; font: 11px Verdana, Tahoma, sans-serif;\");this.Add(\"choosePrvCntWrn\",\"position:absolute; top:230px; left:-8px; height:50px; width:430px; background-color:#ffffae; visibility:hidden;\");this.Add(\"choosePrvCntWrnText\",\"position:absolute; top:10px; left:40px; width:370px;\");this.Add(\"choosePrvCntWrnIcon\",\"position:absolute; top:5px; left:8px; height:26px; width:28px;background-repeat:no-repeat;\");this.Add(\"TvTagPopoverFooterBack\",\"position:absolute; top:8px; left:8px; width:94px; height:22px; border:1px solid #333333;background-color:#F1F1F1;background-image:url(img/btn_rest_normal.gif);color:#00156E;\");this.Add(\"choosePrvContent\",\"position:absolute; top:0px; left:0px; height:280px; width:460px; color: #333333; font: 11px Verdana, Tahoma, sans-serif;\");this.Add(\"choosePrvListHdr\",\"font-weight:bold; margin: 10px 8px 5px 8px;\");this.Add(\"choosePrvListDiv\",\"width:410px; height:245px; font-size:12px; font-family: Verdana, Tahoma, sans-serif; color: #333333; overflow-x:hidden; overflow:auto; scrollbar-base-color:#ffffff; scrollbar-darkshadow-color:#ffffff; Scrollbar-Track-Color:#ffffff; Scrollbar-Shadow-Color:#ffffff; scrollbar-face-color:#eeeeee; scrollbar-arrow-color: #00156E;\");this.Add(\"choosePrvListTbl\",\"font: 11px Verdana, Tahoma, sans-serif; color: #333333; margin: 0px 8px 0px 8px;\");this.Add(\"remHdrText\",\"color:#333333; font:11px bold  Verdana, Tahoma, Sans-Serif;\");this.Add(\"remText\",\"color:#333333; font:13px Verdana, Tahoma, Sans-Serif;\");this.Add(\"remLinkSpan\",\"padding:40 10 0 30; color:#333333; font:11px Verdana, Tahoma, Sans-Serif;\");this.Add(\"remMessengerBtn\",\"width:185; height:18;\");this.Add(\"remOutlookBtn\",\"width:100; height:18;\");this.Add(\"remTimeTblStyle\",\"width:100;\");this.Add(\"remTimeTblCell\",\"align:center;\");this.Add(\"remDivider1\",\"position:absolute; background-image:url(\"+parent.ImagePath+\"dividerDotted.gif); background-repeat:no-repeat; height:5; width:350; top:-8; left:-3; font:0 Verdana, Tahoma, Sans-Serif;\");this.Add(\"remDivider2\",\"position:relative; background-image:url(\"+parent.ImagePath+\"dividerDotted.gif); background-repeat:no-repeat; height:5; width:363; top:0; left:-3; font:0 Verdana, Tahoma, Sans-Serif;\");this.Add(\"progDetTable\",\"border-collapse:collapse; width:100%;\");this.Add(\"progDetEpisode\",\"color:#333333; font:bold 13 Verdana, Tahoma, Sans-Serif;\");this.Add(\"progDetDesc\",\"color:#333333; font:13 Verdana, Tahoma, Sans-Serif;padding-right:20;\");this.Add(\"progDetDivider1\",\"position:absolute; background-image:url(\"+parent.ImagePath+\"dividerDotted.gif); background-repeat:no-repeat; height:5; width:431; top:-8; left:-3; font:0 Verdana, Tahoma, Sans-Serif;\");this.Add(\"progDetDivider2\",\"position:relative; background-image:url(\"+parent.ImagePath+\"dividerDotted.gif); background-repeat:no-repeat; height:5; width:431; top:0; left:-3; font:0 Verdana, Tahoma, Sans-Serif;\");this.Add(\"progDetTimeTbl\",\"border-collapse:collapse; width:100%;\");this.Add(\"progDetTime\",\"width:50%; color:#333333; font:bold 13 Verdana, Tahoma, Sans-Serif;\");this.Add(\"progDetChan\",\"width:50%; color:#333333; font:bold 13 Verdana, Tahoma, Sans-Serif; text-align:right; padding-right:8;\");this.Add(\"progDetFirstTopicHdr\",\"color:#333333; font:bold 10 Verdana, Tahoma, Sans-Serif; padding-top:10;\");this.Add(\"progDetTopicHdr\",\"color:#333333; font:bold 10 Verdana, Tahoma, Sans-Serif; padding-top:15;\");this.Add(\"progDetTopicText\",\"color:#333333; font:10 Verdana, Tahoma, Sans-Serif; padding:0;\");this.Add(\"progDetViewRecLinkCel\",\"padding-top:15px;\");this.Add(\"progDetShowInfo\",\"position:absolute; top:6px; left:0px; width:100%; text-indent:4px; color:#333333; font-size:14px; font-family:Verdana, Tahoma, Sans-Serif;\");this.Add(\"progDetSummary\",\"cursor:pointer; position:absolute; top:30px; left:0px; height:25px; width:100%; background-color:#e4edf4;\");this.Add(\"progDetSummaryText\",\"position:absolute; top:4px; left:4px; color:#333333; font-size:11px; font-family:Verdana, Tahoma, Sans-Serif;\");this.Add(\"progDetCredits\",\"cursor:pointer; position:absolute; top:55px; left:0px; height:25px; width:100%;\");this.Add(\"progDetCreditsText\",\"position:absolute; top:4px; left:4px; color:#333333; font-size:11px; font-family:Verdana, Tahoma, Sans-Serif;\");this.Add(\"progDetAllAirings\",\"cursor:pointer; position:absolute; top:80px; left:0px; height:25px; width:100%;\");this.Add(\"progDetAllAiringsText\",\"position:absolute; top:4px; left:4px; color:#333333; font-size:11px; font-family:Verdana, Tahoma, Sans-Serif;\");this.Add(\"progDetMainInnerDiv\",\"position: absolute; height:244px; width:306px; margin: 8px;\");this.Add(\"progDetMainToolbar\",\"position:absolute; top:0px; left:0px; height:26px; width:306px;\");this.Add(\"progDetMainIcon\",\"float:left; margin-right:5px; height:16px; background-repeat:no-repeat; cursor:pointer;\");this.Add(\"progDetMainIconRecord\",\"width:16px;  background-image:url(\"+parent.ImagePath+\"remoteRecord_16x16.gif);\");this.Add(\"progDetMainIconMSN\",\"width:16px; background-image:url(\"+parent.ImagePath+\"msnlogo.gif);\");this.Add(\"progDetMainLink\",\"float:left; margin-right:15px; line-height:20px; font-size: 11px; font-family: Verdana, Tahoma, Sans-Serif; color:#00156E; cursor:pointer; text-decoration:none\");this.Add(\"progDetMainToolbarDivider\",\"position:absolute; top:23px; left:0; border-top: #e4edff 1px solid; width:306px; height:1px; font-size:1px;\");this.Add(\"progDetMainShowName\",\"position:absolute; top:28px; left:0px; width:306px; font-weight:bold; font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;\");this.Add(\"progDetMainEpisode\",\"position:absolute; top:54px; left:0px; width:306px; height:17px; font-weight:bold; font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;\");this.Add(\"progDetMainDescription\",\"position:absolute; top:72px; left:0px; overflow:hidden; text-overflow:ellipsis; width:300px; height:70px; font-size: 12px;\");this.Add(\"progDetMainRepeat\",\"position:absolute; top:111px; left:0px; font-size: 12px;\");this.Add(\"progDetMainChannel\",\"position:absolute; top:150px; left:0px; height:14px; width:306px; Font-weight: bold; Font-size: 12px;\");this.Add(\"progDetMainChannelInfo\",\"position:absolute; top:0px; left:80px; height:14px; width:226px; font-weight:normal;\");this.Add(\"progDetMainTime\",\"position:absolute; top:170px; left:0px; height:14px; width:306px; Font-weight: bold; Font-size: 12px;\");this.Add(\"progDetMainTimeInfo\",\"position:absolute; top:0px; left:80px; height:14px; width:226px; Font-weight: normal;\");this.Add(\"progDetMainDuration\",\"position:absolute; top:190px; left:0px; height:14px; width:306px; Font-weight: bold; Font-size: 12px; font-family: Verdana, Tahoma, sans-serif; color: #333333;\");this.Add(\"progDetMainDurationInfo\",\"position:absolute; top:0px; left:80px; height:14px; width:226px; Font-weight: normal;\");this.Add(\"progDetMainFooter\",\"position:absolute; top:218px; left:0px;\");this.Add(\"progDetMainFooterInfoIcon\",\"position:absolute; top:0px; left:0px; height:17px; width:17px; background-repeat:no-repeat;\");this.Add(\"progDetMainAd\",\"width:234px; height:60px; cursor:pointer\");this.Add(\"progDetMainFooterProvider\",\"position:absolute; top:0px; left:22px; width:278px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;\");this.Add(\"progDetMainFooterChangeProvider\",\"position:absolute; top:13px; left:22px; Font-size: 11px; white-space:nowrap; color:#0088E4;text-decoration:none\");this.Add(\"progDetMainCreditsDiv\",\"position:absolute; top:22px; left:0; width:306px; height:220px; font-size:12px; font-family: Verdana, Tahoma, sans-serif; color: #333333; overflow-x:hidden; overflow:auto; scrollbar-base-color:#ffffff; scrollbar-darkshadow-color:#ffffff; Scrollbar-Track-Color:#ffffff; Scrollbar-Shadow-Color:#ffffff; scrollbar-face-color:#eeeeee; scrollbar-arrow-color: #00156E;\");this.Add(\"progDetMainCredits\",\"margin-top:2px; height:16px; width:288px; font-weight:bold; font-size:14px;\");this.Add(\"progDetCreditsCaption\",\"margin-top:16px; width:288px; font-weight:bold;\");this.Add(\"progDetCreditsDetails\",\"margin-top:2px; width:288px;\");this.Add(\"rrTypeCaption\",\"margin-left:10px; margin-top:10px; font:12px Verdana, sans-serif; color: #333333; font-weight:bold;\");this.Add(\"rrDivider\",\"margin: 12px 6px 10px 10px; border-top: #e4edff 1px solid; width:100%; height:1px; font-size:1px;\");this.Add(\"rrTypeProgAndEpisodeTitles\",\"margin-left:10px; margin-top:10px; font:12px Verdana, sans-serif; color: #333333;\");this.Add(\"rrTypeChoicesDiv\",\"margin-left:40px; margin-top:10px;\");this.Add(\"rrTypeChoicesTbl\",\"font:11px Verdana, sans-serif; color: #333333;\");this.Add(\"rrTypeChoicesRadioCell\",\"width:20px;vertical-align:top;\");this.Add(\"rrTypeChoicesLabel\",\"margin-top:3px; font-weight:bold;\");this.Add(\"rrTypeChoiceCell\",\"vertical-align:top; font: 11px Verdana, sans-serif; color: #333333; width:155px;\");this.Add(\"rrUpsell\",\"top:-50px; width:400px; height:220px; font-size:12px; font-family: Verdana, Tahoma, sans-serif; color: #333333; overflow-x:hidden; overflow:auto; scrollbar-base-color:#ffffff; scrollbar-darkshadow-color:#ffffff; Scrollbar-Track-Color:#ffffff; Scrollbar-Shadow-Color:#ffffff; scrollbar-face-color:#eeeeee; scrollbar-arrow-color: #00156E;\");this.Add(\"rrConfTbl\",\"font:12px Verdana, sans-serif; color: #777777;\");this.Add(\"rrConfLbl\",\"width:100px; Font-weight: bold;\");this.Add(\"rrConfValue\",\"width:200px;\");this.Add(\"tvTagPPTable\",\"border-collapse:collapse; width:100%;\");this.Add(\"msgDiv\",\"margin: 8px 8px 8px 8px;\");this.Add(\"msgDivTextDiv\",\"margin-left:8px; margin-top:0px;\");this.Add(\"msgDivFont\",\"font:11px Verdana, sans-serif; color: #333333;\");if(this.Browser.IsIE){this.Add(\"errorUrl\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"error_24x24.png', sizingMethod='image', enabled='true');\");this.Add(\"warningUrl\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"warning_24x24.png', sizingMethod='image', enabled='true');\");this.Add(\"infoUrl\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"info_24x24.png', sizingMethod='image', enabled='true');\");this.Add(\"errorSmallUrl\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"error_16x16.png', sizingMethod='image', enabled='true');\");this.Add(\"warningSmallUrl\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"warning_16x16.png', sizingMethod='image', enabled='true');\");this.Add(\"infoSmallUrl\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"info_16x16.png', sizingMethod='image', enabled='true');\");this.Add(\"repeatIcon\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"repeat_12x12.png', sizingMethod='image', enabled='true');\");this.Add(\"allAirPrevHover\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"glyph_back_hover.png', sizingMethod='image', enabled='true');\");this.Add(\"allAirPrevRest\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"glyph_back_rest.png', sizingMethod='image', enabled='true'); \");this.Add(\"allAirNextHover\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"glyph_next_hover.png', sizingMethod='image', enabled='true');\");this.Add(\"allAirNextRest\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"glyph_next_rest.png', sizingMethod='image', enabled='true');\");this.Add(\"closeXIcon\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"glyph_close_rest.png', sizingMethod='image', enabled='true');\");this.Add(\"wLiveIcon\",\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='\"+parent.ImagePath+\"wLive-beta.png', sizingMethod='image', enabled='true');\");}else{this.Add(\"errorUrl\",\"background-image:url(\"+parent.ImagePath+\"error_24x24.png);\");this.Add(\"warningUrl\",\"background-image:url(\"+parent.ImagePath+\"warning_24x24.png);\");this.Add(\"infoUrl\",\"background-image:url(\"+parent.ImagePath+\"info_24x24.png); \");this.Add(\"errorSmallUrl\",\"background-image:url(\"+parent.ImagePath+\"error_16x16.png);\");this.Add(\"warningSmallUrl\",\"background-image:url(\"+parent.ImagePath+\"warning_16x16.png);\");this.Add(\"infoSmallUrl\",\"background-image:url(\"+parent.ImagePath+\"info_16x16.png);\");this.Add(\"repeatIcon\",\"background-image:url(\"+parent.ImagePath+\"Repeat_12x12.png);\");this.Add(\"allAirPrevHover\",\"background-image:url(\"+parent.ImagePath+\"glyph_back_hover.png);\");this.Add(\"allAirPrevRest\",\"background-image:url(\"+parent.ImagePath+\"glyph_back_rest.png);\");this.Add(\"allAirNextHover\",\"background-image:url(\"+parent.ImagePath+\"glyph_next_hover.png);\");this.Add(\"allAirNextRest\",\"background-image:url(\"+parent.ImagePath+\"glyph_next_rest.png);\");this.Add(\"closeXIcon\",\"background-image:url(\"+parent.ImagePath+\"glyph_close_rest.png);\");this.Add(\"wLiveIcon\",\"background-image:url(\"+parent.ImagePath+\"wLive-beta.png);background-repeat:no-repeat;\");}this.Add(\"msgDivWaitingUrl\",\"background-image:url(\"+parent.ImagePath+\"waiting_animation.gif);\");this.Add(\"msgDivImg\",\"top:0px;left:0px; width:24px; height:24px; background-repeat:no-repeat;\");this.Add(\"msgDivDivider\",\"width:100%; height:1px; margin-bottom:12px;\");this.Add(\"msgDetails\",\"margin:0px 8px 8px 8px;overflow-x:hidden; overflow:auto; scrollbar-base-color:#ffffff; scrollbar-darkshadow-color:#ffffff; Scrollbar-Track-Color:#ffffff; Scrollbar-Shadow-Color:#ffffff; scrollbar-face-color:#eeeeee; scrollbar-arrow-color: #00156E;\");this.Add(\"italic\",\"font-style: italic\");this.Add(\"tblCollapse\",\"border-collapse:collapse;\");this.Add(\"trNoMargin\",\"margin:0px; padding:0px;\");this.Add(\"divider\",\"width:100%; border-top: #E4EDF3 1px solid; height:1px; font-size:1px;\");this.Add(\"bottomMrg16\",\"margin-bottom:16px;\");this.Add(\"closeX\",\"width:11px; height:11px; background-repeat:no-repeat;position:absolute; top:6px; right:5px; z-index:1;cursor:pointer;\");this.Add(\"img12x12\",\"position:absolute; top:0px;left:0px; height:13px; width:13px; background-repeat:no-repeat;\");this.Add(\"width80px\",\"width:80px;\");this.Add(\"width13px\",\"width:13px\");this.Add(\"tvAnchors\",\"cursor:pointer; text-decoration:underline; font:11px Verdana, Tahoma, Sans-Serif; color:#3366ff;\");this.Add(\"panelBtnText\",\"margin-top:5px; height:14px; cursor:pointer; font:12px Verdana, Tahoma, Sans-Serif; color:#008AE2;\");this.Add(\"panelBtnTextSmall\",\"height:14px; cursor:pointer; font:11px Verdana, Tahoma, Sans-Serif; color:#008AE2;\");this.Add(\"text11\",\"color:#333333; font:11px Verdana, Tahoma, sans-serif;\");this.Add(\"text12\",\"color:#333333; font:12px Verdana, Tahoma, sans-serif;\");this.Add(\"text13\",\"color:#333333; font:13px Verdana, Verdana, sans-serif;\");this.Add(\"tvTextStd\",\"color:#333333; font:11px Verdana, Tahoma, Sans-Serif;\");this.Add(\"tvTextStdBold\",\"color:#333333; font:bold 11px Verdana, Tahoma, Sans-Serif;\");this.Add(\"tvTextWarning\",\"color:#333333; font:bold 11px Verdana, Tahoma, Sans-Serif;\");this.Add(\"colorLnk\",\"color:#0088E4;\");this.Add(\"colorDisabled\",\"color:#999999;\");this.Add(\"topMrg0\",\"margin-top:0px;\");this.Add(\"topMrg4\",\"margin-top:4px;\");this.Add(\"topMrg8\",\"margin-top:8px;\");this.Add(\"bottomMrg8\",\"margin-bottom:8px;\");this.Add(\"leftMrg16\",\"margin-left:16px;\");this.Add(\"rightMrg4\",\"margin-right:4px;\");this.Add(\"nounderline\",\"text-decoration:none;\");this.Add(\"backaqua\",\"background-color:aqua;\");this.Add(\"backred\",\"background-color:red;\");this.Add(\"alignLeft\",\"align:left\");this.Add(\"12x12\",\"width:12px; height:12px\");},InitOnHover:function(){},Add:function(n,v){this.All[n]=v;},Apply:function(ob,classNames,areStylesAppended){var classes,cssClass,cssStr;if(areStylesAppended==null){areStylesAppended=false;}try{classes=classNames.split(\" \");if(ob.style.cssText!=\"\")ob.style.cssText=\"\";for(var i=0;i<classes.length;i++){cssClass=classes[i];cssStr=this.All[cssClass];if(ob.style.cssText!=\"\"||areStylesAppended){ob.style.cssText=ob.style.cssText+\";\"+cssStr;}else{ob.style.cssText=cssStr;}}}catch(e){}},SetBeakMargins:function(beakMarginX,beakMarginY){this.BeakMarginX=beakMarginX!=null?beakMarginX:this.DefaultBeakMarginX;this.BeakMarginY=beakMarginY!=null?beakMarginY:this.DefaultBeakMarginY;},ApplyCSS:function(ob,css){ob.style.cssText=ob.style.cssText+\";\"+css;},ApplyAnchorStyles:function(ob){if(ob.tagName==\"A\")this.Apply(ob,\"tvAnchors\");for(var i=0;i<ob.childNodes.length;i++){this.ApplyAnchorStyles(ob.childNodes[i]);}}},Custom:{InitOnce:function(parent){this.ObjectName=\"Custom\";this.ObjectRef=parent.ObjectRef+\".\"+this.ObjectName;},AddAdsArea:function(){},InitAds:function(){},CreateAds:function(){}}};"